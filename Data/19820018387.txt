b'STUDY OF THE GLOBAL POSITIONING SYSTEM FOR MARITIME\nCONCEPTS/APPLICATIONS:\n\nSTUDY OF THE FEASIBILITY OF\n\nREPLACING MARITIME SHIPBORNE NAVIGATION SYSTEMS WITH\nNAVSTAR\niNASA-CH-169031)\nS I U L Y O f I t E G1CBAL\nPOSITIONING SYSTEM FOR M A E I T I K E\nCONCEPTS/APPLICATIONS;\nSTUDY CF THE\nFEASIBILITY OF E E f L A C I N G M A E I 1 I M E S H I t B C E N E\nNAVIGATION SYSTEMS fclTfl liAVSIAE\n(Cclccado\nFINAL TECHNICAL REPORT\n\nDr. C. Byron Winn\nPrincipal Investigator\nW. Huston\nResearch Associate\n\nCOLORADO STATE UNIVERSITY\nFORT COLLINS, COLORADO\n\n80523\n\nJune 1, 1979 to December 31, 1981\n\nREPRODUCED BY\nU.S. DEPARTMENTOF COMMERCE\nNATIONAL TECHNICAL\nINFORMATION SERVICE\nSPRINGFIELD. VA 22161\n\nSB2-262t3\n\nG3/04\n\nUnclas\n28074\n\nI. Introduction\nThe NAVSTAR Global Positioning System (GPS) is a satellite navigation\nsystem currently under development by the Department of Defense.\n\nA\n\njoint-Service program office was established in 1974 at the Air Force Space\nand Missile Systems Organization in Los Angeles, California. Tests conducted\nbetween 1974 and the present have verified the system concept and the\npredicted system performance.\n\nGPS will consist of twenty four satellites,\n\ninclined 60 degrees to the equator, in twelve hour orbits. The GPS signal\nis a spread spectrum signal with two pseudo-random noise codes in quadature.\nA 50 bit per second data bit stream is modulated on both codes.\n\nThe data\n\nstream contains system time, satellite clock characteristics data, satellite\nephemerides, plus other status indicator data.\nThe National Aeronautics and Space Administration (NASA), Goddard\nSpace Flight Center, has developed a concept utilizing a geostationary\nreference satellite (REFSAT) that broadcasts every four seconds updated\nGPS satellite coordinates.\n\nThis procedure reduces the complexity of the\n\nGPS receiver. For an overview of the NASA concept, reference (1) is an\nexcellent paper. This paper should be reviewed to understand the REFSAT\nand GPS receiver interface.\nNASA initial direction was to:\n1. Quantify the economic and performance payoffs associated with\nreplacing maritime shipborne navigation systems with NAVSTAR, and\n2. Evaluate the use of NAVSTAR for measurements of ocean currents in\nthe broad ocean areas of the world.\n\n-2-\n\nDuring this contract period, a single channel GPS receiver was developed\nby Systematics General Corporation. This unit includes the RF/IF hardware,\nL-band synchronizer and frequency reference, code tracking loop, carrier\ntracking loop and digital processor.\n\nThe software control and signal\n\nprocessing software were developed by Howard University, Washington, D.C.\nThere was a requirement to develop a dynamic software program to position\na ship at sea.\n\nColorado State University (CSU) was redirected to develop\n\nthis software and integrate the software into the REFSAT receiver.\n2.\n\nInitial Research\nCargo and transport ship velocities in the range of 10 to 20 knots can\n\nhave their speed through the water reduced by 10-20% by ocean currents.\nThe general trend in ocean currents is quite well understood and has been\nthe subject of numerous analytical efforts (2) and also many empirical\nstudies with resulting sea charts published by the United States Navy. The\nPilot Charts include recommended sea-lanes and make the distinction between\nfull and low-powered ships(3).\nThese currents are time-varying. In particular, both the Gulf Stream\nand the Japanese Current, two of the predominant sources of general oceanic\ncirculation for the Northern Hemisphere, can have marked variations,\nparticularly along the edges of the mainstream of the current itself. As a\nresult, it is worthwhile to seek minimum-fuel ocean passages which rely on\nan understanding of the fine grain, time-varying structure of those ocean\ncurrents.\nReceivers using the GPS signal have the capability to accurately\nmeasure ocean currents.\n\nThis information could be relayed via satellite to a\n\ncentral data reduction center where the real-time current data could be\nintegrated into the computer data banks. The updated data file could then\nbe used to project the minimum sailing time route back to the ship.\n\n-3-\n\nIf the use of GPS would allow an improvement of half a knot in forward\nspeed, there is a rather remarkable cost savings in dollars-per-year for the\ntanker fleet.\n\nFrom Table 1, one can see that a tanker in the 100,000-ton\n\nclass can realize savings of as much as $90,000 per year, if the knowledge of\nocean currents allows a speed improvement of .46 knots.\n\nFigure 1 is an\n\nextract from the pilot chart of the North Atlantic for July 1978.\n\nIt shows\n\na path which is prescribed for low-powered ships to gulf ports; the path passes\nthrough regions of extremely confused currents.\nTANKER PERFORMANCE CHART (4)\n\nTanker\nAvg. Speed\nDisplacement\nKnots\nTTU/Year* $/TTU\n19,000\n(FOMALHAUT)\n\n14 .5\n\n873\n\n52,000\n(VIRGO)\n\n16 .25\n\n2882\n\n$\n\n94,090\n(DRACO)\n\n15 .3\n\n4810\n\n$\n\n*\n**\n\n3% Speed\nATTU**\nSavings/\nImprovements A3% Speed\nYear\n.435\n\nkts.\n\n2 .86%\n\n31 ,858\n\n892\n\n.487\n\nkts.\n\n2 .80%\n\n71 ,980\n\n666\n\n.459\n\nkts.\n\n2 .81%\n\n90 ,017\n\n$1 ,276\n\nA TTU is 106 ton miles\n10,000 mile round voyage\nTable 1. Cost Savings Due to Speed Improvements\n\nNote that the dashed lines on Figure 1 reflect current uncertainty. The\npilot charts reflect many examples of such unpredictable currents. An\nimportant case is that in the Gulf of Alaska, in which the area has extensive\ndashed currents for the month of July,1978.\n\nThis is the area currently being\n\ntraversed by the Alaskan tanker fleet. Shown on Table 1 are the overall\nsavings in dollars-per-year versus speed improvements for three classes of\nship.\n\nPAGE S3\nOF POOR QUALITY\n\nv,\n\n;T-^X^~ -^*> /\'\xe2\x80\xa2 *ru\\v"*-\\VN *\ni^^^^<\\\\\\W^ *V-J^\n\nFigure 1. Ocean Currents from North Atlantic Pilot Chart\n\n-4-\n\nThe initial research was directed toward constructing an algorithm that\nwould give the minimum sailing time route between two points on the earth.\nTo specify a position on the earth\'s surface we need two angles,\n\n6 and 4> .\n\nLet (GQ.CJJQ) be the position of the point of origin and (6, ,$, ) the destination,\nUsing 9 as a parameter, a function\n\n$(6)\n\nis determined which provides the\n\nminimum sailing time.\nFirst an integral is developed which provides the sailing time in terms\nof ocean currents, ship speed and $(6).\n\nTo find the function that minimizes\n\nthis integral we apply calculus of variations methods to a second order differential equation - Euler\'s equation with boundary conditions.\nequation is quite long and nonlinear.\ninterval from 6Q to 6, is divided into\n\nThe Euler\'s\n\nSolving the equation numerically, the\nn subintervals.\n\nThe first and\n\nsecond derivatives of $(9) at each end point of the subinterval are approximated by using Taylor\'s theorem. In place of the Euler\'s equation we now\nhave a system of n-1 nonlinear algebraic equations in the unknowns\n$(9Q+iA9)(i=l ,. . . ,n-l ) plus the boundary conditions.\nLet \xc2\xa3 be this system of equations and X. the n-1 vector of values of\n$(9Q+iA9). Next the system \xc2\xa3(X_)=0 is solved.\n\nThis system can be rewritten\n\nThis system is solved by iterating on an initial guess X^ using the equation\n4+1\n\n= K^)\n\nwhere k = 0,1,3...\n\nCSU was in the process of implementing the system on the computer when\nwe were redirected to develop a navigation filtering algorithm to support the\nREFSAT approach to low cost GPS terminals.\nSome analytical approaches to solving this optimization problem are\ndescribed in Appendix A.\n\n-5-\n\n3. Development of Navigational Filtering Algorithms.\nCSU was directed to support the REFSAT development by developing navigation filtering algorithms. This research includes coordination with Howard\nUniversity and Systematics General. The hardware developed by Systematics\nGeneral Corporation was to be integrated with the digital processing and\noperational software developed by Howard University. Development problems\ndelayed the integration. CSU was requested to have the software available\nfor integration in the summer of 1981.\n\nUnfortunately, funding to the hardware\n\nand software activities was not available. Funds set aside for the integration of the navigation software have been returned by CSU to NASA.\nThe navigation software was to be resident in the REFSAT receiver\nprocessor. As the digital processing and operational software developed, it\nappeared that insufficient space would be available, both from a throughput\nand a memory point of view.\n\nIt was therefore concluded that the software\n\nshould not be developed independent of the operating REFSAT receiver.\nInformation on the Navigation Function Driver (NAVFUNC) has been received\nfrom Howard University.\n\nIt is possible that some of the data calculated in\n\nthe subroutines could be used to reduce the computation time of the navigation\nfilter.\n\nIf the NAVFUNC data is not retrievable, then a method similar to the\n\none used by A. J. Van Dierendonck (5) must be used to obtain the NAVSTAR\nsatellite coordinates.\nTime to calcualte the navigation solution is very limited. It is estimated\nthat it will take from 5-10 seconds to calculate the necessary variables\nneeded for the navigation algorithm. The solution of the ship\'s position will\ntake from 15-30 seconds. For example, to solve for the linear system represented by\n\n-6-\n\nHx = y (rank 5)\ntakes from 1.7 to 2.1 seconds to solve. A listing of the program to solve this\nsystem is listed in Appendix B. The dead reckoning portion will take another\n5-10 seconds, for a total computational time of slightly less than one minute.\nTimes are based onan8080/Z80 based microprocessor (^ 2MHZ clock).\nThe accuracy of the position and velocity of the ship will be impacted\nby the ship\'s motion:\nyaw.\n\nheadway, surge, leeway, sway, heave, roll, pitch and\n\nOf these motions, roll will have the greatest adverse impact. Large\n\nships (over 150 meters in length) can have roll periods up to 13 seconds.\nBy taking a sampling period much greater (^ 5i) than the period of roll the\nshort term vessel\'s motion could be treated as increased noise.\nThe initial navigation algorithm will be based on the work of Noe, Myers\nand Wu (6). The navigation solution will be strongly dependent upon system\nnoise.\n\nSince the REFSAT receiver performance has not been fully defined,\n\nthe navigation accuracy can not yet be determined.\n4. Future Efforts\nThe incorporation of the navigation filter into the REFSAT receiver should\ntake approximately one month.\n\nIf the receiver is not operational or persons\n\nfamiliar with the receiver are not available for consultation then the period\nof effort would extend several months.\n\nCSU has the personnel capable of making\n\nthe receiver operational and would be pleased to continue this effort if and\nwhen funding becomes available.\n\n5. References\n(1) J. W. Sennott, A. K. Chouldhury, and R. E. Taylor, NASA Technical Memorandum 79655, The REFSAT Approach to Low-Cost GPS Terminals, April 1979.\n(2) Stern, M. E., Ocean Circulation Physics, Academic Press, N.Y., 1975.\nVon Arx, W., An Introduction to Physical Oceanography, Addison-Wesley,\nReading, Mass., 1962.\n(3) Pilot Chart of the North Atlantic.\n(4) Gannett, E., Tanker Performance and Cost. Cornell Maritime Press,\nCambridge, Maryland, 1969.\n(5) A. J. Van Dierendonck, S. S. Russell, E. R. Kopitzke and M. Birnbaum,\nThe GPS Message, Journal of the Institute of Navigation. Vol. 25, No. 2,\nSummer 1978.\n(6) P. S. Noe, K. A. Meyers, and J. K. Su, "A Navigation Algorithm for the\nLow-Cost GPS Receiver," Journal of the Institute of Navigation, Summer 1978.\n\nAppendix A\nThe trajectory optimization problem discussed in Section 2 is described\nin more detail in this appendix. A simplified analytical formulation is\npresented based on a kinematical analysis and a closed form solution to this\nsimplified problem is presented.\n\nNext, various complications are added and\n\nthe form of the optimal controller for each variation is presented.\n\nFinally,\n\na dynamical formulation is presented and its solution is discussed.\nThe problem of determining the optimal trajectory for a ship may be\ndescribed in simplified terms as follows.\non Figure A.I.\n\nConsider the situation represented\n\nThe problem is to determine the steering angle, 6(t), that\n\nresults in a transfer of the ship from its initial position (L ,a ) to\na final position (Lf,af) in minimum time. Without loss of generality we may\nassume that the final latitude, L^, is zero. Also, without loss of generality,\nwe may assume that the motion takes place on a unit sphere and that the\nship\'s speed relative to the water is unity.\nModel No. 1. No Ocean Currents\nFor this initial problem we assume that there are no ocean currents.\nThis provides a starting point for which we can obtain a closed form analytical\nsolution. We may then add the ocean currents to the model and attempt to\nbuild a solution in steps.\nThe kinematic equations may be written as\n\nORIGINAL PA2 \xc2\xa33\nOF POOR QUALITY\n\nFigure A . I .\n\nS h i p \' s Trajectory\n\n-2-\n\n^=r = sin 0\n\n.44.\ndt\n\n(A.I)\n\nr\ncos L\n\n(A.2)\n\nThe payoff function may be defined as\n4. = -tf\n\nwhere tf\n\n(A.3)\n\nis the final time. We wish to determine 0(t) such that <(> is\n\nmaximized as this is equivalent to minimizing the time required for the\ntransfer to take place. The terminal constraints are\n*-, = L(tf) = 0\n\n(A.4)\n\n\\|>2 = a(tf) - af = 0\n\n(A.5)\n\nThe Hamiltonian function is\n"""\n\nQ\n\nr\n\n(A-6)\n\nA necessary condition for optimality is that the control, 6(t), maximizes the\nHamiltonian. Therefore the optimal control is determined unambiguously by\nthe equations\nsin 9 = X. \'IV X? + X2 / cos2 L\nL y L.\nLX\n\ncos 6 = (Xa/cos L) / / xj + X2 / COS2 L\n\n(A.7)\n\n(A<8)\n\n-3-\n\nEquations (A.7) and (A.8) specify the optimal control in terms of the adjoint\nvariables A., and A. . These, in turn, are determined from the following\nL\xe2\x80\x94\nUC\nequations.\n\ndt\n\n9L\n\n= - A cos 6 sin L / cos L\n\na\n\n(A.9)\n\n111\n3L\n\ndt\n\n(A.10)\n\n= 0\n\nThe adjoint variables are determined at the final time, t^, from the transversal ity condition\n(A.11)\n\nwhere\n\nx\n\n=\n\n(L,a). From equation (A.3),\n\n= (o o)\n\n(A.12)\n\nand from equations (A.4 ) and (A.5)\n1\n\n3X\n\n0\n(A.13)\n\n0 1\n\n-4-\n\nTherefore\n\n(AL, x )\nThe components of v\n\n= (-v] -v2)\n\n(A.14)\n\ntf\nrepresent the sensitivities in the payoff function, <j),\n\nto changes in the components of the state vector at the final time.\nConsequently\nv-| = -sin\n\nand\n\n= -cos 6,\n\nand therefore\n\n= sin\n\n(A.15)\n\n(tf) = cos 6f\n\n(A.16)\n\nand\n\nAn additional necessary condition is that\n\n(A.17)\n\n= 0\n\nExpanding,\n= 0\n\n(A.18)\n\n-5-\n\nRecalling equations (A.I), (A.2), (A.6), and (A.11), and using the fact that\n-1 and -\n\n=\n\n\xc2\xb0> this reduces to\n\nH |t = 1\n,\n\n(A.19)\n\nf\n\nA l s o , since the Hamiltonian is not an explicit function of time it must be\nconstant along an optimal trajectory.\n\nTherefore,\n\nnecessarily\n\nH 5 1\nalong the optimal path.\n\nThis provides us with the following equation for X. :\n\\L2\n\n= 1 - cos 2 6 f / cos 2 L\n\n(A.20)\n\nThe above system of equations may be solved in closed form; the solutions are\nL(t) = -sin" 1 [sin 6 f sin(t f - t)]\n\n(A.21)\n\na(t) = af - tan"1 [cos 6f tan (tf - t)]\n\n(A.22)\n\nXL(t) = cos (tf - t) / /Cot2 Q\n\n+ CQS2(t\n\nXa(t) = cos 6f\n\n_ t)\n\n(A.23)\n\n(A.24)\n\nand\n6(t) = tan"1 [tan 6 f cos (t f\n\n- t)]\n\n(A.25)\n\n-6-\n\nThese solutions may be verified by substituting them back into the differential\nequations.\n\nFor any given value for a*, the above equations define a two-\n\nparameter family of trajectories on the sphere.\n\nThe two parameters are\n\n0f and tf.\nGiven any arbitrary state (L,a) at some time t < tf one may solve for\n0.c and tf in terms of L, a, and t. The results are\n9\n\nf\n\n-1L r\n-tan L -|\nsin (af - a)J\n\n= tan\n\n(A.26)\n\nand\n\ntf = t + cos" [cos L cos (af - a ]\n).\n\n(A.27)\n\nThese relations for 0f and tf may be substituted into equations (A.23),\n(A.24) and (A.25) to obtain the optimal values for the adjoint variables and\nthe control.\n\nThe results are\n\n(L,a.t) = - sin L / /sir,2 L\n\nV\n\n+ tan 2 ((X\n\n. o)\n\n( a t = cos L tan (a\nL\n}\n\nf -a) / / sin 2 L + tan2 (af - a)\n\n\'\'\n\n(A.28)\n\n(A 29)\n\n\'\n\nand\n\n8" ( L > B .t) - tan\'1 [\n\n-^" [\n\na)\n\n]\n\n(A.30)\n\nThe optimal value for the payoff function is\n<J>* (L,a,t) = -t f *\n\n(L,a,t) - cos" 1 [cos L cos (a f - a)]\n\n(A. 31)\n\n-7-\n\nModel No. 2. Constant Current (East or West)\nWe next consider a situation in which there is a constant ocean current\nin the easterly or westerly direction. In this case the kinematical equations\nare\n\n4- = sin 6\n\n(A.32)\n\nda _ cos 9 \xc2\xb1 k\ndt\ncos L\n\n(/L33)\n\nThe Hamiltonian is\nH = X cos 9 + X (C\xc2\xb0*\n\nk\n\n)\n\n(A.34)\n\nThe Hamiltonian is again maximized by the control\nsin 9 =\n\nA.\nL\n\nX cos L\na\n\n, cos 6-=\nL\n\n/\n\nV\n\n+\n\n(A.35)\n\nV\'\n\nThat is, the optimal control is determined by the same equations as for the\nfirst problem.\nAlso, we still have that\n\n_\ndt\n\nv\n\ndt tf\n\ntf\n\n+\n\n= U\nQ\n\n(ii . VT 3*) |t = u\n^9t v 3t; I f o\n\n(A 37)\nIA.J/;\n\n-8-\n\nAT F I\n\nTherefore\n\n+ (|i - vT ||) L\n\n\' f\n\n=6\n\n(4.38)\n\nf\n\nBut\n3<1>\n\n_\n\nn\n\n\xe2\x80\xa2^r ~ -I\n\n3^\n\n_\n\n> ~!Tf ~ n\nu\n\nIn\n\nOQ\\\n\n^t.jy;\n\nAlso\n\nAT F\n\nTherefore\n\n= H\n\nHL = + 1\n\n(A. 40)\n\nAlso H ^ H(t) ; ."- -rr = 0 along the optimal trajectory; also, we have that\n-rr\nH = 1 along the optimal trajectory.\n\nHence\n\nA. sine -H a cos -+A a cos L E l\nA\n-hL\nL\xe2\x80\x94\n\n(A. 41)\n\nThe adjoint equations are\n. ycose\xc2\xb1k)iln_k\n\n(A.42)\n\nand\n\ndA\n\ndt\n\n9L = _ l = n\n8a \xc2\xb0\n\nAlso, we still have\na (tf\n\nX\n\n=\n\n= COS\n\n(A JJ\nIA 431\n\n-\n\n-9-\n\nAlso, from H = 1,\n\nX\n\n2\n\n(X\n\n"X. 2 + X 2 / cos 2 L\nL\na\n\n/\n\n/ cos L)2\n\n\xe2\x80\x94 \xe2\x80\x94 cos L\n\nX 2 + X 2 / cos 2 L\nL\na\n\n* + A2\n\n. Xak\nX k\n\nL\n\nX k\n\nX2k2\n\n9\n\n2X k\n(A-45)\n\ncos2 L\n\nThe solution proceeds along the same lines as for the first problem.\nModel Number 3. Constant Current (North and South)\nLet VG = constant in the north or south direction. Then\n\n^[r = sin 6 + k\n\n(A.46)\n\nda _ cos 9\ndt ~ cos L\n\nH = XL (sin 9 +_ k) + X\nX\n= XL sin 6 + ~~L\n\ncos 6 + kXL\n\nAgain the control law will remain the same.\n\n(A.48)\n\n-10-\n\nThat is\n\nA,\n\nsin 6 =\n\n, cos 9 =\nA.\n\n2\n\n+ ^a\n\nA / cos L\na\nA.\n\n2\n\n2\n\n(A.49)\n\n2\n\n+ Aa\n\ncos2 L\n\ncos L\n\nBut the adjoint equations are\n\ndA.\n\n=\n\nA cos 9\n\nH\n\n- dA\n\nOt. _\ndt\n\ns\n\n1\n\nn\n\nL\n\n(A 50)\n\n\'\n\non\nn\n9oT=0\n\nAgain we see that the addition of a constant current to the model results in\nthe same form of solution. Clearly the second and third models may be\ncombined.\nModel No. 4. Linearly Increasing Currents (East and West)\nNow suppose that the ocean current is a linearly increasing function of\nlatitude. That is\n\nVc = + kL\n\n(A.52)\n\n- = sin 9\n\n(A.53)\n\nThen the system equations are\n\nda = cos_9\xc2\xb1kL\ndt\ncos L\n\n-11The Hamiltonian is\nH = XL sin\n\n6 + X (cos 6 + kL)/cos L\n\n(A. 55)\n\nThe optimal control law still remains the same as before; the adjoint variables,\nwhich actually determine the optimal control as a function of time are given\nin this case by\ndX.\n\n.._\n\nkX\n\ndA\n(A 57)\n\n"\xc2\xb0\n\n\'\n\nThe solution technique proceeds in the same manner as before\nModel No. 5. Linearly Increasing Currents (North or South)\nIn this case consider\nVc = + ka\n\n(A. 58)\n\n^i- = sin 9 + ka\n\n(A. 59)\n\nda = cos 9\ndt cos L\n\n,\nI\n\nThen the system equations are\n\nThe Hamiltonian is\n\nH = X. (sin 8 + ka) + X- cos 6/cos L\nL\n\xe2\x80\x94\na\n\n(A.61)\n\n-12-\n\nAgain there is no change in the optimal control law.\' The adjoint equations are\n\ncRT = - A cos 9 sin L/cos^\n\n(A.62)\n\nL\n\nand\n(A.63)\n\nThus we are no longer have that A is constant along an optimal trajectory.\nModel No. 6. Dynamical Model\nThe problem of determining the optimal steering angle to minimize transfer\ntime is similar to the problem of steering a ship to minimize propulsion losses.\nThis latter problem has been addressed [A.I], [A.2] and is briefly discussed\nbelow.\n\nComsider the representation depicted in Figure A.2. The ship\'s\n\nequations of motion may be written as\n(m - V) - Y.\nv\nr\n-N\'\n(I\n\n-K;\n\nY\'\n\n0\n\np\n\nI\n\n-or +\n\nv\n\nY\n\n)0\nxz\nK\')0\nP\n\nr\n\nN\n\nP\n.*_\n\nv\n\nY\n\nv\n\nr-\xc2\xbbu\n\nN\n\nY\np\nN\n\nr\n\np\n\nv\n\n%\nN\n\nY\n\nr\n\n^\n\nN\n\n0\n^\n\nKr\n0\n\nKp\n1\n\nK.\n<\xc2\xa3\n0\n\n6r\n\nP\n_\n\nK\n\n< )\n\n_0\n\n- t-\n\nN\n\n6r\n\n+\n\nKv\n\n"YD"\n\n6r\n\n6r\n\nD\n\nK\n\nD\n\n(A.64)\n\n+\n\n0\n\nwhere\nfy = yaw\nv = sway\np = roll\nand YD, ND> 1C represent the external disturbances on the ship due to the\nseaway. In addition, the ship\'s lateral motion is defined by\ny = v + Uijj\nfy = r.\n\n(A.65)\n(A.66)\n\n-13-\n\nFig. A.2 Ship coordinate system-body axes coordinates,\nforces, and moments. Abstracted from [A.I].\nEquations (A.64), (A.65), and (A.66) may be written in state space representation as\nAX = BX + Cu + DW ,\n\n(A.67)\n\nor, rewriting in standard form\n\nX = FX + B u + GW\n\n(A.68)\n\nwhere F=A~ B, B =A~ C, and G=A D. The state vector is X, the control vector\nis u, and the disturbance vector is W.\nRepresentative open loop lateral plane system eigenvalues for a highspeed\ncontainership at full-load design condition for speeds of 16, 23, and 32\nknots are [A.I]:\n\n-14-\n\nA\n\nr\xe2\x84\xa2 RqS\n2\n\n-0.0584 x 10"\n-0.792 x 10"1\n23 Knots\n\n0.00\n-0.839 x 10"2\n-0.114\n\n32 Knots\n\n0.00\n-0.117 x 10"1\n-0.158\n\nA simulation model for this system has been developed [A.I] and is represented\npictorially by the block diagram shown on Figure A.3.\n\nGEAR BACKLASM,\n\nCOMPASS STEP\nREPEATER\n\n/~7.i*\n\nis\n\n*\n/\n\nA\nf\n\n6Y rocOMPASS\n\n\xc2\xab*co"*ss ( i H-\n\nSHP\n\nHYOROOYNAMC EQUATION\n\nX\'FX^ffV0"\n\nGYROCOMPASS\n\nKINEMATICS\n\nA = p SIN P SEC R\n\nSEAWAY\n\nDISTURBANCE\n\nR \xe2\x80\xa2 - p COS P\nP = - q - p SIN P TAN R\n-PSEUDO PITCH OYNAMCS\n\nFigure A.3 Nonlinear simulation model. Abstracted from [A.I].\nThe problem is to determine the controller that will minimize propulsion\nlosses due to steering.\n\nThese losses may be shown to result from excess\n\npower consumption per unit distance travelled in the X-direction caused by\nthe added resistance due to steering. This is related to the instantaneous\nsurge due to steering, which is\n\n-15-\n\nAX = (m + (p/2) LAX\' ) vr + (l/2)](p/2) AX\',] v2\n\n(A.69)\n\n+ (l/2)[(p/2) AX\'66 U2] 62\nwhere m denotes mass of ship; p, density of sea water; L, ship length between\n2\nperpendiculars; A=L ; U, ship\'s water speed; v, sway velocity of ship; r, yaw\nrate of ship; 6, rudder angle; X1 , force coefficient due to yaw/sway (+ve);\nX\'r-r. force coefficient due to rudder angle (-ve); X\' , force coefficient due\nto sway. From this, the mean surge relevant to steering may be written as:\nAX = [m + (p/2) LAX;r] (va rg/2) cos (4>v - <f>r)\n+ (1/2) [(p/2) AX;v](v2/2)\n+ (1/2) [(p/2) AX\'O U2](62/2)\nO\nQ\n\n(A.70)\n\nSince the ship motions resulting from seaway disturbances are oscillatory, a\nperformance criterion for added resistance due to steering may be formulated\n\nas:\nJ = (1/2) r [-A" vr + nv2 + <52] dt\no\n\n(A.71)\n\nX" = 2[m + (p/2) LAX;r]/[(p/2) AX\xc2\xa36 U2]\n\n(A.72)\n\nn = x;v/x-6 u2\n\n(A.73)\n\nwhere\n\nboth inversely proportional to speed squared.\nThe simulation program described in Ref. [A.I] has been used for the\npurpose of evaluating controllers to minimize the cost function, J, defined\nby equation (A.71).\n\n-16-\n\nBy combining the two methods of analysis described in this appendix the\nglobal optimal controller may be determined.\n\nReferences\nA.I. R. E. Reid and J. W. Moore, "Optimal Steering Control of High Speed\nContainerships: Part 1 System Dynamics," Proceedings of the 1980 Joint\nAutomatic Control Conference, Vol. 1, August 1980.\n\nAPPENDIX B\n\nThis appendix includes the listing of the program to solve the linear\nsystem Hx = y of rank five. Two routines are used to solve the same linear\nsystem.\nSubroutine SOLVED is written in the normal FORTRAN manner using Do-loops,\ndouble subscripting, etc.\nway.\n\nSubroutine SOLVE is written in a more primitive\n\nSOLVE evaluates all subscripts by single additions, uses no Do-loops, and\n\nisolates floating point operations in a way that will facilitate an easy\ntransition to an assembly language version of the code.\nCode developed for the navigation filter will incorporate the features of\nSOLVE.\n\nIf the time required to obtain a ship\'s position needs to be reduced\n\nthen the program could be written with a minimum of effort.\nOn the MDS-230 system (^2 MHz) the approximate times required for the\ntwo methods are:\nSOLVED\n\n2.1 sec.\n\nSOLVE\n\n1.7 sec.\n\nOWGK4AL PAGE B\nOF POOR QUALITY\n\nc\nc\nc\nc\nc\nPROGRRM NS\n\nD1 MENS I ON H < 24, 5 > , HTHCi < 5, 6 >, HTH C 5, 6 > , V C 24 > , XO < 5 > , X < 5 >\nDRTR IW.-"\' e.--1\nC\n\nOPEN \xe2\x80\xa2:: Uf-J I T= I W, F 1 LE = - : Fl : OUTPT "\' >\nRERDO, *.. END=999.. ERR=999> ITER\nWRITECIW,5> ITER\n5 FORMRT <:.-\xe2\x80\xa2\'"\xe2\x80\xa2 NUMBER OF ITERRTIONS ON ERCH LOOP = - , 14.\xe2\x80\xa2\xe2\x80\xa2\'\':.<\nC\nDO 20\n1=1, 24\nV \xe2\x80\xa2:: I > = SI N \xe2\x80\xa2:: FLORT C I > --1 C 24. *3. 14\xc2\xb16 > >\nDO Id\n-J=l, 5\nH \xe2\x80\xa2:: I, .J ::\xe2\x80\xa2 = F L O R T \xe2\x80\xa2:\' I + ..T > + \xc2\xb1. . -\' FLORT < I +.J >\nIS CONTINUE\n20 CONTINUE\n\nC\nDO 40\n\n1=1, 24\n\nw F;: i T E (. i t-j, 3 e > < H \xe2\x80\xa2:: i, j >, j =1,5 >, v \xe2\x80\xa2:: i>\n3:8 FORMRTCS-^IX, E10. 4>, 4X, E10. 4>\n40 CONTINUE\nC\n\nPRUSE \xe2\x80\xa2- BEGIN FIRST LOOP\nDO 50\n1=1, ITER\nCRLL SOLVE0\':.H, HTHUL V, X0 .:\xe2\x80\xa2\n50 CONT I NIJE\nPRUSE \' END OF FIRST LOOP\nC\nk WRITE-::iW, 60 >\n60 FORMRT-,.-\xe2\x80\xa2\':\xe2\x80\xa2.\'\nDO 70\n1=1,5\nWR I TE \xe2\x80\xa2:: I W, 3:0 > < HTH0 < I, J > , .J=l, 6 >\n70 CONT I NLIE\nWR I TE \xe2\x80\xa2:: I W, 80 > \xe2\x80\xa2:: X0 \xe2\x80\xa2:: I >, 1=1, 5 ::>\nS0 FORMRT <." SOLUTION VECTOR XO"V5< IX, Ell. 5>^>\n.\'\xe2\x80\xa2\n\nC\n\nPRUSE \'\xe2\x80\xa2 BEGIN SECOND LOOP\nDO 90\n1=1, ITER\nCRLL SOLVE <:H, HTH, V, X >\n90 CONTINUE\nPRUSE " END OF SECOND LOOP\nC\nDO 100 1^=1, 5\n\'\nWRITE CIW/20 > <HTH <I, J >, J=l, 6 >\n100 CONTINUE\nWR I TE < I W, 110 > <! X C I > , I =1, 5 ::\xe2\x80\xa2\n110 FORMRT C/\' SOLUTION VECTOR X"V5-:: IX, Ell. 5>,\'\' >\n\nC\n\n999 STOP\nEND\nC:\nC\nC\nC\nC\n\nSUBROUTINE SQLVECKH.. G", V.. X>\nD I MENS I ON H < 24, 5 > , G C 5, 6 > , V < 24 > , X < 5 >\n\n..T=L 5\niee\nDO 80\n1=1.. 5\nI F<; I. GT. J> GO\n\nOF P\xc2\xb0 \xc2\xab\n\nDO\n\ns= 0.\n\nDO 5\xc2\xa9\n\nTO\n\n80\n\nK = l, 24\n\ns= s + H<K, .J>*I-KK, i\n\n50 CONT I NUE\nG <: I , J > = S\nG>:: J, I >= S\n89 CONTINUE\n100 CONTINUE\nDO 15O\n-\xe2\x80\xa2= 0.\nDO 120\n\n1=1, 5\n-J = l, 24\n\ns= s + V<J::\'*H <-T, i>\n120 CONTINUE\nG (. I .. 6 > = S\n15O CONT I NUE\nDO 300\n.J =\nR8= \xe2\x80\x941. /G<\nJP1= ,\nDO 280\nI = JP1, 5\nR= R0*G< I .\xe2\x80\xa2 J >\n\nC\nDO 250 K=.JP1, 6\nG < I, K > = R+G \xe2\x80\xa2:; .J, K > + G \'\xe2\x80\xa2. I, K \'.\'\xe2\x80\xa2>\n250 CONTINUE\n280 CONTINUE\n300 CONTINUE\n\nC\nX-::5::-= G<5, 6 > .\xe2\x80\xa2-\'G\':: 5, 5 >\nDO 350\nI 1=1, 4\n1= 5-I I\nIP1= 1+1\n\nC\nS= G1\'. I.- \xe2\x82\xac\xe2\x80\xa2 :\xe2\x80\xa2\'\nDO 320\nJ=IP1,5\nS= S - G-:: I, -J > *M \xe2\x80\xa2:: J >\n320 CONTINUE\n\nxt: I >= S/G-;: i, i ::\xe2\x80\xa2\n\n350\n\nC\nC\nC\nC\n\nCONTINUE \'.\nRETURN\nEND\n\nORIGINAL PAGE 13\nO\nR\nUAUTY\n\ni\'Ue\'r,(_"_\' i A HC. i\'UuS\'E kH> U- V> A.-1\nDI MEMS I ON H <: 1 > , G < 1 >, V < 1 >, X C1 >\nINTEGER GRDR, HRDR, VRDR, GPTR, GTBRSE, HBRSE, GTPTR,\nHTBRSE, HPTR, HTPTR, VERSE, VPTR\n\n-\xe2\x80\xa2-\n\nINTEGER XRDR, R0PTR, G-JBRSE, GIBRSE, RPTR,\nGIPTR, GJPTR, GBRSE, XPTR\nINTEGER*! I, J, K\n\nC:\nHRDR=\nGRDR=\nVRDR=\nXRDR=\n\n1\n1\n1\n1\n\nGPTR= GRDR - 1\n\nGTBRSE:= GRDF? - 6\nHBRSE= HRDR - 25\nC\nJ= \xe2\x82\xac.\n1.0 J=\n\nJ\xe2\x80\x94l.\n\nIF\'-.J. E ! & :.\xe2\x80\xa2 GO TO\nG.\nGTBRSE= GTBRSE + 1\nGTPTR= GTBRSE\nHTBRSE= HF-.DR - 25\nHBRlT.E= HBRSE -i- 24\n\nC\n1= \xe2\x82\xac.\n\xc2\xa30 1= 1-1\nIF\xc2\xab::i. EQ. e> GO TO 1O\nGPTR= GPTR + 1\nGTPTR= GTPTR + 5\nHTBRSE= HTBRSE + 24\nIF< I. LT. J > GO TO 2M\n\nC\nHPTR= HBRSE\nHTPTR= HTBRSE\nS= ft.\nK= 25\n2tt K= K-l\nIFCK. EQ. 0> GO TO 50\nHPTR= HPTR H- \xc2\xb1\nHTPTR= HTPTR + \xc2\xb1\nS= S -i- H \xe2\x80\xa2:. HPTR >*H\':: HTPTR >\nGO TO 30 .\nJ F < I . EQ. > GO\nGC GTPTR >= S\nGO TO 20\n\nTO\n\n20\nORIGINAL PAGE IS\nOF POOR QUALITY\n\n106\n\nHPTR=\n\nHRDR -\n\n1\n\n-\n\nVE:RSE= VRDR - i\n\nc\n\nJ= 6\n\nne j= j-i\nIFCJ. EQ. 0> GO TO 140\nGPTR= GPTR + 1\nVPTR= VBRSE\nS= 0.\n1= 2t.\n120 1= 1-1\nI F\' C 1. EQ. 0.\xe2\x80\xa2 GO TO 1 :\n\':\n20\nHPTR= HPTR + 1\nVPTR= VPTR + 1\n\nS= S -t- H <: HPT R : \xe2\x80\xa2 V\'::VPTR >\n:*\nGO TO 120\n\ni3u G\'::GPTR>= s\nGO TO 1 .\n10\n\nc\nc\n140 R0PTR= GRDR - 6\n\nGJBRSE= GRDR - e\n\nc\n\nJ=\n\n210\n\n0\n\n.J= J+l\n1FGJ\nEQ. 5 i.\'1 GO TO 2 0\n:0\nR0PTR= R0PTR + 6\nRPTR= R0PTR\n\nC\nG,TBRSE= G.JBRSE + 6\nGIBRSE= GJERSE\n\nC\n220\n\n1= J\n1= 1+1\nI F X I . EQ. 6>\nRPTR=\nfs =\n\nGO TO 210\n\nRPTR + 1\n\nR VJ:+: 1J t; Ft p T R >\n\nGIBRSE= GIBRSE + 1\nGIPTR= GIBRSE\nG,TPTR= GJERSE\n\nC\nK= J\n\'"\n\xe2\x80\xa2/\n230 K= K>1\n\nIF\xc2\xab::K. EQ. 7> GO TO 220\nGIPTR= GIPTR * 5\nGJPTR= GJPTR + 5\nGCGIPTR>= R*G<:GJPTR::- * G < GIPTR>\nGO TO 2 :\n20\n\nORIGINAL PAGE IS\nOF\n\nPOOR QUALITY\n\nORIGINAL PAGE \xc2\xbbS\nOF POOR QUALITY\n\nc\n200\n\nGBRSE= GRDR + 30\n\n1= 6\n210 1= 1-1\nIFcil. EQ. 0> GO TO\nGBRSE= GBRSE - 1\nGPTR= GBRS-E\nXPTR= XRD-R + 5\nS= G<GPTR)\n\n340\n\nC:\n\nj= \xc2\xab=\xe2\x80\xa2\n328 J= -1-1\nIFCJ. EG-!. I> GO TO 330\nGPTR= GPTR - 5\nXPTR= XPTR - 1\nS= S - G <. GPTR }*X<: XPTR :>\nGO T O 3 2\n:0\n\nC\n330 XF\'TR= XPTR - 1\nGPTR= GPTR - ^i\n\nX-::XPTR:>= S/GCGPTR;:-\n\nc\n\nGO "TO 310\n\n340 RETURN\n\nEND\n\nSOLUTION VECTOR J<@\n-. 12363E+00 . 29913E+00 -. 62771E-01 -. 21159E+00\n\n. 11195E+00\n\nSOLUTION VECTOR X\n-. 12363E+00 . 29913E+00 -. 62771E-01 -. 21159E+0Q\n\n. 11135E+0O\n\n'