b'CIRCULAR DATAIMAGES FOR DIRECTIONAL DATA\n\nBy William Morphet\n\nDissertation Director\nDr. Juergen Symanzik\nDepartment of Mathematics and Statistics\nUtah S a e University,\ntt\nLogan, Utah\n\nKey Words\nCircular ChoropleW Circular Data/ Circular Dataimage/ Circular-Spatial Exploratory Data Analysis\n(CSEDA)/ Circular Statistics/ Dataimage/ Directional Data/ Exploratory Data Analysis (EDA)/\nGraphical Statistics/ Hydromagnetics/ Interactive Graphics/ Magnetohydrodyamics/ Paleomagnetism/\nSpatial Statistics/ Visual Data Mining (VDM)/\n\n02004 Bill Morphet at ATK Thiokol Inc., an Affiliate of Alliant Techsystems Inc.\n1\n\nAbstract\nDirectional data includes vectors, points on a unit sphere, axis orientation, angular direction, and\ncircular or periodic data. The theoretical statistics for circular data (random points on a unit circle) or\nspherical data (random points on a unit sphere) are a recent development. An overview of existing\ngraphical methods for the display of directional data is given. \xe2\x80\x9cCross-over\xe2\x80\x9d occurs when periodic data\nare measured on a scale for the measurement of linear variables. For example, if angle is represented\nby a linear color gradient changing uniformly from dark blue at -180 degrees to bright red at +180\ndegrees, the color image w l be discontinuous at +180 degrees and -180 degrees, which are the same\ni\nl\nlocation. The resultant color would depend on the direction of approach to the cross-over point. A\nnew graphical method for imaging directional data is described, which affords high resolution without\ncolor discontinuity from \xe2\x80\x9ccross-over\xe2\x80\x9d. It is called the circular dataimage. The circular dataimage uses\na circular color scale in which colors repeat periodically. Some examples of the circular dataimage\ninclude direction of earth winds on a global scale, rocket motor internal flow, earth global magnetic\nfield direction, and rocket motor nozzle vector direction vs. time.\n\nINTRODUCTION\nDirectional data includes random variates of type circular, axial, and spherical. Circular random\nvariables have the total probability of all possible directions represented as a unit area between a circle\nof radius one and an enclosing curve. The radial distance between circle and curve is the probability\nn\ndensity at a angle. Axial random variables describe random axis direction of axes where there is no\nreason to distinguish one end of the axis from the other, e.g. crystal axis orientation. Spherical random\nvariables are random points on a sphere of radius one. Random vectors in a plane or 3D space have, in\naddition to random direction, random magnitude. Recent books on circular statistics include (Mardia,\nJupp, 2000) and (Jammalamadaka, Sengupta, 2001).\nApplications\nSome Applications of Circular StatisticsProbability include: creature departure/vanishing direction at\npoint of release (Biology), direction of fault lines or crystal axis orientation (Geology), magnetic field\ndirection (Geophysics), response to treatment relative to time (Chronotherapeutics),wind direction\n(Meteorology), and ocean currents (Oceanography).\nHistorical Summary (Fisher, 1993)\nMost of the theoretical advances in the statistics of circularhxial random variables are relatively recent.\nIn 1767, John Mitchell, FRS tested the hypothesis that the distribution of angular separations of stars\nwas uniform. He determined that the number of close stars were too many to support this hypothesis.\nIn 1802, John Playfair noted that directional data should be analyzed differently &om linear data, and\nrecommended that average direction be the vector resultant direction. In 1858, Florence Nightingale,\nchief nurse in the British Army during the Crimean War, created the rose diagram to display the effect\nof sanitation vs. month of year to save thousands of lives in military hospitals. In 1880, Lord Rayleigh\ncreated a statistical test of the uniform circular distribution vs. the unimodal alternative. In 1918, Von\nMises defined the circular normal, or Von Mises distribution. This distribution is a basis of parametric\nstatistical inference for circular data. In 1939, Krumbein introduced the transformation of axial to\nvectorial data for analysis, and back transformation to axial results. In 1955, Potter smoothed\ndirections on a regular grid on a map by averaging direction in four adjacent grid cells. The paper by\nG. Watson and E. Williams about statistical inference for the mean and dispersion of a sample fiom the\nVon Mises distribution began significant theoretical development. In 1976, S. Jammalamadaka\ncreated tests for uniformity based on runs or spacing.\n\n2\n\nThis paper is organized as follows. First, existing methods for display of circular data will be\nsummarized, including: The circular data plot for raw data; the rose plot and circular histogram to\nsummarize frequency by in intervals on a circular scale; and non-parametric methods of representing\nfrequency vs. location on a circular scale.\nThe cross-over problem from applying scaling for linear variables to directional data will be briefly\ndescribed, a proposed solution detailed, and examples of the new paradigm for the display of high\nresolution directional data will be given including a circular choropleth (circular data on a map), flow\nimage for CFD flow analysis, and circular time series for periodic and other processes. The new\nmethod may also be applied to vectors on contour or perspective plots.\nDATA USED IN FIGURES 1-4\nThe Comprehensive Ocean-Atmosphere Data Set (COADS) was created to provide a consistent and\neasily used historical record of surfwe marine data for 1854-1979. COADS began in 1981 as a\ncooperative project of National Climatic Data Center (NCDC), Environmental Research Laboratories,\nn\nthe cooperative Institute for Research i Environmental Sciences, and the National Center for\nAtmospheric Research.\n70 million unique reports &om ships-of-opportunity (primarily) and ocean buoys contain 28 elements\nof weather, position, etc. This data has been organized, edited removing outliers and data over land,\nand statistically summarized for each month using 2 x 2 degree latitude-longitude boxes. The trimmed\nmonthly summaries give mean and median statistics for observed air and sea surface temperatures,\nwind, pressure, humidity, cloudiness, and derived variables.\nThe wind data used in figures 1-4 was extracted from the COADS dataset, following the tutorial on the\nII\nCOADS webpage ( R Data Library, 2004),for the period fiom 1980 to 1990, January to April, and for\narea latitude 3 s to 3N and longitude 93W to 87W. Wind direction is in degrees from East, positive\nsense CCW, and magnitude in d s .\nOVERVIEW OF EXISTING METHODS - GRAPHS FOR RAW DRECTIONAL DATA\n\n\\\n180\n\n270\n\n270\n\n:\nurndl\n\na) Circular Data\n\nb) Axial Data\n\nc) Vector Data\n\nFigure 1, Plots for Raw Data, Using Wind Data Subset From COADS Dataset\n\n3\n\nHow These Charts For Raw Data Work\nFigures 1 a-b were generated using R (R Development Core Team, 2004) and contributor library\nCircStats (Lund, 2001). In figures 1 a-b, a bin width is specified as for a histogram. The number of\ndata in each bin is determined. The data points are either overplotted, or stacked on the outside or\ninside of a circle in their bin. In figure la, circular data from the COADS subset have been stacked in\n12 bins on the outside of a unit circle. Figure l b is a graph of artificial axial data derived from the\nwind data by subtracting pi from any angle greater than pi, then constructing an axis thru each point.\nFigure ICis simply an overplot of vectors showing magnitude together with direction. Figure ICwas\ngenerated using R and Fields (Nychka, 2004).\nInterpretation\nMost of this wind data are in a direction 135 degrees or wind blows from SE to NW. The distribution\nis Unimodal and approximately symmetric. Note that this estimate depends on bin width.\n\nOVERVIEW OF EXISTING METHODS - HISTOGRAMS FOR CIRCULAR DATA\nAnother common method of representing data is to plot a histogram. The data are grouped in intervals\nand summarised by count. A rectangular bar is constructed of area proportional (a) the count in the\nto\ncorresponding interval. The bars are centered above the midpoints of the intevals. The vertical axis of\nthe histogram shows the count in each interval on the horizontal axis. With the histogram, we can see\nthe frequency with which data occurs relative to value, whether frequency is consistent over the range,\nt\nor data is concentrated a some value.\n\nA histogram for angular data may be formed by first constructing linear histogram of the angular data\nas it were linear data. We select some starting point (e.g. 0 degrees if the data are recorded in the range\n[0,360), or -180 if the data are in the range [-180,180), and select some binwidth or grouping interval\n(e.g. 5,10, or 20 degrees). The next step is to wrap the horizontal axis of linear histogram around a\nunit circle. The bars are aligned with the circle center, centered on the interval midpoint, and have\nlength or area oc relative frequency. The bars can be replaced by whiskers of length a relative\nfrequency, or wedges or sectors with radius or area oc relative frequency.\nThe wind data plotted in figure 2 a-d is the same wind data plotted in figures 1 a-c. Figure 2a was\ngenerated using R CircStats (Lund, 2001), and figures 2 b-d were generated by Oriana 2 (Kovach\nComputing, 2004).\n\n4\n\n. .\n\n\xe2\x80\x99E\n\n0\n\nrm\n\na) Rose Plot\n\nb) Circular Histogram\nencm\n\n90\n\n0\n\n2m\n\nc) Rose Plot with Grouping Variable\n\n16\n\n1pI\n\nw\n\nUCSR\n\nd) Linearized Circular Histogram\n\nFigure 2, Histograms for Summarizing Frequency Relative to Direction\nUsing Wind Data Subset From COADS Dataset\nHow These Charts WorwInterpretation\nFigure 2a is a rose plot (Nightingale, 1858) generated by R CircStats. The angle of the wedge is the\ncounting bin width. The radius or area of the wedge is set equal to the corresponding bin count.\nHowever, area is preferred to radius because \xe2\x80\x9cradius results in perceptual bias in favour of larger\nfi-equencies\xe2\x80\x9d (Fisher, 1993). Fisher\xe2\x80\x99s book is a handbook of methods for circular random variables.\nFigure 2b is a circular histogram. A radial bar has area equal to frequency. Figure 2c partitions the\nrose plot of figure 2a by a sub-grouping variable (l=Jan, 2=Feb, 3=Mar, &April). Figure 2d unwraps\nthe circular histogram of figure 2b onto a linear scale. This linear histogram repeats one period, which\nis an advantage if a feature of interest occurs near 0 degrees, and in visually extracting the periodicity.\nIn figures 2 b-c, the mean direction is indicated by a thick black radial line with confidence interval\nindicated by a thick black arc. In figure 2d, the mean is indicated by a thick black vertical line with\nconfidence limits indicated by the enclosing vertical dashed lines. In the Oriana 2 (Kovach\nComputing, 2004) plots (figures 2 b-d), the confidence interval changes to red when the estimate of the\nconfidence interval is unreliable. The confidence interval for the mean is about 122 +/- 20 deg and\nreliable. In figure 2c, the mean direction appears to vary with month.\n\n5\n\nOVERVIEW OF EXISTING METHODS - NON-PARAMETRIC KERNEL DENSITY\nESTIMATES (KDE)\nCircular histograms of figure 2, like histograms for linear variables, can have significant distortion of\nthe information in the sample about the number, sizes, and locations of modal groups thru the choice of\nbin ongin and width. The non-parametric kernel density estimate replaces the bin edge and origin\ndecision with an easier band width decision. Alternatively, for a method that is easier to explain, the\nASH may be implemented for rose plots or circular histograms (Scott, 1992).\nThe wind data plotted in figure\n\n-10\n\n-05\n\n03\n\n05\n\n10\n\na) KDE Plotted on Radius=l\n\nb) KDE Plotted on Min Radius c) KDE Unwrapped & Plotted on\nRepeating Linear Scale\n\nFigure 3, Non-Parametrically Smoothed Histograms of Frequency vs. Direction\nUsing Wind Data Subset From COADS Dataset\nConstruction of a Kernel Density Estimate\nThese charts were generated using non-parametric smoothing (N. I. Fisher, 1993, p. 26). In nonparametric smoothing, a symmetric function, e.g. quartic kernel, is placed on each observation. It\nspreads out the mass of an observation with maximum amplitude at the location of the observation.\nThis is motivated by considering that the observation is an instance of random direction and could have\noccurred at other locations in neighborhood of the observed direction. Density at an angle of\nestimation is s u m of kernel contributions fiom observations around the angle of estimation.\nHow these Charts Workhterpretation\nDifferent effects result fiom plotting the estimated density on different radii of one, smallest density,\nand zero. In figure 3%the probability density is plotted on a unit circle. This emphases regions of\nhigh probability density (Fisher, 1993, p.24). In Figure 3b, the probability density is plotted on a circle\nof radius = minimum density emphasizing the variation in probability density with direction. In figure\n3c, the density is unwrapped onto a linear scale with an extra period. Note that in the middle of the\nhorizontal axis, the scale values repeat beginning at 0 degrees. This method removes the subjectivity\nassociated with choice of plotting radius, and the repeated plot makes it easier to interpret structure,\ne.g., periodicity and count modes. The extra plot also eliminates breakup of interesting features at the\ncrossover point of zero degrees. Axis (Pisces Conservation Ltd, 2004) provides smoothing using a\nfast fourier transform. The linearized histogram in figure 3c indicates there is 1 mode at about 118\ndeg.\n\n6\n\nOVERVIEW OF EXISTLNG METHODS - ARROW PLOTS OF VECTOR-SPATIAL DATA\nThe wind data plotted in figure 4 is the same data plotted in figures 1-3.\n\na) Raw Dt\naa\n\nb) Average (Vector Resultants) of Raw Data\n\nFigure 4, Vector-Spatial Plot, Using Wind Data Subset From COADS Dataset\nVectors of magnitude and direction are represented by an m o w superimposed on a surface, contour,\nor perspective. See also figure 12c. In figure 4b, the regional structure of the mean wind vector is\ncontinuous and regular. Direction is changing in the S-N direction and relatively constant in the W-E\ndirection.\nINTRODUCTION TO DATAIMAGES FOR CIRCULAR DATA\nDATAIMAGES FOR LINEAR DATA\nThe new dataimage for circular variables (Morphet, 2004) evolved fiom the dataimage for linear\nvariables (Minnotte, 1998, 1999), which in tum, evolved fiom the color histogram (Wegman, 1990).\n\nIn 1990, Wegman created a relatively simple plot for visualizing hyper-variate (dimension greater than\nthree) data structure. With variables plotted along one axis and observations along the second axis, up\nto several hundred variables and several hundred observations can easily be observed. Pixels were\ncolorized according to a binned color gradient, and he called the result a color histogram. As\nsuggested by Wegman, positive and negative association among variables is easily seen by sorting by\neach variable.\nThe dataimage (Minnotte, 1998,1999), like the color histogram, arrayed observations on the horizontal\naxis and colorized variables on the vertical axis forming a hypervariate image. The capability to image\nhypervariate structure was enhanced by standardizing variables, implementing a continuous linear\ncolor gradient, adding distance metrics, computing n-dimensional distance between observations, and\nadding sorting methods for both variables and observations according to n-dimensional distance.\n\n7\n\nIn the continuous red-cyan gradient (figure 5), as the level of a variable increases, the red, green, and\nblue levels of a pixel change linearly with red decreasing, and green and blue increasing uniformly.\nPure red indicates the minimum of a variable and cyan the maximum.\nDistance metrics implemented include: euclidean - L2; manhattan - L1; and maximum - L-Infinity.\nSort methods implemented include: none - leave in original ordering; complete - hierarchical\nclustering, where cluster distances are measured as max of point distances; single - hierarchical\nclustering, where cluster distances are measured as min of point distances; average - hierarchical\nclustering, where cluster distances are measured as average of point distances; fasthest - farthest\ninsertion spanning tow, nearest - nearest insertion spanning tour; prcomp - sort on first principal\ncomponent; mds - sort by 1-D multidimensional scaling; and k - sort on variable k.\nFigure 5 is a dataimage of weight (wt), displacement (disp), horse power (hp), and miles per gallon\n(mpg) of 32 1973-74 model cars extracted f?om the 1974 Motor Trend US magazine (Henderson,\nVelleman, 1981). The image shows an inverse correlation between mpg and {hp, disp, wt) . The\nvertical bands indicate two major clusters (subgroups) of cars: {low weight, low displacement, low hp,\nt\nhigh mpg) at the left,, and (high weight, high displacement, high hp, low mpg) a the right. The\nMaserati Bora has the greatest hp, the Toyota Corolla has the greatest mpg, and the Chrysler Imperial,\nLincoln Continental, and Cadillac Fleetwood have the largest weight, displacement, and lowest mpg..\n\nFigure 5, Dataimage, a Multivariate Plot of Motor Trend Car Data\nWhen observations are ordered by time, dataimages reveal discrete events as pattern perturbations, and\nmultivariate trends as color gradients. Observations andor variables also indicate clusters, outliers,\nand correlation as visual structure.\n\n8\n\n..\n\nTHE "CROSS-OVER PROBLEM"\n\nOn a compass, the average direction of 1" and 359" is not the arithmetic mean of 1 and 359 =180. It is\n0" or 360". This has been called the "cross-over problem". Cross-over also occurs when plotting\nangle on a linear scale vs. time. The plotted angle can vanish at the bottom of the scale at 0" and\ninstantly reappear at the top at 360" resulting in a discontinuous plot.\nA NEW GRAPHICAL METHOD - DISPLAY OF DIRECTION DATA USING A COLOR WHEEL,\nA CIRCULAR/PERIODIC SCALE\nThe dataimage for linear variables is extended to directional data by displaying the value of direction\nas a color on a periodic color scale, or "color wheel" such as in figure 6. Displaying direction as a\ncolor fiom the corresponding position of the color wheel, the representation of any cross-over point,\ne.g. 0 deg, is continuous through the crossover point, whether approached from one side or the other of\nthe crossover point. This eliminates the cross-over problem.\n\nN\n\nFigure 6, A GBYR (Green Blue yellow Red) Periodic Color Scale, or Color Wheel\nFlow analysis and circular statistics graphics from commercial and free software (see References) were\nexamined to determine if the proposed method had been previously implemented. No examples of this\nmethod have been found. In Fluent, a CFD flow analysis system, vector angle is imaged by coloring\npixels corresponding to - 180" a deep blue. The linear color gradient (Gouraud shading) increases\nuniformly to bright red at +180". The resulting image is discontinuous about the 180". Consequently,\nusers may examine partial images oriented so the direction of interest lies at 0" to avoid directions\naround 180".\nFollowing some details of color wheel construction, examples will be given including wind direction,\nihn\ninternal flow w t i a rocket motor chamber, earth magnetic field, and circular time series. The first\ncircular dataimage was of Space Shuttle solid rocket motor nozzle vector direction (Morphet, 2003-4).\n\nCOLOR WHEEL CONSTRUCTION\n\nIn figure 6, the color wheel has 4 main colors: green, blue, yellow, and red going CCW from East or 0"\nin this application, so it is called a GBYR (green blue yellow red) color wheel. The selection of this\ncolor scheme is a reflection on green forests to the east, cold blue glaciers to the north (for another 30\nyears?), yellow deserts to the west, and red hot summers to the south. These four colors seem to be\nmore intuitive than three colors in a geographic context.\nThe color wheel in Figure 6 was implemented in R 1.09 (CRAN, 2004). Like a smoothing spline, it\ncontains 4 continuous linear color gradients (Gouraud shading) with color continuity at the knots. In a\nGBYR color wheel going 0" to 90\xc2\xb0, the color green is decreased and the color blue is increased. The R\nrgb command creates "colors" corresponding to the given intensities (between 0 and max) of the red,\ngreen and blue primaries, respectively:\nif(Angle -= 90) # green to blue gradient\ni\nn\n1\ndist = 2 5 A ge9 , -1\n5 * n l/ 0&green\ncolor = rgb(O,255-dzt, dist, maxColorValue=255)\n\nyzl y - q\n\n1\n\nif(Ang1e >= 90 & Angle < 180) # blue to yellow (red + green) gradient\ndist = 255*(Angle - 90)/90\ncolor = rgb(dist, dist, 255-dist, maxColorValue=255)\n\n1\nif(Ang1e >= 180 & Angle < 270) # yellow to red gradient\n{\ndist = 255*(Angle - 180)/90\ncolor = rgb(255,255-dist, 0, maxColorValue=255)\n\n1\nif(Ang1e >= 270) # red to green gradient\n{\ndist = 255*(Angle - 270)/90\ncolor = rgb(255-dist, dist, 0, maxColorValue=255)\n\n1\nCOLOR CONSIDERATIONS\n\nIn figure 6, the color saturation at a particular angle is constant. However, vector resultant magnitude,\nnumber of observation, or other statistic have been used to modify color saturation by reducing the\nlevels of red, green, and blue proportionately. Weighting saturation by the amount of data and/or\nresultant magnitude draws attention to significant areas. The colors of all directions fully desaturate to\nblack, which may be the color of missing data. The use of color in computer graphics is described in\n(Foley, Van Dam, 1992). About 99% of color blindness is the inability to distinguish red and green.\nSubstitution of magenta for red may reduce low saturation red-green color impairment. Colors for the\ncolor impaired are described in http://www.toledo-bend.com/colorblind/index.html(9/19/04).\n10\n\nEXAMPLE - CIRCULAR CHOROPLETH\nData used in figure 7: Comprehensive Ocean-Atmosphere Data Set (COADS) wind direction in\ndegrees from East (positive sense CCW) and magnitude in d s , Longitude -15 1" to +51", Latitude\n-45" to +45", 1972-3, 1975-6 (IRI Data Library, 2004).\n\nI\n\n-150\n\n-100\n\n-50\n\n0\n\n50\n\nLongitude\nFigure 7, Circular Choropleth of Average Ocean Wind Direction\nUsing Wind Data Subset From COADS Dataset,\nGreen:West-to-East, B1ue:South-to-North, Yel1ow:East-to-West, Red: North-to-South\n\nIn figure 7, each pixel is horizontally 2 degrees of longitude and vertically 2 degrees of latitude.\nDirection is indicated by a GBYR (green blue yellow red) color wheel. Black indicates missing data or\nland mass. Winds were averaged over the years 1972-3 and 1975-6 taking into account vector\nmagnitude wind speed:\n\nI E {minimum longitude, maximum longitude}\nJ E {minimum latitude, maximum latitude}\nNI is the number of observations in grid cell IJ\nK E l:N, is the observation index\n\nMI\n\n0,\n\nis magnitude of vectorial observation K in grid cell IJ\nis direction in radians of vectorial observation K in grid cell IJ\n\natan-\' is the quadrant specific inverse tangent\n\n11\n\n..\nInterpretation\nWest of south end of north America, the green to red to yellow color gradient indicates a turning of\nwind from east to south to west. On both sides of the equator in this global scale, average wind flows\ntoward the equator, then goes west. The color shape of wind direction on the west side of the\nAmericas is similar to the color shape on west side of Afiica. Apparently, the continental masses have\nsimilar effect on global wind. The speckled area at lower latitude and in the upper right is due to low\nsample size resulting in higher variability in the mean (vector resultant) direction.\n\nEXAMPLE - FLOW IMAGE\nThe solid rocket motor flow data in figures 8-9 is simulated (ATK Thiokol Propulsion, 2004) using\narbitrary geometry and fictitious motor properties. Features of the rocket motor chamber shown in\nfigure 8 include the forward end at X=O in., experimental cavities at about X = 6 in., and nozzle fi-om\nX = 13 to 20 in.. Combustion products entering the nozzle are compressed with maximum\ncompression occuring at about X = 14 in. where nozzle diameter is minimum. This is called the throat.\nAft of the throat, nozzle diameter increases. This causes combustion products to expand and increase\nin velocity, producing thrust. The magnitude component of flow velocity is in units of inchedsecond.\nLog10\nSpeed\n\nI\n\nI\n\nCavaties\n\nI\n\n25\n-10\n0\n\n10\n\n5\n\n15\n\nX\n\nFigure 8, Filled Contour Plot of Log Speed of Simulated Combustion Product Flow Inside Solid\nRocket Motor of Arbitrary Geometry and Fictitious Properties\n\n12\n\n..\n\n"1I\n\n7\n\nY\n\nI\n\nI\n\nI\n\nI\n\n0\n\n5\n\n10\n\nI\n\nI\n\nt\n\n15\n\nX\nFigure 9, Flow Image of Direction of Simulated Combustion Product Flow Inside Solid Rocket Motor\nof Arbitrary Geometry and Fictitious Properties Using GBYR Color Wheel\nInterpretation of Circular Dataimage\n\nIn the forward (left) end of the chamber, combustion products from the burning rocket motor\npropellant flow toward the center of the chamber. Going aft (to the right), the flow direction turns\ntoward motor axis with the volume of radial flow (toward the center of the chamber) decreases going\naft (see upper left view). The radial flow coming from the cavities near X=6 in. into the bore t r s\nun\ntoward the axial direction going aft.\nIn flow analysis, displays like figures 8-9 can be linked, or semi-transparent isoclines of constant\npressure or other variable can be overplotted on flow images of direction.\n\n13\n\nEXAMPLE - DATAIMAGE OF EARTH MAGNETIC FIELD\n\nS\n\na) View With Longitude x Latitude Areal Elements As Rectangles Of Constant Area\n90"E\n\n/ODE\n\n0" E\n\n90"E\nb) Perspective View from North Geographic\nPole Looking Toward Equator\n\nc) Perspective View from South Geographic\nPole Looking Toward Equator\n\nFigure 10, Earth International Geomagnetic Reference Field, 9/15/2004, Elevation 0 km,\nResultant Direction Displayed by a GYRI3 Color Wheel for\nNorth and East Vectors in Plane Tangent to Earth at (Longitude, Latitude),\n\n14\n\nFigures 10 a-c plot the direction of the component of earth\'s main magnetic field which drives a\ncompass using a GYRE3 (green=O", yellow=90\xc2\xb0, etc) color wheel. The dominant direction (north) has\ngreen and red color variations in shading around yellow. Yellow was chosen for north because it\nseems easier to see variations against yellow than a dark color, e.g. blue.\nThe geomagnetic field at any point on the Earth\'s surface is a combination of several magnetic fields\ngenerated by various sources. More than 90% of the field is generated in the Earth\'s outer core. This is\nreferred to as the main field. The main field was estimated for date 9/15/2004, elevation 0 k . and\nm,\nn\narea -180" E to +180" E by -90" N to +90\xc2\xb0 N i 1 degree x 1 degree areas using the web\nimplementation of the current International Geomagnetic Reference Field (IGRF) model (International\nAssociation of Geomagnetism and Aeronomy 8th Generation IGRF, 2004). Computed results include\nthe seven field parameters and the current rates of change: Declination (the angle between magnetic\nnorth and true north), positive east in degrees and minutes; Inclination (the angle between the local\nhorizontal plane and the total field vector), positive down in degrees and decimal minutes; Horizontal\nIntensity (H), in nanoTesla (nT); North Component of H, positive north in nT; East Component of H,\npositive east in nT; Vertical intensity, positive down in nT; and Total Field = sqrt(north2+ east2+\nvertical2)in nT. When used within a valid date range, estimates are generally accurate to within 30\nminutes of arc for declination and inclination, and 100-250 nT for the force vector components. This\nprecision is remarkable considering earth\'s total magnetic field intensity varies from about 23,000 to\n67,000 nT. Solar storms can cause significant short-term differences between the estimated and actual\nfield values.\nNGDC\nThe scientific domain of the National Oceanic & Atmospheric Administration (NOAA) spans the\ndistance &om the surface of the sun to the bottom of the sea. The strategic plan of the NOAA is "To\nunderstand and predict changes in the Earth\'s environment and conserve and manage coastal and\nmarine resources to meet the Nation\'s economic, social, and environmental needs." The National\nGeophysical Data Center (NGDC), is a part of N O M . The NGDC provides scientific stewardship,\nproducts and services for geophysical data describing the solid earth, marine, and solar-terrestrial\nenvironment, as well as earth observations from space The NGDC provides the interface to 8th\nGeneration IGRF.\nInterpretation\nIn figure loa, in the central region and going west to east, magnetic field direction varies &om northnortheast, rotates counterclockwise, has a narrow S-shaped band crossing North America and South\nAmerica in which the direction is nearly north (yellow), continues rotation CCW to north-northwest,\na\nand then reverses direction of rotation CW back to north. The rectangular representation in figure 1 O\ndistorts the shape of direction. Figures lob-c corrects this distortion by mapping the color of the\nmagnetic field direction onto a sphere. Starting at the center of Figure 10a and going outward, latitude\nincreases from -90" N to zero at the equator. Continuing, starting at the outside of figure 1Oc and\ngoing toward the center, latitude increases from 0" N to +go" N. The variation around the geographic\npoles shows why a compass is not reliable within about 10" and must be used with care in the adjacent\nregion.\nThe circular dataimage of magnetic fields direction provides a new way to compare internal structure\nof planets.\n15\n\n..\nEXAMPLE - DATAIMAGE OF CIRCULAR TIMES SERIES\nData used in figure 11 is Space Shuttle solid rocket motor nozzle vectoring direction angle (direction\nnozzle is pointing in plane perpendicular to its motor).\n\nIn figures 11a-b, time increases left-to-right. Each row of pixels represents a circular time series of\nnozzle direction angle vs. time. In each row, a pixel represents nozzle direction angle by color a a\nt\ncorresponding angle on the RGBY color wheel at the right of figure 11. Like the dataimage for linear\nvariables of motor trend cars, the observations and/or variables can be sorted. In figure 1la, the nozzle\ndirection data are ordered in the natural order in which the motors are produced. In figure 1l b ,the\ndata are first sorted bottom-to-top by side (left side then right side motor), then by inclination (angle of\nSpace Shuttle to plane through equator), and last by orbital altitude.\n\n0\n\n5\n\n10\n\n15\n\n20\n\nTime (sec)\n\na) Unsorted data\n\n25\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nTime (sec)\n\nb) Sorted data\n\nFigure 11, Space Shuttle Solid Rocket Motor Nozzle Vectoring Direction Angle vs. Time\nInterpretation\nThe broad horizontal bands in figure 11b bottom and top half indicate that the left side (bottom half)\nnozzle is mostly pointed at its 0 degree location, and the right side nozzle (top half) at 180 degree\nlocation. The blue vertical bands in figures 11 a-b at about time = 10 seconds is related to the roll\nmaneuver of the Space Shuttle, which occurs early in flight. The diagonal structures in figure 1lb\nindicate effects of Space Shuttle inclination and orbital altitude on nozzle direction angle.\n\nEXAMPLES - EXISTING METHODS OF DISPLAYING DIRECTIONAL DATA\n\nISOETES\n0\n\n270\n,\n\nM\'\n\n.,\n,\'\n\n,\n\n,;.\n\n.,;\n\n;\n\n,\n\n;e\n\n4\n.\n*\nI\n\n..,.\n\n-.\n\n\'\n\n\'18.\n\n\',\n\n\\\n\n.\n\n\\\n\n1%-\n\na) Stacked Circular Data Graph\n(Pisces Conservation Ltd ,Axis, 2004)\n\nb) Stacked Axial Data Graph\nSimulated Data Megaspore Element Orientation\n\nI\n\n2.6\n\n2\n.\n4\n\n22\n.\n\n2\n1\n)\n\n1\n4\n\n11\n\n1\n3\n1\n\n0.1\n\na\n4\nOA\n\n02\n.\n0\n\nc) Vector Plot on Elevation Contour of Mount St. Helens\n(Golden Software, Surfer 8,2004)\nFigure12, Examples of Graphics Generated by Commercial Software of Directional Data\n\nFigure 12b is a raw data plot for axial data showing orientation of elements of modem Isoetes\nmegaspore relative to a base line drawn perpendicular to the spore surface (Kovach, 1989).\nFigure 12c is an elevation contour of Mount St. Helens generated by Surfer 8 Golden Software (2004).\nOn a regular grid, vectors point in the direction of the steepest descent. The magnitude of the vector is\nthe rate of descent. Mount st. Helens, Southwestern Washington, erupted on May 18, 1980, killing 57\npeople and damaged life in an area of some 70 sq m .\ni\n\n17\n\nREFERENCES\nATK Thiokol Propulsion (2004). FEM Builder software, version 1.4.\nFisher, N. (1 993). Statistical analysis of circular data. Cambridge University Press, Cambridge.\nFluent (2004). software for flow analysis and visualization at http://uww.fluent.com/ (8/14/04).\n.\nFoley, J., Van Dam., A., Feiner, S ,Huges, J. (1992). Computer graphics :principles and practice.\nAddison-Wesley Pub.Co., Reading Mass.\nGolden Software (2004). Surfer 8. 2d vector plot of Mt. St. Helens reproduced with permission.\nwww. goldensoftware.com (7/22/04).\n. Velleman, P.(198 1. Building multiple regression models interactively. Biometrics,\n)\nHenderson, H ,\n37,39141 1.\nInternational Association of Geomagnetism and Aeronomy 8thGeneration IGRF (2004).\nt\nIGRF web site a\nhttp://www.n.gdc.noaa..gov/IAGA/vmod/\nFrequently Asked Questions about earth magnetic field at\nhtt~://www.nadc.noaa.gov/se,g/~eoma~Jfaq.geom.shtml\n(9/15/04).\nOn-line magnetic field calculator at\nhttp://www.nadc.noaa.g;ov/sedJaeomagljsp/IGRFGrid.isp\n(9/15/04).\nII Data Library (2004). Comprehensive Ocean-Atmosphere Data Set (COADS), Trimmed Monthly\nR\nSummaries. Tutorial at http://iridl.ldeo.columbia.edu/dochelp/Tutorial/ (9/12/04).\nData at http://indl.ldeo.columbia.edu/SOURCES/.COADS/.mean/ (9/12/04).\n.\nJammalamadaka, S, Sengupta, A. (2001). Topics in circular statistics. World Scientific, Singapore.\nKovach, W. (1989). Oriana 2 graphic of orientation of elements of modem isoetes megaspore\nreproduced with permission.\nKovach Computing (2004). &ana 2. htt~://~~~.kovcom~.co.uk/oriana/newver2.html(7/22/04)\nLund, U.(2001)-S version, Agostinelli, C. (2002)- R port. CircStats, an R contributor package at\nhttp ://www.cran.r-proiect .oral (8/1/04).\nMardia, K., Jupp, P. (2000). Statistics Of Directional Data. John Wiley & Sons, New York.\nMinnotte, M. (1998). 1998 Proceedings of the ASA Section on Statistical Graphics.\nMinnotte, M., West, R. (1999). The data image: A tool for exploring high dimensional data sets.\n\nhttp://math.usu.edu/-minnotte/researcrch/pubs.html(7/22/04).\nMorphet, W. (2004). Space Shuttle Solid Rocket Motor Nozzle Vectoring Direction Angle vs. Time,\nATK Thiokol Propulsion. Clearance for publication applied for.\n(8/1/04).\nNychka, D. (2004). Fields, an R contributor package at http://www.cran.r-proiect.or.4\nPisces Conservation Ltd (2004). Axis software. Graphic reproduced with permission.\nhttp://WWW.pisces-conservation.com/indexsoftaxis.html(7/22/04).\nR Development Core Team (2004). R A language and environment for statistical computing.\nOrganization is R Foundation for Statistical Computing, address Vienna, Austria.\nhttp://www.R-proieCt.org (7/22/04).\nScott, D., Hiirdle W., (1992). Multivariate density estimation, John Wiley, New York.\nWegman, E. (1990). Color histogram for linear variables.\nhm:/iwww.nalaxv. mnu.edu/stats/facultv/wernnan.html(7/22/04.\n\n18\n\n'