b'Weimin Zheng et al.: The Software Correlator of the Chinese VLBI Network, IVS 2010 General Meeting Proceedings,\np.157\xe2\x80\x93161\nhttp://ivscc.gsfc.nasa.gov/publications/gm2010/zheng.pdf\n\nThe Software Correlator of the Chinese VLBI Network\nWeimin Zheng, Ying Quan, Fengchun Shu, Zhong Chen, Shanshan Chen, Weihua Wang,\nGuangli Wang\nVLBI Department, Shanghai Astronomical Observatory, CAS, P.R.China\nContact author: Weimin Zheng,\n\ne-mail: zhwm@shao.ac.cn\n\nAbstract\nThe software correlator of the Chinese VLBI Network (CVN) has played an irreplaceable role\nin the CVN routine data processing, e.g., in the Chinese lunar exploration project. This correlator\nwill be upgraded to process geodetic and astronomical observation data. In the future, with several\nnew stations joining the network, CVN will carry out crustal movement observations, quick UT1\nmeasurements, astrophysical observations, and deep space exploration activities. For the geodetic or\nastronomical observations, we need a wide-band 10-station correlator. For spacecraft tracking, a realtime and highly reliable correlator is essential. To meet the scienti\xef\xac\x81c and navigation requirements\nof CVN, two parallel software correlators in the multiprocessor environments are under development.\nA high speed, 10-station prototype correlator using the mixed Pthreads and MPI (Massage Passing\nInterface) parallel algorithm on a computer cluster platform is being developed. Another real-time\nsoftware correlator for spacecraft tracking adopts the thread-parallel technology, and it runs on the SMP\n(Symmetric Multiple Processor) servers. Both correlators have the characteristic of \xef\xac\x82exible structure\nand scalability.\n\n1. Introduction\nAt present, the Chinese VLBI network (CVN) consists of four stations (Shanghai, Yunnan,\nUrumqi, and Beijing) and one data processing center at Shanghai Astronomical Observatory (Figure 1). CVN has successfully been used in the Chinese lunar exploration project (Chang\xe2\x80\x99E) to\ntrack the CE-1 lunar probe. It will join the subsequent Chinese lunar and Martian exploration\nprojects. Besides the deep space exploration activities, CVN will take more geodetic and astrophysical observations. For example, under the framework of the Chinese National Key Scienti\xef\xac\x81c\nInfrastructure Project \xe2\x80\x98Crustal Movement Observation Network of China\xe2\x80\x99 (CMONC), the CVN\nupgrade plan was approved in 2007. The purpose is to provide the primary \xef\xac\x81ducial points by\nperforming geodetic VLBI observations monthly using the CVN antennas. Another project for\nrapid UT1 measurement on the Shanghai\xe2\x80\x93Urumqi baseline was also approved last year. So far,\nthe CVN pulsar observation is also under way [1, 2, 3].\nThe CVN Data Center now contains a 4-station software correlator and a hardware correlator.\nThe software correlator has played an irreplaceable role in the CE-1 routine data processing.\nHowever, both correlators are speci\xef\xac\x81cally designed for the Chang\xe2\x80\x99E project and do not meet the\nscienti\xef\xac\x81c data processing demands. After the CE-1 mission, we started upgrading the software\ncorrelator. It gradually obtained the geodetic and astrophysical data processing abilities. It was\nalso used in all kinds of experiments, like the pulsar observations and the digital baseband converter\ntest experiments.\nIn the future, several new domestic antennas, including the new Shanghai 65-m antenna, will\njoin in the CVN observations. Considering the possibility of using some Russian and Japanese\n\nIVS 2010 General Meeting Proceedings\n\n157\n\nWeimin Zheng et al.:\n\nThe Software Correlator of the CVN\n\nantennas, we can expand CVN to a local area VLBI network. In this VLBI network, the total\nantenna number will increase to 8\xe2\x80\x9310, and the longest baseline will extend from 3000 km to 7000\nkm (Figure 2). The expanded CVN is a multi-purpose VLBI network for geodesy, astronomy, and\ndeep space explorations. It can be seen that a new CVN data processing center with a powerful\ncorrelator is badly needed. The software correlator is a good choice for such a medium-scale VLBI\ndata center.\n\nFigure 1. Current CVN stations and data center.\n\nFigure 2. Extended CVN station map.\n\nThe requirements on the CVN correlator for science and deep space navigation are di\xef\xac\x80erent\n(Table 1). In general, there may be 2\xe2\x80\x9310 stations in geodesy and astronomy observations. For\nexample, we plan to use the Shanghai\xe2\x80\x93Urumqi baseline to perform rapid UT1 measurements. But\nin astrophysical observations, 5\xe2\x80\x9310 stations are needed to achieve good UV coverage. For tracking\nthe \xef\xac\x81rst Chinese Martian deep space probe YH-1, we hope to organize 4\xe2\x80\x938 Chinese and Russian\nstations. Similarly, the data speed for geodesy and astrophysics is higher than 1 Gbps/station.\nBut for most deep space applications, the observation data speed is less than 128 Mbps/station.\nHowever, the data turnover time and reliability requirement of the navigation observation is much\nhigher than that of scienti\xef\xac\x81c observation. For deep space probe navigation, sometimes the total\ndata latency of the VLBI system should be less than 1 minute and the correlator must have\nreal time data processing ability. The special functions like the Di\xef\xac\x80erential of One-way Range\n(DOR) and rapid spacecraft fringe search are essential for some navigation missions. As far as the\ncorrelator output data format is concerned, the FITS-IDI and NGS format will be the standard\nformat for geodetic and astrophysical observations; while for navigation, the correlator will use the\nspecial CVN format.\nTo meet the di\xef\xac\x80erent requirements of CVN observations, we are developing two kinds of software\ncorrelators. One is for spacecraft navigation; it adopts the Pthreads parallelization method and\nuses the Symmetric Multi Processing (SMP) server as the computation platform. The other\ncorrelator is for geodesy and astrophysics applications; it adopts the Message Passing Interface\n(MPI) programming and uses the SMP cluster as the platform. Since the GPU (Graphic Processing\nUnit) is powerful for data-parallel processing, it can be used as a computation accelerator in both\nsoftware correlators.\n\n158\n\nIVS 2010 General Meeting Proceedings\n\nWeimin Zheng et al.:\n\nThe Software Correlator of the CVN\n\nTable 1. New CVN correlator requirements and realization.\n\nApplications\nStation\nProcessing speed/station\nData transport\nOutput format\nSpecial function\nParallel computing\nHardware Platform\n\nGeodesy/Astronomy\n2\xe2\x80\x9310\n>1 Gbps\nDisk VLBI, e-VLBI\nFITS-IDI, NGS\nnone\nMPI + Pthreads\nSMP server + GPU\n\nNavigation\n4\xe2\x80\x938\n16\xe2\x80\x93128 Mbps\nReal time VLBI, Disk VLBI\nCVN\nRapid fringe search, DOR\nPthreads\nSMP cluster + GPU\n\n2. SMP Software Correlator\nThe SMP software correlator consists of the correlation module, the data preprocessing module,\nthe satellite fringe search, and the PCAL abstraction module. It uses Pthreads to realize the\nparallel correlation on any SMP server with x86 family CPUs. It has special functions like the\nrapid spacecraft fringe search and delay model reconstruction and full Phase Calibration (PCAL)\nsignal detection. First designed for the Chang\xe2\x80\x99E project and as the main VLBI correlator in the\nCE-1 mission, the SMP software correlator played an irreplaceable role in the CE-1 data processing.\nIn the critical \xef\xac\x82ying mission, there were 36 observations (336.55 hours). All of them were processed\nby this software correlator. In the long-term in-orbit operation mission, there were in total 120\nobservations (607.39 hours), and 434.02 hours of them were processed by the software correlator.\nEspecially in the case of several real-time CE-1 maneuver tracking observations, only the software\ncorrelator produced the correct results [1].\nAfter the CE-1 mission, the performance improvement of this correlator is still being worked on.\nNow the SMP software correlator has been upgraded from 4-station to 10-station capability and\ncan output FITS-IDI or NGS format data, besides the CVN format data. Further, the correlator\ndata latency can be less than 1 minute now.\nTable 2. Speci\xef\xac\x81cations of SMP software correlator.\n\nArchitecture\nStation number\nIF number\nFrequency channel\nInput data format\nOutput data format\nSampling\nFringe search\nCorrelation speed/station\nData turnover\nPCAL detection\n\nIVS 2010 General Meeting Proceedings\n\nFX\n1\xe2\x80\x9310\n1\xe2\x80\x9316\n32\xe2\x80\x9365536/IF\nMark 5A, Mark 5B\nCVN\n1-bit, 2-bit\n2\xe2\x80\x934 stations\n128 Mbps, 4 stations, 2-bit\n< 1 minute\nYes\n\n159\n\nWeimin Zheng et al.:\n\nThe Software Correlator of the CVN\n\nUp to now, this correlator has been used in all kinds of experiments. We used the software\ncorrelator to get the preliminary image of pulsar B0329+54 last July (Figure 3). This is the \xef\xac\x81rst\nCVN VLBI image. From 2007 to 2009, CVN carried out several Mars Express (MEX) experiments.\nThe SMP software correlator processed all the observation data (Figure 4). For the eclipse of the\nSun on 22 July 2009, a China-Japan joint experiment was conducted to measure the Total Electron\nContent (TEC) by VLBI and GPS observations. In the CVN data center, it was still the software\ncorrelator that correlated the VLBI data. The result is under comparison with that of NICT\n[1, 2, 3].\n\nFigure 3. Preliminary image of PSR B0329+54.\n\nFigure 4. VLBI delay/rate of Mars Express.\n\n3. High Speed SMP Cluster Software Correlator\nAlthough the performance of an SMP server is becoming more powerful, the speed of the correlator on a single SMP server is still strongly restricted. To meet the wide bandwidth scienti\xef\xac\x81c VLBI\nobservations, the high speed software correlator can work on the fast High Performance Computing\n(HPC) cluster. As the hardware platforms of the high speed prototype software correlator, two\nsets of blade clusters have been installed at the CVN Data Center (Figure 5). One is a 6-node\ncluster with 48 CPU cores, and there is a 10 Gigabit Ethernet (10GE) connection between each\ncomputation node. Another one is a 16-node cluster with 128 CPU cores, using In\xef\xac\x81niBand (IB)\nfor data communication. A 10-station prototype software correlation is under development. We\nwill use the prototype correlator to compare the performance di\xef\xac\x80erence on the two blade clusters.\nFigure 6 shows the structure of the prototype highspeed software correlator. This correlator\nwill read the VEX \xef\xac\x81le and the SKD \xef\xac\x81le in the astrophysical or geodetic observation. The Pulsar\nbinning function will be added later. The output data format is the standard FITS-IDI or NGS.\nOn 6 January 2009, the prototype correlator conducted the \xef\xac\x81rst CVN 2-station high speed e-VLBI\n(256 Mbps/station) experiment on the baseline Shanghai\xe2\x80\x93Urumqi.\n\n160\n\nIVS 2010 General Meeting Proceedings\n\nWeimin Zheng et al.:\n\nThe Software Correlator of the CVN\n\nFigure 5. Blade cluster.\n\nFigure 6. Highspeed software correlator structure.\n\n4. Plans for 2010\nIn 2010, with the operation of the CMONC Project, a geodesy and astrophysics oriented\nsoftware will come into operation. We will also utilize the CVN for rapid dUT1 measurements and\nrapid e-VLBI imaging experiments. A Graphics Processing Unit (GPU) test bench will be used to\nstudy the software correlator of CPU + GPU structure.\n\n5. Acknowledgements\nThe authors gratefully appreciate the support of the National Natural Science Foundation of\nChina General Program (No.10878021), the state 863 High Tech R&D program (2008AA12A209),\nand the e-science application project of Chinese Academy of Sciences.\n\nReferences\n[1] Zheng Weimin, Luo Wuchao, CVN Software Correlator Development and Applications in Chinese\nLunar Exploration Mission, In: Measuring the future, Proceedings of the \xef\xac\x81fth IVS general meeting,\nNauka, 124-128, 2008.\n[2] Zheng Weimin, Shu Fengchun, Luo Wuchao, Yu Yun, Wang Weihua, Current status of Chinese VLBI\nnetwork software correlator, Proceedings of the 19th European VLBI for Geodesy and Astrometry\nWorking Meeting, 84-86, 2009.\n[3] Guo Li, Zheng Xingwu, Zhang Bo, Wang Weihua, Zheng Weimin, et al., New determination of the\nposition of the pulsar B0329+54 with Chinese VLBI network, Science in China Series G, accepted,\n2010.\n\nIVS 2010 General Meeting Proceedings\n\n161\n\n'