b'Undersampling Correction for Array Detector-Based\nSatellite Spectrometers\nKelly Chance, Thomas P. Kurosu, and Christopher E. Sioris\nHarvard-Smithsonian Center for Astrophysics, 60 Garden Street, Cambridge, MA 02138, USA\nArray detector-based instruments are now fundamental to measurements of ozone and\nother atmospheric trace gases from space in the ultraviolet, visible, and infrared. The\npresent generation of such instruments suffers, to a greater or lesser degree, from\nundersampling of the spectra, leading to difficulties in the analysis of atmospheric\nradiances. We provide extended analysis of the undersampling suffered by modem satellite\nspectrometers, which include GOME, SCIAMACHY, OMI, and OMPS. The analysis\nincludes basic undersampling, the effects of binning into separate detector pixels, and the\napplication of high-resolution Fraunhofer spectral data to correct for undersampling in\nmany useful cases.\n\n0 2004 Optical Society of America\n\nOCIS codes: 010.1280,120.4570, 280. I I20\n\n1. Introduction\nArray-based spectrometers used in atmospheric remote sensing can suffer substantially from\nspectral undersampling, with negative consequences to the quality of data retrieved from the\n\n1\n\nmeasurements. This was first obvious in measurements from the Global Ozone Monitoring\nExperiment (GOME),\xe2\x80\x99 where scientists fitting trace gases from GOME spectra found quite large\nsystematic fitting residuals, and large fitting errors, even after correcting for Doppler shifts\nbetween radiances and irradiances. Ref. 2 recognized that this was mainly due to spectral\nundersampling and presented a technique for correcting most (>90%)of the undersampling error\nin spectral regions whem atmospheric absorption effects are small. For GOME, this includes\n\nfitting regions used for nitrogen dioxide (NOz), bromine monoxide (BrO), chlorine dioxide\n\n(OCIO), and formaldehyde (HCHO). If used with caution, the technique can also be applied\nsuccessfully to 0 3 and S02. (Caution is required because the absorption optical depths for 0\n\n3\n\nare\n\nhigher than for the other trace species listed; correction assumes that, to first order, the radiance\nspectrum consists mostly of back scattered Fraunhofer structure. The SO2 absorption occurs in\nthe region where\n\n0 3\n\nalso absorbs strongly.) The technique consists of comparing fully-sampled\n\nand undersampled versions of a high resolution Fraunhofer reference spectrum:\n\nwith the\n\ndifference being the effect of undersampling. Ref. 4 suggested that the observed residuals are\ninduced by the resampling required to compare Earth radiance and solar irradiance spectra in the\nfitting, because they are measured with different Doppler shifts of the ERS-2 satellite with\nrespect to the sun. It is demonstrated here that this is not entirely the case: Wavelength shifts\nbetween GOME radiances and irrdances are larger than can be accounted for by Doppler shifts.\nRef 4 also presented a version of the technique of Ref. 2 implemented in the Scanning Imaging\nAbsorption Spectrometer for Atmospheric Chartography (SCIAMACHY) operational processor.\nThe technique is now also used for measurement of HCHO\xe2\x80\x99 and N02,6 and has been\nimplemented in the operational processor for measurements of BrO, OC10, and HCHO by the\nOzone Monitoring Instrument (OM).\xe2\x80\x99\n\n2\n\nThe present analysis improves on the previous understanding of correction for\nundersampling by fully considering the sampling theorem in conjunction with the instrument slit\nfunction. The analysis is applied to measurements by GOME and OMI, since they represent the\ntwo major instrument types: diode array detectors (GOME) and CCD detectors (OMI). The\ndevelopment applies as well to other instruments, including SCIAMACHY (diode array\ndetectors) and the Ozone Mapping and Profiler Suite (OMPS), part of the National Polar\nOrbiting Environmental Satellite System (NPOESS), which uses CCD detectors.\n\n2. Definitions and Assumptions\nThe spectrometers considered here use array detectors, which respond to the incoming light over\nfinite regions, with defined response profiles. We will use the term instrument line shape (ILS)\nfor the response of a spectrometer to a monochromatic source up to where it enters the array\ndetector, and the term instrument transfer function (ITF) for the ILS convolved with the detector\npixel response. The following properties are assumed to be valid over the region of the array\ndetector that is necessary to consider for ITFs and undersampling corrections at a given pixel, as\ndeveloped here.\n1. Linear response. Each pixel responds linearly to input light intensity.\n2. Equal pixel response. Pixels respond equally to photons of different wavelength. Pixels\n\nrespond (or can be calibrated to respond) equally in output signal for equal input light\nintensity.\n3. Linear dispersion. Pixel wavelengths are at equal increments.\n4. No endpoint issues. The region under consideration is sufficiently far from the array end\nfor wavelengths beyond the array wavelength range to contribute to the signal.\n\n3\n\n(Proximity to the array end would require re-calculation of the ILS from deconvolution of\nt h e ITF,as discussed below.)\n\n5. Caiibration light source issues. Instrument transfer functions (ITFs) are determined\nusing either:\n0\n\nLines with negligible spectral width or;\n\n0\n\nA tunable source with negligible spectral width and equal intensity as it is tuned\n\nT.\nover the I F\n6 . Slit width variation is negligible over the ITF centered at each particular wavelength.\nHigher-order corrections will likely be needed in the future to account for the breakdown of\nsome of these assumptions.\n\n3 Spectral Undersampling\n.\nConsider a wavelength range extending from Rmin to 2,\n\nthat is fully or partly sampled by an\n\narray of detectors, spaced at wavelength increment 81.Any continuous incoming signal spectrum\nextending over the wavelength range can be represented fully by expansion in spatial (k,\nwavelength) frequency in a Fourier series:\n\nand the spatial frequencies are:\n\n2nk\nM -\n\nWk =-\n\n4\n\nSuppose that the signal is band-limited, that is, limited in content of spatial frequency\ncomponents to a maximum spatial frequency orCrr.\nThen, by the sampling t h e ~ r e r n , the~\n~\xe2\x80\x99\ninformation content of the spectrum is fully known if the spectrum is sampled over the full range\nIrrrirl\n\nto 1,,,, to twice this maximum spatial frequency, 2ornnr Nyquist sampling frequency):\n(the\n\nIn this case, the signal expansion includes only the terms necessary to measure spatial\nfrequencies 5 CC),,,(,~:\nN\n\nS ( A ) = a,\n\n+ [ a, cos kt + bksin k t ] ,\nk=l\n\nAA\nN =26.\n*\n\nThe spectrum is completely determined by this expansion. Its values at points other than the\nsampled points can be determined using the fact that the value at each sampled point A,,\nrepresents the intensity c,, of a sampling function, sinc [27r (A,, - A ) / 611, centered at that point,*\nsinc[2 n ( 4 - A)/ SA] =\n\nsin[2n(An- A ) / S A ]\n[2n(A, -A)/ SA] \xe2\x80\x99\n\nplus the constant offset ao:\nN\n\nC,\n\n=S(A,,)--a, =C[a,coskt,+b,sinkt,],\n\nt, =\n\n27r. in -\n\nk=l\n\nA~\xe2\x80\x9d\n\n(7)\n\nAA\n\nThe sampling function is written here in this way to emphasize the pixel dependence and\norientation of the following discussion. The sampling function presented here is actually an\napproximation to a fuller and more complex\n\nbut the difference amounts to a completely\n\nnegligible correction except within several sample points of the Am;,, and A,,\n\nendpoints.\n\nIf the signa! is not band-limited to cornax\nbut is still sampled to only 2wm, spatial\nfrequencies greater than w-\n\nare aliused into the band 0 < w 5 cow, with signal information for\n\n5\n\no , < o 5 2wn, appearing at w\nn\n,\n,\n2w,-,\n\n- w,information for 20-\n\n< w 5 3w- appearing at o -\n\netc. (Ref. 9, pp. 16-18). It will be demonstrated later that information aliased from the\n\nspatial frequency band om < w 5 2\no\n,\n\nrepresents the most important sources of problems for\n\nGOME, and the main target of corrections. Problems from aliasing in the spectra become most\nevident when it becomes necessary to resample a spectrum in wavelength, for example when\ncomparing an atmospheric radiance spectrum with a solar irradiance spectrum to determine\natmospheric composition from molecular absorption lines, but the interference from aliasing is\npresent in any case when the spectrum is undersampled (i.e., the spectrum is not fully Nyquist\nsampled). For example, synthetic spectra calculated during the fitting process to determine\nabundances of atmospheric gases would not normally include aliasing, while the measured\nspectra would.\nA Nyquist-sampled spectrum S (A) is fully described by summing over the contributions\n\nfrom the m individual sample points:\nm\n\nS ( A ) = co + C c l s i n c [ 2 ~ (-~ , ) / ~ R ] .\nA\n1\n\n(8)\n\n4\n\nIt is now possible to investigate the case where the spectrum is not fully Nyquist sampled.\n\nConsider a spectrum input to the instrument S (A). If the spectrum is completely known a\ni\n,\npriori, it can be expanded as before in a Fourier series\n\nsUtp = a,+\n(A)\n\n-\n\n[ukcos kt +\n\n(9)\n\nsin LT].\n\nk=1\n\nS\n,\nw-,\n\ncan be separated into a Nyquist-sampled part, S\n,\nand an undersampled part, Sud:\nN\n\ns ~ ~ < A )+ C [ u kcos kt +bk sin kt],\n= uo\nk=l\n\n6\n\ncontaining only spatial frequencies I\n\nThe undersampled part of the spectrum is thus\n\nwhere rn runs over the sampled points.\n\n4. Slit Functions (Instrument Transfer Functions)\nAn ITF serves as a low-pass filter to limit the spatial frequency content of the spectrum. Ideally,\nan ITF would limit the spectral information to frequencies 5 omax. ITFs for satellite-based\nThe\nspectrometers are measured in one of three manners:\n1. By using a reference line lamp (often a PtNeCr lamp"). This method has the advantage\n\nthat lamp lines are much narrower than the ITF. The disadvantages are that lines are not\nalways completely separated, that spectral coverage may be inadequate in some regions,\nand that a set of points (one per detector pixel) is mapped out, rather than a continuous\nITF. This method was used for GOME and SCIAMACHY.\n\n2. By using a tunable source consisting of a broadband light source and a monochromator.\nThis method has the advantage of mapping out a continuous ITF, but the disadvantage of\nbeing a spectrally broader source than the PtNeCr line source. This method was used for\n\nOMI, where the full-width at half-maximum (FWHM) of the source was I 0.1 OM1\ndetector pixel (M. Dobber and R. Dirksen, private communication, 2003). The residual\neffects from finite source width could, in principle, be reduced using the deconvolution\ntechniques introduced below.\n\n7\n\n3. By fitting flight spectral irradiance data to a high-resolution solar reference spectrum:\nwhere the fitting includes wavelength adjustment and simultaneous fitting to a\n\n\'\n\nparameterized ITF.2.\'\n\nAn ITF, r (A), can be expanded to include Nyquist-sampled and undersampled portions, ignoring\n(for now) detector pixel binning:\n\nThe limits a and b are selected to include portions of the detector array where the slit function\ncontributes significantly. As examples, we show the Gaussian GOME ITF we normally use for\nwavelength calibration purposes. A more complex, compound hypergeometric, ITF was\ndetermined during the instrument characteri~ation.\'~\nWe find that the Gaussian spectrum\nprovides better wavelength calibration for GOME spectra, and is used routinely in our data\nanalyses. It also provides much better undersampling correction for GOME spectral fitting. We\nshow an OM1 ITF (M. Dobber and R. Dirksen, private communication, 2003) for this same\nwavelength region, and for the NO2 fitting region (405-465 nm; the ITF determined at 432 nm is\nused here). The OM1 ITFs are selected for CCD row 150, corresponding to a viewing azimuth\nangle of 29S0, about half way from the nadir view to the extremity of the OM1 swath. Addtional\ntypes of ITFs for OMI may be considered once there is flight data for comparison. For all ITFs\nshown in this section, the complication of binning over the detector pixel response function is not\nyet included. This will be discussed in a later section.\nFigure 1 shows the GOh4E Gaussian ITF, determined from ERS-2 orbit 81003031\n(October 3, 1998), used here as a test orbit for determination of undersampling correction,\nappropriate to the fitting window used for BrO retrieval in GOME.\' The FWHM of the lTF is\n\n0.160 nm, and there are 1.4 samples per FWHM in this region of GOME spectra. The ITF is\n\n8\n\nadditionally dccomposed into fully-sampled and undersampled components. Figure 2 shows this\nITF with the hypothetical sampling to twice the GOME sampling frequency. Figure 3 shows the\n\nOM1 ITF for this same wavelength region (FWHM = 0.421 nm, 2.8 samples per FWHM), and its\ndecomposition into fully-sampled and undersampled components. Figure 4 shows this ITF with\nthe hypothetical sampling to twice the OM1 sampling frequency. Figures 5 and 6 show the OM1\nITFs and decompositions for the NO2 fitting wavelength range (FWHM = 0.639 nm, 3.0 samples\nper FWHM). Note the asymmetry in the measured OM1 ITFs and their decompositions.\nIt is clcar from all three examples that higher sampling by a factor of 2 greatly decreases\n\nthe undersampled portion of the ITF, almost eliminating undersampling. Since for GOME this\ncorresponds to 2.8 samples per FWHM, this demonstrates that information aliased from the\nspatial frequency band\n\nOrnay\n\n< o 5 20,!,, represents the most important source of undersampling\n\nin this spectral region.\n\n5. Binning into Detector Pixels\nGOME and SCIAMACHY use Reticon-S RL-1024 SRU-type linear diode array detectors, which\nare designed to have the sensitivity profiles shown in Figure 7 for the spectral resolution and\nsampling of GOME. These detectors have 1024 photodiode elements spaced at 25 pm. The\ncenter 13 pm of each element is n-doped, with the bulk of the material p-doped, to generate the\nresponse profile shown (the newer Reticon-L detectors are also spaced at 25 pm, but with 19 pm\nn-doped regions and 6 pm interdiode gaps).\nCharacterization of the actual pixel responses must take into account the fact that the\ninput light source (mostly Fraunhofer spectrum, convolved with the ILS) varies significantly\nacross the detector pixel profile. The final response is the integral across the pixel profile of the\nconvolution of the input spectrum with the ILS:\n9\n\nwhere Rpir is the pixel response, S is the input spectrum, r is the ILS,\nand 43 denotes convolution.\n\nIn order to calculate the response, it is first necessary to obtain the I S by deconvolution, since\nL\nthe measured\n\nITF is the convolution of the ILS with the pixel response profile. This is\n\naccomplished using the Jansson method, as described in Ref. 14, for GOME, and a nonlinear\nleast squares fitting to a parameterized profile shape for OMI. The result for the GOME slit\nfunction is shown in Figure 8. The deconvolved slit is the best match to the ILS that could be\nobtained in the iterative deconvolution process. The difference between the initial and\nreconvolved slit is an indicator of the goodness-of-fit for this procedure. The response functions\n\nfor the O M CCD detectors are Gaussian with a full-width at half maximum of 25 pm and\nseparated by 22.5 pm (M. Dobber and R. Dirksen, private communication, 2003). Figures 9 and\n10 show these along with the decomposition to determine the ILS for the BrO and NO2 fitting\n\nregions of OMI.\n\n6. Undersampling Correction\n6.1 Wavelength calibration issues\nSatellite radiances and irradiances can be calibrated in wavelength with high absolute accuracy\n(typically 1o.OOO4 nm for the GOME BrO fitting region) using cross-correlation to the solar\nRef. 2 suggested that the apparent\nspectrum of Ref. 3, with simultaneous fitting of the lTF.27\xe2\x80\x992\nwavelength shift between GOME radiances and irradiances was due to instrumental effects,\ninfluencing the way the detectors are illuminated in the different measuring geometries. Ref. 4\nstated that it is due to the Doppler effect, since irradiances are obtained during the portion of the\n\n10\n\norbit when the satellite is moving toward the sun. For ERS-2 orbit 81003031, the maximum\nvelocity toward the sun is 7.46 km s-\', while the average wavelength shift (irradiance - radiance)\nfor the BrO fitting window is equivalent to 7.865k0.025 km s-\' (0.00923fo.00003 nm). The\nsatellite Doppler shift contributes 6.89 km s" (0.0081 nm), rather than the full 7.46 km s-\', given\nthe GOME solar measurement procedure.\' There is an additional component of 0.50 km s-\' at\nthis season from the ellipticity of the Earth\'s orbit, for a total Doppler shift of 7.39 km s-\',\n\nleaving a significant instrument and/or spectral component (see the discussion in Ref. 15 for\npossible spectral "tilt" contributions). For the other spectrometers considered here, the relative\ncontributions are not yet determined. For OM1 in particular, since its undersampling is calculated\nhere, a relative shift equal to the full Doppler shift is assumed; this will be modified when flight\ndata become available.\n\n6.2 Undersampling calculations\nCalculation of the undersampling correction for each case is accomplished by convolving the\nhigh spectral resolution (0.01 nm) solar reference spectrum of Ref. 3 with the ITF determined for\nthe instrument and wavelength region, and differencing fully-sampled and undersampled\n\nrepresentations of this convolved solar spectrum at the sampling grid of the satellite radiances:\n1. Convolve the high resolution solar reference spectrum\n\nEref\n\nwith the satellite instrument\n\nITF to create a lower spectral resolution, but highly oversampled, solar reference\nspectrum, Eover:\n\nprofile\n\nThe portion of Erefused in fitting BrO for GOME is shown in Figure 11, top panel; E,,,,\nfor this spectral region is shown in Figure 11, middle panel.\n\n11\n\n2. Determine from direct crosscorrelation (for GOME) or estimate (for OMI) the\nwavelength grids for irradiance and radiance spectra Rirr and grad.\n3. Sample E,>,, at the wavelength grid girr, to give\n\nEirr,\n\nand at the gnd\n\ngrad,\n\nto give\n\nErad,\n\nusing cubic spline interpolation\xe2\x80\x996to determine values at each exact grid point. These are\nnow undersampled representations of the solar reference spectrum, although each is\ncorrect ut the points on its sampling grid. Ei, is shown in Figure 1 1, bottom panel; Emd is\nvirtually indistinguishable when over-plotted.\n4. Resample Eirr to the wavelength grid grad, using cubic spline interpolation, giving E;vrod-\n\n5. The undersampling correction C, in optical thickness units, is the difference between\n,\nErad\n\nand Erd,normalized to the average of Erd over the fitting window:\n\nC,, corresponds to differencing fully-sampled and undersampled representations of the convolved\nsolar spectrum since only Eirr is resampled, thus inducing undersampling error on the radiance\nwavelength grid\n\ngrad.\n\nThis undersampling correction assumes that, to first order, the radiance\n\nspectrum consists mostly of back scattered Fraunhofer structure. Higher-order corrections could\nbe made to account for atmospheric absorption and the Ring effect. Figure 12 shows the\n\nresiduals from fitting for BrO (without the use of an undersampling spectrum as a basis function)\nin ERS-2 orbit 81003031 for a measurement pixel midway through the orbit (pixel 800) and as\nan orbit average (top panel); the bottom panel shows the undersampling Cucalculated here for\nthe average relative wavelength shift between irradiance and radiance fitted for this orbit (0.0092\nnm). The calculated undersampling correction accounts for more than 90% of the fitting\nresiduals. Figure 13, top panel, shows the undersampling calculated for the OMI baseline BrO\nfitting window, assuming a relative radiance-irradiance shift corresponding to the full Doppler\n12\n\nshift for the Aura orbit (7.5 km s-I).The bottom panel shows the absorption for a typical BrO\n\nslant column density of lx10t4 cm-2. The units (optical thickness and transmission) are\nequivalent in scale for these small interferences and absorptions. The undersampling correction\nis roughly an order of magnitude smaller than for GOME, but is still larger than the BrO\nabsorption and needs to be carefully included in the fitting of the satellite data. Figure 14, top\npanel, shows the undersampling calculated for the OM1 baseline NO2 fitting window, assuming a\nrelative radiance-irradiance shift corresponding to the full Doppler shift for the Aura orbit. The\nbottom panel shows the absorption for a typical NO2 North American summer slant column\ndensity of 1 . 2 5 ~ 1 0crn-*.The contribution is less severe but, at ca. 20% of the nominal NO2\n\'~\nsignal, it is still by no means negligible. Undersampling correction will very likely need to be\nincluded in order to derive meaningful tropospheric NO2 abundances from OM1 measurements.\nUnder heavily polluted conditions over North America in summertime, for example, the\ntropospheric contribution to the NO2 slant column usually does not exceed 40%.6Effective\nmonitoring of moderate pollution requires correction to substantially better than that level.\nAn attempt was made to improve the undersampling correction for GOME by calculation of\nthe undersampling spectrum for the deconvolved ILS, followed by convolution of the resulting\nspectrum with the Reticon response function. The result of this procedure was expected to be an\nimproved undersampling correction which would correspond even more closely to the GOME\nfitting residual, as shown in Figure 12, top panel. The actual result was substantially worse. The\nmagnitude was approximately correct, but the spectral details were not. We think that the reason\nis that the actual detector response function deviates considerably from the trapezoidal shape\nshown in Figure 7. For the present, at least, the best undersampling corrections continue to be\nthose determined using the entire ITF. These are shown in Figures 12, 13, and 14. When OM1\n\n13\n\nflight data become available, this procedure will be attempted to see whether it provides\nimproved undcrsampling correction for this case.\n\n7. Discussion and Conclusions\nWe provide a method that may be used to simply and reliably estimate the degree of\nundersampling an instrument configuration will have. For instruments where the ITF may be\napproximated as Gaussian (GOME), show that sampling at 2.8 pixels/FWHM will almost\nwe\ncompletely eliminate undersampling. For more complex ITFs (OMI), significant undersampling\ncan exist at 3.0 pixels/FWHM.\nUndersampling for ground-based, zenith-sky spectrometers has been discussed in Ref. 17\nin the context of measuring 0 3 , NO2, and NO3. On the basis of numerical experiments, it is\n\nrecommend to use sampling ratios between 4.5 and 6.5 pixels/FWHM, for Gaussian ITFs, to\navoid undersampling. This is consistent with our finding that for O M NO2 measurements\nundersampling will be significant, and will highly impact tropospheric NO2 measurements, at 3.0\npixels/FWHM, but that at 6.0 pixels/FWHM it becomes negligible. The improvement in\nundersampling of OMI over that of GOME is due to the higher sampling rates (2.8 and 3.0\nsamples per FWHM for the OMI W and visible examples versus 1.4 for the GOME W\nexample). Asymmetric ITFs such as those of OMI and perhaps other imaging spectrometers may\nrequire higher sampling ratios than symmetric ITFs.\nThe previously developed undersampling correction2" is now commonly used in GOME\nscientific analyses and has been implemented operationally for SCJAMACHY. It has been\ndemonstrated here that correction will be required for O M BrO and tropospheric NO2\nmeasurements, at least. Complete implementation will not be possible until the ITFs and\n\n14\n\nirradiance-radiance wavelength shifts are characterized in flight versus CCD row. A similar\nconclusion almost certainly applies to the OMPS instruments.\nFurther refinement of the undersampling correction for OMI, to include full averaging of\nthe solar spectrum over the ILS and convolution with the pixel response is currently in progress,\nto be ready for application to flight spectra. For GOME, this further refinement has been shown\nnot to be an improvement, likely due to incorrect characterization of the Reticon response\nfunction. Convolution with the ITF followed by the sampling procedure described above in\n\nUndersampling calculations provides very accurate correction.\nHigher order corrections for instrumental effects, such as uneven sampling in wavelength\nspace, and spectroscopic effects, such as atmospheric absorption and the Ring effect, may\neventually be developed if analysis of flight data indicates that they are warranted.\n\nAcknowledgements\nThis research was funded by the National Aeronautical and Space Administration and the\nSmithsonian Institution. We thank Marcel Dobber and Ruud Dirksen of the KNMI and Ruud\nHoogeveen of the SRON for help with information on GOME and OM1 detector responses and\n\nITF determinations. It is always a pleasure to acknowledge the European Space Agency and the\nGerman Aerospace Center for their ongoing cooperation in GOME and SCIAMACHY.\n\nReferences\n1. European Space Agency, \xe2\x80\x9cThe GOME Users Manual,\xe2\x80\x9d ed. F. Bednarz, European Space\nAgency Publication SP-1182, ESA Publications Division, ESTEC, Noordwijk, The\nNetherlands, ISBN-92-9092-327-x (1 995).\n\n15\n\n2. K. Chancc, Analysis of BrO measurements from the Global Ozone Monitoring Experiment.\nGeophys. Res. Lett. 25,3335-3338 (1998).\n3. K.V. Chance and R.J.D. S p ~ r rRing effect studies: Rayleigh scattering, including molecular\n,\nparameters for rotational Raman scattering, and the Fraunhofer spectrum, Appl. Opt. 36,\n\n5224-5230 (1997).\n4. S.Slijkhuis, A. von Bargen, W. Thomas, and K. Chance, Calculation of undersampling\n\ncorrection spectra for DOAS spectral fitting, Proc. ESAMS99 - European Symposium on\nAtmospheric Measurements from Space, 563-569 (1999).\n5. K. Chance, P.I. Palmer, R.J.D. Spurr, R.V. Martin, T.P. Kurosu, and D.J. Jacob, Satellite\n\nobservations of formaldehyde over North America from GOME, Geophys. Res. Lert. 27,\n\n346 1-3464 (2000).\n6. R.V. Martin, K. Chance, D.J. Jacob, T.P. Kurosu, R.J.D. Spurr, E. Bucsela, J.F. Gleason, P.I.\nPalmer, I. Bey, A.M. Fiore, Q.Li, and R.M. Yantosca, An improved retrieval of tropospheric\nnitrogen dioxide from GOME, J. Geophys. Res. 107,4437, doi: 10.1029/2OO1~~OO10127\n\n(2002).\n7. NASA, \xe2\x80\x9cOMI Algorithm Theoretical Basis Document Volume 4: Trace G s Algorithms,\xe2\x80\x9d ed.\na\n\nK. Chance (2002). Available at\nhttp://eospso.gsfc.nasa.gov/eos_homepage/for-scientists/atbd/\n\n8.\n\nS.Goldman, \xe2\x80\x9cInformation Theory,\xe2\x80\x9d Prentice-Hall, NY (1953).\n\n9. R.W.\nHamming, \xe2\x80\x9cDigital Filters,\xe2\x80\x9d Prentice-Hall,Englewood Cliffs, NJ, ISBN 0-13-212571-4\n(1977).\n\n10. J.C. Brasunas, Jr., \xe2\x80\x9cFar-Infrared Spectroscopy of Gaseous Nebulae,\xe2\x80\x9d Ph.D. Thesis,\nDepartment of Physics, Harvard University (1981).\n\n16\n\n11. J.E. Murrrry, \xe2\x80\x9cAtlas of the Spectrum of a PlatinumKhrorniurdNeon Hollow-Cathode\nReferencc Lamp in the Region 240-790 nm,\xe2\x80\x9d ESA Report (1994).\n12. C. Caspar and K. Chance, GOME wavelength calibration using solar and atmospheric\nspectra, Proc. 3rdERS Symposium on Space at the Service of our Environment, ed. T.-D.\nGuyenne and D. Danesy, European Space Agency publication SP-4 14, ISBN 92-9092-656-2\n(1997).\n13. R. Spun and W. Thomas, GOME software databases for level 1 to 2 processing, ER-TN-IFEGO-0018, Iss./Rev.3/A (2002). Available at\nh ttp://earth .esa.int/services/esa-doc/doc-gom. h tml\n\n14. W.E. Blass and G.W. Halsey, \xe2\x80\x9cDeconvolution of Absorption Spectra,\xe2\x80\x9d Academic Press, NY,\nISBN 0-12-104650-8 (1981).\n15. C.E. Sioris, C.S. Haley, C.A. McLinden, C. von Savigny, I.C. McDade, W.F.J. Evans, J.C.\nMcConnell, N.D. Lloyd, E.J. Llewellyn, D. Murtagh, U. Frisk, T.P. Kurosu, K.V. Chance, K.\nPfeilsticker, H. Bosch, and F. Weidner, Stratospheric profiles of nitrogen dioxide observed\nby Optical Spectrograph and Infrared Imager System on the Odin satellite, J. Geophys. Res.\n\n108, No. D7,4215, doi: 10.1029/2002JD002672 (2003).\n16. W.H. Press, P.B. Flannery, S.A. Teukolsky, and W.A. Vetterling, \xe2\x80\x9cNumerical Recipes,\xe2\x80\x9d\nCambridge University Press, ISBN 0-521-3081 1-9 (1986).\n17. H.K. Roscoe, D.J. Fish, and R.L. Jones, Interpolation errors in UV-visible spectroscopy for\nstratospheric sensing: Implications for sensitivity, spectral resolution, and spectral range,\nAppl. Opt. 35,427-432 (1996).\n\nFigure Captions\nFig. 1 GOME Gaussian instrument transfer function in the spectral region used for bromine\nmonoxide determinations, and its decomposition into Nyquist-sampled and undersampled\ncomponents.\nFig. 2 GOME Gaussian instrument transfer function and the Nyquist-sampled and undersampled\nportions for the hypothetical case where the slit function is sampled to twice the GOME\nspatial frequency.\nFig. 3 OM1 instrument transfer function for the BrO fitting region and the Nyquist-sampled and\nundersampled portions.\nFig. 4 OM1 instrument transfer function for the BrO fitting region and the Nyquist-sampled and\nundersampled portions for the hypothetical case where the slit function is sampled to twice\nthe OM1 spatial frequency.\nFig. 5 OMI instrument transfer function for the NO2 fitting region and the Nyquist-sampled and\nundersampled portions.\nFig. 6 OM1 instrument transfer function for the NO2 fitting region and the Nyquist-sampled and\nundersampled portions for the hypothetical case where the slit function is sampled to twice\nthe OM1 spatial frequency.\nFig. 7 Response of three Reticon-S detector pixels as a function of location in GOME detector\nchannel 2.\nFig. 8 Deconvolution of the GOME ITF fromthe pixel response function to determine the ILS in\nthe BrO fitting region.\nFig. 9 Deconvolution of the OMI I\'TF from the pixel response function to determine the ILS in\nthe BrO fitting region.\n\n18\n\nFig. 10 Deconvolution of the OM1 ITF from the pixel response function to determine the ILS in\nthe NO1 fitting region.\nFig. 11 The portion of the high resolution solar reference spectrum\nGOME (top);\n\nErej\n\nused in fitting BrO for\n\nconvolved with the COME ITF to create the lower spectral resolution, but\n\nhighly oversampled, solar reference spectrum, Eo,r (middle); E , , , , sampled at the wavelength\ngrid of the COME irradiance (&)\n\n(bottom).\n\nEirr\n\nand\n\nErod\n\n(not plotted here; see text) are\n\nundersampled representations of the solar reference spectrum.\nFig. 12 Residuals from fitting GOME spectra for BrO in ERS-2 orbit 81003031, for a single\nspectrum and as an average for all spectra in the orbit (top); Synthetic undersampling, C,,\ncalculated here for the relative wavelength shift between the COME irradiance and the\n\nGOME radiance (bottom).\nFig. 13 Synthetic OM1 undersampling, C, in the BrO fitting region, calculated here for a relative\n,\nwavelength shift of the irradiance and radiance corresponding to 7.5 km s-\' (top); absorption\nfor a typical BrO slant column density of lxlOI4cm-*(bottom).\nFig. 14 Synthetic OM1 undersampling, C, in the NO2 fitting region, calculated here for a relative\n,\nwavelength shift of the irradiance and radiance corresponding to 7.5 km s-\' (top); absorption\n\'~\nfor a typical NO2 slant column density of 1 . 2 5 ~ 1 0cm-2(bottom).\n\n.\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n-0.2\n\n-\n\nI\n\nI\n\nI\n\nI\n\nI\n\nI\n\nSlit function\nNyquist sampled portion\nUndersampled portion\n\n- e - .\n\n-\n\n-\n\n-\n\n.\n.\n\n-\n\n-\n\n-\n\n.\nI\n\nn\n\nn\n\nI\n\n20\n\nI\n\nn\n\nn\n\n1.0\n\n0.6\n\n0.4\n\nv)\n\nv)\n\n2\n\n1\n\nI\n\nI\n\nI\n\nI\n\n...-Slit function\n\n-Nyq uist-sa mpled portion\n\n-\n\nQ)\n\n0\nP\n\nI\n\n.\n-\n\n0.8\n\nE\n\n-\n\nI\n\nI\n\n-Unde rsam pled porton\n\nI\n\n3 50\n\n:\n\n351\n\nI\n\n3 52\n\nI\n\nI\n\nI\n\nI\n\n353\n\n354\n\n355\n\n3 56\n\nWavelength (nm)\n\n21\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n9\n\nNyqu ist-Sampled portion\nUndersampled portion\n\n9\n\n9\n\n.\n\n0.2\n\n9\n\n0.0\n\n9\n\nt\n351.0 351.5\n\n352.0 352.5\n\n3 3 0 353.5 3 4 0 354.5 355.0 355.5\n5.\n5.\n\nWavelength (nm)\n\n22\n\n1.o\n\n- - - Slit function\n.\nNyq uist-sa m pled portion\nUndersampled portion\n\n0.8\n0)\n\n0.6\n\nPL\n\n0.4\n\n0.2\n\nt\n\n0.0\n\n-0.2\n\n351.0 351.5 352.0 352.5 353.0 353.5 354.0 354.5 355.0\n\nWavelength (nm)\n\n23\n\n355.5\n\nI\n1.0\n0.8\n\nI\n\n-\n\n0.4\n\n0.2\n\nI\n\n1\n\n-\n\n-\n\ni\'i\n\n.\n\n-0.2 1\n430\n\n1\n\nNyquist-sampled portion\nUndersampled portion\n\n-\n\n0.0\n\nI\n\n- - . Slit function\n-\n\n-\n\n0.6\n\nI\n\nI\n\n431\n\nI\n\n432\n\nI\n\nI\n\nI\n\n433\n\n434\n\n435\n\nWavelength (nm)\n\n24\n\n436\n\nI\n\n1.0\n\n0.8\n\na\nE\n0\nP\n\n2\n\n0.6\n\nI\n\nI\n\n9\n\n-\n\nNyquist-sampled portion\nUnde rsa m pled portion\n\n-\n\n-\n\nu)\n\n0.4\n\n-0.2\n\n2\n\n-\n\nI\n\n-\n\n0.0\n\nI\n\n. - - . function\nSlit\n\n.\n\n0.2\n\nI\n\n-\n\nt\n\nI\n\nI\n\nI\n\n25\n\nI\n\nI\n\n1\n\ng\nr\n\n1.0\n\n-\n\n1\n\n-\n\n-\n\n1\n\n.\n\n1\n\n-\n\n1\n\n.\n\n#\n\n.\n\nDiode N\n\nN-1\n\n#\n\n.\n\n1\n\n.\n\n~\n\nN+l\n9\n\n0\nn\n\n-\n\n(R\n4)\n\nPL\n\n0.6\n\n0.0\n\n1.0\n\n.\n\n9\n\n1\n\n-\n\n0.4\n\n0.2\n\nI\n\n.\n\n1\n\n.\n\n1\n\nI\n\n.\n\n1\n\n.\n\n1\n\n.\n\nI\n\n1\n\n.\n\nI\n\n1\n\n.\n\nI\n\n#\n\nI\n\n-Deconvolved (ILS)\n\n-\n\n0.8\n\naa\n\ntn\n0.6\n9\n.\n\ntn\n\nd\n\n-\n\n0.0\n\n--\n\nReticon response\n- Reconvolved (ITF)\n\n9\n\n.\n9\n\n9\n\n.\n\n-\n\nI\n\nI\n\nI\n\nI\n\n26\n\n.\n\n9\n\nI\n\nI\n\n1.2\n\n1.0\n\nQ,\n\n0.8\n\nu)\n\n-\n\n1\n\n.\n\n1\n\n\'\n\n1\n\n-\n\n1\n\n.\n\n0.6\n\n2\n0.4\n\n0.2\n\n0.0\n\n-\n\n1\n\n.\n\n1\n\n.\n\n~\n\n.\n\n1\n\n\'\n\n-Deconvolved (ILS)\nInitial (ITF)\n\n-\n\n---\n\n1\nI\nI\n\nI\n\nCCD response\nReconvolved (ITF)\nI\n\n.\n. \'\'\'\n.\n.\'\n\nc\n0\n\n1\n\n-\n\nI\n\n\'\n\n.\n\n-\n\nI\n\n1\n\n.\n\n1\n\n.\n\n1\n\n.\n\n1\n\n.\n\n1\n\n.\n\n27\n\n1\n\n.\n\n1\n\n.\n\n1\n\n.\n\n1\n\n.\n\n1\n\n1.2\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n.\n-\n\n1\n\nw\n\nI\n\n1\n\nI\n\n-\n\nI\n\n-Deconvolved (ILS) .\n-initial (ITF)\n-I\n\n-\n\n-\n\n.\n.\n.\n\nCCD response\n-Reconvolved (ITF)\n-\n\nI\n\n-\n\n.\'\n\n*\n\n.\n.\n.\n.\n.\n\n\'\n\n.\n.\'\n\'\'\n\n.\n\n.\n\n-\n\n*\n\n*\n\n*\n*\n\n-\n\n\'\n\'\n\n.. \'\'\n~\n\n430\n\n431\n\n432\n\n433\n\n434\n\nWavelength (nm)\n\n28\n\n435\n\n436\n\n3~10\'~\n?\n\n\'E\n\nC\n9\n\nE\n\n2x10\'~\n\n0\nT\n\n\'v)\nv)\n\n1x10\'~\n\nC\n\n0\n0\n\nc\n,\n\nr\nn\n\n0\n\n\'\xe2\x82\xac\n\nC\n\nQ\n\nE\nc\n)\n\n2x10\'~\n\nT\n\nv)\nv)\n\n1x10"\n\nC\n\n0\n0\n\nc\n,\n\nc\n\nn\n\n0\n\n3x 1Oq4\n\nQ\n\nE\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n2x10\'~\n\n0\nv)\nI/)\n\n1x10\'~\n\nS\n0\n.\nw\n\n0\n\nr\nn\n\n0\n\n344\n\n346\n\n340\n\n350\n\n352\n\n354\n\n356\n\nWavelength (nm)\n\n29\n\n358\n\n360\n\n0.02\n\n1\n\n\'\n\n1\n\n\'\n\nl\n\n.\n\nl\n\n\'\n\n-Ground pixel 800\n\nl\n\n1\n\n0\n-0.02\n\n1\n\n344\n\n346\n\n.\n\n1\n\n346\n\n3S0\n\n348\n\n.\n\n1\n\n348\n\n.\n\n1\n\n350\n\n352\n\n.\n\n1\n\n352\n\n\'\n\nI\n\n344\n\n1\n\n.\n\n354\n\n.\n\n.\n\nI\n\n1\n\n.\n\n1\n\n1\n\n356\n\n.\n\nI\n\n356\n\n354\n\nWavelength (nm)\n\n30\n\n1\n\n.\n\nI\n\n3!i8\n\n.\n\n1\n\n358\n\nI\n\nJ\n\n360\n\n.\n\n1\n\n360\n\n0.002\n\n-\n\n0.001\n\n-\n\nu)\nu)\n\ng\n0\n\n5\n\n0.000\n\n.-\n\n-0.001\n\n*-\n\n3\nc\n,\n\nP\n\n0\n\n-0.002\n\nl\n\n~\n\nl\n\n-\n\n1.000\n\nu)\n\nE\nu)\n\n0.999\n\nE\n\n0.998\n\nE\n\nk\n\nl\n\n\'\n\nl\n\n\'\n\nl\n\n~\n\nl\n\n\'\n\n0.997\n\n-\n\n"\n346\n1\n\n348\n.\n\n1\n\n350\n\'\n\nI\n\n352\n\n354\n\nI\n\n\'\n\n\'\n\nI\n\n356\n\'\n\n358\n\nI\n\nI\n\nI\n\n360\n\n.\n\nI\n\n-\n\nBrO\n\nE\n\n.-\n\n\'\n\nI\n\nI\n\n0\n\ni\n\nU ndersam pling\n\n344\n\n\'5\n\n-\n\n-\n\nr\nI\n\nI\n\n*\n\nI\n\n.\n\n1\n\n.\n\n1\n\n31\n\n.\n\nI\n\n.\n\nI\n\nI\n\n.\n\nI\n\nl\n\n~\n\nl\n\n:\n\n0.003\n0.002\n\nQ)\n\n5\n\n5\n0\n\n3\n\n0.001\n\nO.Oo0\n4.001\n\n= -0.002\nn\n0\n\n0\n\n-0.003\n\nI\n\n:\n-\n\nI\n\nI\n\nI\n\nI\n\nI\n\nUndersampling\n\n-\n\n-\n\n-\n\n0.997 I\n\nI\n\nI\n\nI\n\nI\n\nI\n\nI\n\n1\n\nI\n\nI\n\nI\n\nI\n\nI\n\n0.995 - 0.994 g\n-\n\n-\n\n0.992 -\n\n-\n\n: 1\n0.991\nc\n\nI\n\n400\n\n1\n\n-\n\n0.993\n\n0.990\n\nd\n\na\n\n0.996\n\nE\nf\n\n-\n\n-\n\nL\n\nQb\n\n4\n-\n\nI\n\nI\n\nI\n\nI\n\nI\n\nI\n\nI\n\n410\n\n420\n\n430\n\n440\n\n450\n\n460\n\n470\n\nWavelength (nm)\n\n32\n\n'