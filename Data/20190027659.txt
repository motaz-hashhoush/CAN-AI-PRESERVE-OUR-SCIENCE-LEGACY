b'National Aeronautics and Space Administration\n\nAirspace Technology Demonstration 2 (ATD-2)\nATD-2 Fuser Database\n5/22/2019\n\nMay 22, 2019\n\nFuser Database\n\xe2\x80\xa2 Purpose\n\xe2\x80\xa2 Database Overview\n\xe2\x80\xa2 Database Details\n\xe2\x80\xa2 Use Cases\n\n5/22/2019\n\nPurpose of Databases?\nEnd Results\n\nUnderstanding\nthe Data\n\nTraceability / Debugging\nHow did our data processing\nhandle this case?\n5/22/2019\n\nWhat triggered this update\nin our system?\n3\n\nDatabase Overview\n\xe2\x80\xa2 Each ATD-2 system has a dedicated system that captures the data\nnecessary to meet objectives\n\xe2\x80\xa2 Each database contains tables with\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\nFlattened messages from external sources\nFlight matching data\nFuser mediated data\nData from ATD-2 internal components\n\n\xe2\x80\xa2 Database structure prefers wide tables that contain flattened data\n\xe2\x80\x93 Very few joins or tree traversals needed\n\nExternal\nExternal\nExternal\nSources\nSources\nData\nSources\n\nATD-2 Data Fusion\nGUFI Service\nFuser\n\nATD-2\nPredictive\nEngine\n\nClients\n\nDatabase\n5/22/2019\n\n4\n\nDatabase Tables\n\xe2\x80\xa2 ATD-2 Data Fusion Tables\n\xe2\x80\x93 Fuser flight tables\n\xe2\x80\x93 GUFI (Global Unique Flight Identifier) tables\n\n\xe2\x80\xa2 Source Data Tables\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\n5/22/2019\n\nTfmData flight tables\nTBFM table\nASDEX (STDDS SMES) table\nTfmData Terminal table\n\n5\n\nFuser Processed Database Tables\nTable\n\nContains\n\nmatm_flight_all\n\nA snapshot of the current flight state after every\nupdate\n\nmatm_flight\n\nJust the fields that changed as part of each flight\nupdate\n\nmatm_flight_summary\n\nA single record per flight with the current state of\nthe flight\n\n*_extension\n\nProcessed data updates that apply only to a\nspecific source\n\n5/22/2019\n\n6\n\nMatm_Flight vs Matm_Flight_All\nMATM_FLIGHT\nacid\n\ndeparture\nstand\nairline\n\ndeparture\nstand airline\ntime\n\nABC1234\n\nB1\n\ndeparture\nstand actual\ntime\n\nSystem id\n\nTimestamp\n\n2017-04-05\n11:00\n\nTFM_TFDM\n\nABC\n\n2017-04-05\n10:00\n\n2017-04-05\n11:15\n\nABC1234\n\nLast update\nsource\n\nTFM_TFDM\n\nABC\n\n2017-04-05\n10:30\n\nTFM_TFDM\n\nABC\n\n2017-04-05\n11:17\n\nLast update\nsource\n\nSystem id\n\nTimestamp\n\n2017-04-05\n11:17\n\nABC1234\n\nMATM_FLIGHT_ALL\nacid\n\ndeparture\nstand\nairline\n\ndeparture\nstand airline\ntime\n\nABC1234\n\nB1\n\n2017-04-05\n11:00\n\nTFM_TFDM\n\nABC\n\n2017-04-05\n10:00\n\nB1\n\n2017-04-05\n11:15\n\nTFM_TFDM\n\nABC\n\n2017-04-05\n10:30\n\nB1\n\n2017-04-05\n11:15\n\nTFM_TFDM\n\nABC\n\n2017-04-05\n11:17\n\nABC1234\n\nABC1234\n5/22/2019\n\ndeparture\nstand actual\ntime\n\n2017-04-05\n11:17\n\n7\n\nMatm_Flight_All vs Matm_Flight_Summary\nMATM_FLIGHT_ALL\nacid\n\ndeparture stand\nairline\n\ndeparture stand\nairline time\n\nABC1234\n\nB1\n\nABC1234\nABC1234\n\nLast update\nsource\n\nSystem id\n\n2017-04-05 11:00\n\nTFM_TFDM\n\nABC\n\nB1\n\n2017-04-05 11:15\n\nTFM_TFDM\n\nABC\n\n2017-04-05 10:30\n\nB1\n\n2017-04-05 11:15\n\nTFM_TFDM\n\nABC\n\n2017-04-05 11:17\n\nMATM_FLIGHT_SUMMARY\n\ndeparture stand\nactual time\n\n2017-04-05 11:17\n\n2017-04-05 10:00\n\n\xe2\x80\x93 at 10:00\n\nacid\n\ndeparture stand\nairline\n\ndeparture stand\nairline time\n\nABC1234\n\nB1\n\n2017-04-05 11:00\n\nMATM_FLIGHT_SUMMARY\n\nTimestamp\n\ndeparture stand\nactual time\n\nLast update\nsource\n\nSystem id\n\nTFM_TFDM\n\nABC\n\nLast update\nsource\n\nSystem id\n\nTimestamp\n\nTFM_TFDM\n\nABC\n\n2017-04-05 10:30\n\nTimestamp\n\n2017-04-05 10:00\n\n\xe2\x80\x93 at 10:30\n\nacid\n\ndeparture stand\nairline\n\ndeparture stand\nairline time\n\nABC1234\n\nB1\n\ndeparture stand\nactual time\n\n2017-04-05 11:15\n\nMATM_FLIGHT_SUMMARY \xe2\x80\x93 at 11:17\nacid\n\ndeparture stand\nairline\n\ndeparture stand\nairline time\n\ndeparture stand\nactual time\n\nLast update\nsource\n\nSystem id\n\nTimestamp\n\nABC1234\n\nB1\n\n2017-04-05 11:15\n\n2017-04-05 11:17\n\nTFM_TFDM\n\nABC\n\n2017-04-05 11:17\n\n5/22/2019\n\n8\n\nGufi Service (Flight Matching) Tables\nTable\n\nContains\n\ngufiflightmessage\n\nData on how each flight message from an\nexternal source was matched to a Fuser GUFI\n\ngufiflighthistory\n\nA snapshot of the current flight state in the GUFI\nflight matching service after every message\n\n5/22/2019\n\n9\n\nFuser Input Message Database Tables\nTable\n\nContains\n\nasdex_messages\n\nASDE-X track data\n\ntfm_*\n\nTFMS flight data \xe2\x80\x93 one table per message type\n\ntma_message\n\nNASA research TBFM and SWIM TBFM data\n\xe2\x80\xa2 See the source column. Contains either\n\xe2\x80\xa2 SWIM\n\xe2\x80\xa2 NASA-ZTL\n\xe2\x80\xa2 NASA-ZDC\n\ntfm_tfdm\n\nTfmData Terminal Flight Data\n\n5/22/2019\n\n10\n\nFuser Database \xe2\x80\x93 TFM Tables\nTFM Table\n\nMessage Triggered When\n\ntfm_arrival\n\nTFMS detects that a flight has landed\n\ntfm_boundary_crossing\n\nA flight crosses between ARTCCs\n\ntfm_departure\n\nTFMS detects that a flight takes off\n\ntfm_flight_control\n\nTFMS issues an EDCT for a flight\n\ntfm_flight_create\n\nAn airline submits a Flight Create message\n\ntfm_flight_modify\n\nAn airlines submits a Flight Modify message\n\ntfm_flight_plan\n\nA flight plan is filed\n\ntfm_flight_plan_amend\n\nA flight plan is amended\n\ntfm_flight_plan_cancel\n\nA flight plan is canceled\n\ntfm_flight_route\n\nA flight\xe2\x80\x99s route changes\n\ntfm_flight_schedule_activate TFMS activates a scheduled flight 24 hours in advance\ntfm_flight_times\n\nA flight\xe2\x80\x99s ETD or ETA changes due to events at the origin\n\ntfm_oceanic_report\n\nAn oceanic report is made\n\ntfm_track\n\nTFMS track data at 1 minute update rate\n\n5/22/2019\n\n5/16/2019\n11\n\nDatabase Loading on an ATD-2 System\n\n5/22/2019\n\n12\n\nDatabase Details\n\xe2\x80\xa2 PostgreSQL database\n\xe2\x80\xa2 All tables are partitioned based on timestamp\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\nImproves query performance\nAllows old data to be easily rolled off\nData is automatically rolled off daily\nData is stored long term in a warehouse\n\n\xe2\x80\xa2 Indexes on key data fields per table\n\n5/22/2019\n\n13\n\nData Archiving\n\xe2\x80\xa2 Operational systems store 5 day\xe2\x80\x99s worth of data\n\xe2\x80\xa2 Warehouses store archives of data long term for post-analysis\n\xe2\x80\x93 Data is archived nightly to allow post-analysis scripts to run overnight\nStats\n\nCLT Warehouse\n\nSize\n\n~910,000\n\n~1,285,000\n\n~15TB\n\nFlight Count\n\nD10 Warehouse\n~14TB\n\nCLT\n\nD10 Metroplex\n\nATD-2 System\n\nATD-2 System\n\nOperational DB\n\nOperational DB\n\nArchive\nBackups\n5/22/2019\n\nDatabase\nWarehouse\n14\n\nChanges to Database Schemas\n\xe2\x80\xa2 Problem\n\xe2\x80\x93 Need to store new data fields with each release\n\xe2\x80\x93 Cannot delete data on operational system and start clean when new release is deployed\n\xe2\x80\x93 The new data fields will not exist in warehouse archives\n\n\xe2\x80\xa2 Solution\n\xe2\x80\x93 LiquidBase for tracking DB schema changes between versions\n\xe2\x80\xa2 Schema changes are stored in XML\n\xe2\x80\xa2 When new version is deployed, DB schemas are automatically updated\n\xe2\x80\xa2 Archiving scripts read XML files and update warehouse prior to archiving new data\n<changeSet id="fuserDataCapture-v3.1.2-20180406-1" author="atd2" runAlways="true">\n<validCheckSum>ANY</validCheckSum>\n<preConditions onFail="MARK_RAN">\n<tableExists tableName="matm_flight_summary"/>\n<not>\n<columnExists tableName="matm_flight_summary" columnName="departure_aerodrome_faa_lid"/>\n<columnExists tableName="matm_flight_summary" columnName="arrival_aerodrome_faa_lid"/>\n</not>\n</preConditions>\n<addColumn tableName="matm_flight_summary">\n<column name="departure_aerodrome_faa_lid" type="varchar" />\n<column name="arrival_aerodrome_faa_lid" type="varchar" />\n</addColumn>\n</changeSet>\n5/22/2019\n\n15\n\nUse Case: Understanding the Data\nCancellations\n\xe2\x80\xa2 Question:\n\xe2\x80\x93 ATD-2 needed to cancel flights based on TfmData\n\xe2\x80\x93 TfmData has multiple triggers for cancellation\n\xe2\x80\x93 Which triggers should ATD-2 use?\n\n\xe2\x80\xa2 Approach\n\xe2\x80\x93 Use TfmData tables to determine the percentage of flights with a cancellation\nmessage and later had track data\n\n\xe2\x80\xa2 tfm_flight_plan_cancel table\nacid\n\ndeparture_ arrival_\nairport\nairport\n\nflight_ref\n\ntrigger\n\nsource_timestamp\n\n\xe2\x80\xa6\n\nEDV5575\n\nKDSM\n\nKLGA\n\n100000348\n\nFD_FLIGHT_CANCEL_MSG\n\n5/1/2019 9:12\n\n\xe2\x80\xa6\n\nUAL1965\n\nKTPA\n\nKEWR\n\n99911618\n\nHCS_CANCELLATION_MSG\n\n5/1/2019 9:15\n\n\xe2\x80\xa6\n\nDAL146\n\nSCEL\n\nKATL\n\n99972860\n\nHCS_CANCELLATION_MSG\n\n5/1/2019 9:16\n\n\xe2\x80\xa6\n\n5/22/2019\n\n16\n\nUse Case: Understanding the Data\nCancellations\n\xe2\x80\xa2 Results (2019-05-01 08:00Z to 2019-05-14 08:00Z)\nTrigger\n\nTotal Count\n\nTrack Count\n\nPercent\n\nUPDATE_INTERNATIONAL_CANCEL_TIMEOUT\n\n79683\n\n0\n\n0.0%\n\nUPDATE_CANCEL_TIMEOUT\n\n27674\n\n7128\n\n25.8%\n\nHCS_CANCELLATION_MSG\n\n27098\n\n15555\n\n57.4%\n\nFD_FLIGHT_CANCEL_MSG\n\n11912\n\n1009\n\n8.5%\n\nCANCEL_CMD\n\n5962\n\n75\n\n1.3%\n\nTMI_UPDATE\n\n1293\n\n178\n\n13.8%\n\n190\n\n113\n\n59.5%\n\nIADE_CANCELLATION_MSG\n\n\xe2\x80\xa2 ATD-2 currently only uses FD_FLIGHT_CANCEL_MSG to mark flights as\ncancelled\n\xe2\x80\x93 HCS_CANCELLATION_MSG are used to track the cancellation of flight plans\nassociated with a flight, but not to cancel the entire flight\n\xe2\x80\x93 ATD-2 has logic similar to TFMS timeout logic and so does not use timeout\ncancellations\n5/22/2019\n\n17\n\nUse Case: Traceability / Debugging\nFlight Matching Issues\n\xe2\x80\xa2 Question:\n\xe2\x80\x93 Prior to going live at CLT, there was a large push to resolve flight matching\nissues\n\xe2\x80\x93 Testers reported an issue where two aircraft icons were observed for a single\narrival\n\xe2\x80\x93 What happened?\n\n\xe2\x80\xa2 Approach\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\xe2\x80\x93\n\n5/22/2019\n\nPull the data on the flight and all related flights from the GUFI tables\nFind when the first mismatch happened\nCreate a file with the GUFI corrected for every entry\nRun file through unit test tool to identify problem\n\n18\n\nUse Case: Traceability / Debugging\nFlight Matching Issues\n\xe2\x80\xa2 Use Excel mapping tool to quickly\nidentify that ASDE-X data for arrival\nflight incorrectly matched to departure\nflight with the same callsign\n\xe2\x80\x93 JIA5485 from GSO to CLT\n\xe2\x80\x93 JIA5485 from CLT to TYS\n\n\xe2\x80\xa2 Determined root cause was that ATD2 had received incorrect gate IN time\nmessage\n\xe2\x80\x93 Matching service marked flight as\nhaving arrived\n\xe2\x80\x93 ASDE-X matching logic would not\nmatch to a flight that had already\narrived at the gate\n\n\xe2\x80\xa2 Updated logic to better handle case\nwith incorrect gate IN time message\n5/22/2019\n\n19\n\nFuse\nMatch\nArchive\n\nParse\n\nConsumer\n\n5/22/2019\n\n20\n\nPlanned Roadmap\n\nAnalysis\nFuse &\nStore\n\nMediate\n\nParse\nConsume\n\n5/22/2019\n\n21\n\nActual Roadmap\n\nParse\n\nAnalysis\n\nStore\n\nFuse &\nMediate\n\n5/22/2019\n\n22\n\nQuestions\n\n5/22/2019\n\n23\n\n'