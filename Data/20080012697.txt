b'ORBIT DETERMINATION SYSTEM FOR LOW EARTH ORBIT\nSATELLITES\nYossi Elishaa, Maxim Hankinb, Haim Shyldkrota\na\n\nIsrael Aerospace Industries, MBT space, Israel\nb\nIsrael Aerospace Industries, MLM, Israel\n\nAbstract\nThe IAI/MBT Precise Orbit Determination system for Low Earth Orbit satellites is\npresented. The system is based on GPS pesudorange and carrier phase measurements\nand implements the Reduced Dynamics method. The GPS measurements model, the\ndynamic model, and the least squares orbit determination are discussed. Results are\nshown for data from the CHAMP satellite and for simulated data from the ROKAR\nGPS receiver. In both cases the one sigma 3D position and velocity accuracy is about\n0.2 m and 0.5 mm/sec respectively.\nIntroduction\nSatellite tracking and orbit determination are essential elements of most satellite\nmissions. Knowledge of the spacecraft position at any time is a requirement for\ncommunication, mission planning and for geolocation purposes.\nSeveral Orbit Determination systems for Low Earth Orbit satellites have been\nimplemented in IAI/MBT. Both, on-board and ground station systems are used. The\non-board system is based on the ROKAR GPS receiver. The ground segment orbit\ndetermination is based mostly on GPS samples, with a backup mode, which uses the\ntracking antenna measurements in case GPS signals are not available.\nThe GPS code or GRAPHIC (code + phase) measurements form the basis for several\ntypes of integrated solutions for satellite orbit determination, using either dynamic or\nkinematic models (or a combination of the two). The existence of independent\nundetermined parameters requires an overall solution using batch post-processing or\nreal-time processing techniques. The batch solutions use least-squares methods, while\nthe real-time solutions apply Kalman filters.\nThe dynamic approach is to use force and satellite models in order to compute the\nsatellite\xe2\x80\x99s acceleration. The satellite\xe2\x80\x99s position as a function of time is then computed by\nnumerical integration. This result is compared with the orbit predicted by the GPS\nmeasurements. In the batch least-squares solution, the independent force parameters are\nchosen so as to minimize the differences between the predicted trajectory and the actual\nmeasurements. In Yunck\xe2\x80\x99s \xe2\x80\x9cKinematic Orbit Determination\xe2\x80\x9d [1], a Kalman filter is used\nto apply geometric corrections to the dynamic trajectory as a result of the GPS\nmeasurements. In Yunck\xe2\x80\x99s \xe2\x80\x9cReduced Dynamic Orbit Determination\xe2\x80\x9d [1], these\ncorrections are both geometric and dynamic in nature.\n\nMontenbruck has proposed a \xe2\x80\x9cKinematic\xe2\x80\x9d solution [2], which uses no dynamic model at\nall (as opposed to Yunck\xe2\x80\x99s kinematic solution). It merely computes a least squares\nsolution for all the locations and the biases relative to the GPS predictions. High\naccuracy solutions are obtained, however, kinematic methods are vulnerable and\nsensitive to bad measurements or bad geometry.\nMontenbruck et al. have proposed a \xe2\x80\x9cReduced Dynamic\xe2\x80\x9d solution [3], which involves\nestimation of empirical accelerations on top of a precise deterministic force model. It is\ncomposed of the dynamic models and the purely kinematic solution and combines the\nbest of both worlds. Not only the accuracy of GPS measurements may be fully\nexploited but it also has a high robustness offered by dynamical orbit determination\ntechniques.\nIn this paper we describe the Precise Orbit Determination system for Low Earth Orbit\nSatellites that has been implemented in IAI/MBT for future missions. The concept is\nbased on the Reduced Dynamics approach. In the following, we discuss the GPS\nmeasurements model, the dynamic model, and the least squares orbit determination. We\nshow results for data from the CHAMP satellite and for simulated data from the\nROKAR GPS receiver.\nPrecise Orbit Determination\nROKAR GPS receiver\nThe real-time navigation position and velocity accuracy provided by the ROKAR GPS\nreceiver is about 5-10 meters and 2-3 cm/sec respectively. Since this accuracy may be\ninadequate for geolocation implementations and for on-board orbit prediction, a real\ntime orbital filter is implemented in the receiver. The orbital filter implements an\nExtended Kalman Filter (EKF) algorithm, which generates the refined estimates on the\nbasis of the 3D fixed PVT solution supplied by the GPS receiver and the orbit dynamic\nequations. The orbital filter reduces the velocity error to 1 cm/sec and in the absence of\nsufficient visibility conditions (e.g. when the antenna is obscured) the GPS receiver\nuses the orbital filter to generate the extrapolation estimate of the orbit for aided\nnavigation (i.e. faster reacquisition).\nThe ROKAR GPS receiver provides L1 C/A code and carrier phase tracking on 12\nchannels with accuracies of 0.8 meters and 1 mm respectively. The code measurement\nis composed of the true distance between a GPS satellite and the receiver antenna, clock\noffsets of both, the receiver and the GPS satellites, the ionospheric path delay, and the\nreceiver noise of 0.8 meters. The carrier-phase measurements have much lower noise of\n1 mm, but contain an unknown bias, which must be estimated as part of the orbit\ndetermination process. This bias is different for each observed GPS Satellite but\nconstant between epochs during uninterrupted carrier-phase tracking. These\nmeasurements are downlinked and processed offline by Least Squares Fit (LSF) for\nprecise orbit determination.\n\nGPS data and GRAPHIC method\nThe main error sources of space navigation based on a single frequency GPS receiver\nare: ionospheric range delay, inaccurate GPS ephemeris and clock data, and receiver\nnoise.\nThe ionospheric range delay is the most significant error source even when a\nionospheric model is used in the post processing of GPS data. Therefore an alternative\napproach must be implemented to reduce this error source. As a result of the\nionospheric layer characteristic, its effect on the carrier-phase measurements and on the\ncode measurements is equal in magnitude but opposite in sign. By using the arithmetic\nmean of code and carrier measurements, the ionospheric path delays can be fully\neliminated. This measurement called GRAPHIC (Group And Phase Ionospheric\nCalibration) [1], exhibits a noise level of about half the pseudorange code noise, i.e., 0.4\nm for the ROKAR GPS receiver.\nInaccuracy in the GPS satellites orbit is the second error source that has to be handled.\nFor post processing GPS navigation implementations, the GPS satellites ephemerides\nare known with high precision and are used for precise orbit determination. The Center\nfor Orbit Determination in Europe (CODE) provides special GPS ephemeris products\n[4]. The GPS orbit data is available in the standard SP3 format on a 15 min grid with\ntypical position error of 5 cm. By using 9th order Lagrange interpolation, intermediate\npositions of similar accuracy can be calculated.\nThe Center for Orbit Determination in Europe (CODE) also provides high rate (30 sec)\nGPS satellites clock drifts in a standard CLK file [4]. By using such a high rate clock\nproduct the range modeling error is less then 1 cm.\nUpdated differential code biases for the GPS satellites (DCB file) and the relative\nposition of the GPS satellites antenna from the center of mass (Antex file) are also used.\nDynamical model\nThe additional use of orbit knowledge from the equations of motion may substantially\nimprove the orbit determination accuracy. By using the fundamentals of Newtonian\nmechanics, given an initial position and velocity vector, the satellite\xe2\x80\x99s orbit can be\ncomputed at arbitrary times by performing a double integration of the satellite\naccelerations over time. This computation is called orbit propagation and is composed\nof two main procedures that work consecutively.\nThe first one, the acceleration model, calculates the satellite instantaneous acceleration\nas a function of time, position, and velocity. The acceleration model has to describe the\nforces that act on the satellite faithfully because it affects significantly the prediction\naccuracy. The force model has to include the main forces that act on LEO satellites:\nearth gravity, atmospheric drag, and luni-solar gravity. Smaller forces like dynamic\nsolid tide, solar radiation pressure, and albedo can be considered, however, their\ncontribution is negligible and in many cases the inaccuracy in the main forces models is\nbigger than all these small forces together. The acceleration model in this work includes\nEGM96 of degree and order 70 as the Earth gravity model [5], CIRA72 as the\natmospheric density model [6], Moon and Sun gravity with low precision Solar and\n\nLunar coordinates [7]. The dependence of the cross section area on satellite attitude is\ntaken into account in the drag model.\nThe other procedure is the numerical integration of the instantaneous acceleration for\nthe solution of the equation of motion. The differential equation can be handled by\ncommon integration methods but second sum methods are the most suitable for orbit\ncalculation. Therefore, Gauss-Jackson [8, 9] of order 5 with step size of 30 seconds is\nused in this work. There is no need to use a more accurate method because the\ninaccuracies, which result from the acceleration model, are much bigger than those\nfrom the numerical integrator.\nOrbit propagation of 10 hours for a LEO satellite at altitude of 400 Km above earth\nproduces an error of 0.5 \xe2\x80\x93 1 Km mainly due to inaccuracies in the force model. In order\nto reduce this error and to get a more reliable orbit, some parameters that characterize\nthe forces at work might be determined as part of the estimation process. For example, a\ndrag coefficient, CD, and a solar radiation pressure coefficient, CR, act as adjustable\nscaling factors in many orbit determination systems [1, 7]. However, even when these\ntwo empirical constants are estimated properly and the measurements have a very small\nerror, there are errors of 2 - 5 meters in the estimated orbit.\nIn order to account for these deficiencies in the dynamic model, more degrees of\nfreedom have to be enabled. Piecewise constant synthetic accelerations in the radial,\ntangential, and normal directions are estimated as part of the orbit determination process\nto compensate for faults in the acceleration model [3].\nThe interval size for the synthetic accelerations has to be chosen wisely: on one hand\nshort intervals increases the number of degrees of freedom and overweigh the GPS\nmeasurements, on the other hand, long intervals may not compensate sufficiently for the\nlacks in the acceleration model. Intervals of 5 \xe2\x80\x93 15 minutes duration have been found to\nbe suitable, and were implemented in the MBT ground orbit determination system.\nLeast squares orbit determination\nThe notion of least squares estimation in the context of orbit determination is to find a\nset of model parameters for which the square of the difference between the modeled\nobservations and the actual measurements becomes minimal. Using these parameters\none can derive the position and velocity of the spacecraft at any instant within the time\ninterval of the measurements and for some time into the future.\nThe unknown variables that are estimated during the orbit determination process are:\nInitial satellite position and velocity\nThe amplitude of the empirical accelerations\nReceiver clock offsets at each measurement epoch\nCarrier-phase bias for each arc of continuous tracking of a single GPS satellite\nThe practical solution of the least squares orbit determination problem is complicated\nby the fact that the observation model is a highly non-linear function of the unknown\nvariables, which makes it difficult or impossible to locate the minimum of the loss\nfunction without additional information. Therefore, calculating a priori values for the\nunknown variables and estimating only small corrections to these initial values,\nsimplifies the least squares problem considerably. As this is a nonlinear problem, we\n\nreformulate it as one of computing a linear correction to the initial guess. Strictly\nspeaking, this is still not a linear problem, but if the nominal trajectory is sufficiently\nclose to the true trajectory, it will be in the \xe2\x80\x9clinear regime\xe2\x80\x9d, where a linear correction is\nadequate. Yet, some iterations are required to cope with the non-linearity of the orbit\ndetermination problem.\nEstimation of the drag coefficient, CD, in addition to the empirical accelerations is\nproblematic due to the coupling between them. The estimated value of CD is highly\ndependent on its weight relative to the weight of the empirical accelerations in the\nestimator. Without strict calibration, the obtained CD value is unreliable and\nmeaningless. In order to avoid this problem, first, the orbit is estimated using synthetic\naccelerations with a constant CD coefficient. Later on, the drag coefficient is estimated\nfrom the accurate orbit without estimating synthetic accelerations. When this approach\nis used, an accurate trajectory of 0.2 meters and 0.5 mm/sec, and a precise drag\ncoefficient are obtained because the empirical accelerations and the atmospheric drag\nare now decoupled.\nResults\nThe validation of the ground orbit determination was performed in two stages. The first\nstage in the process was based on data from the CHAMP satellite [10]. The orbit of the\nCHAMP satellite is known to a very high precision due to a high quality dual frequency\nGPS Receiver located on the satellite and advanced orbit determination techniques.\nHowever, only single frequency data was used in the IAI/MBT orbit determination. In\nthe second stage of tests data was generated in a simulation setup which included a\nSpirent hardware in the loop GPS simulator that transmitted RF signals to the ROKAR\nGPS receiver.\nIn the CHAMP based validation tests 48 orbital data arcs of GPS measurements in 2004\nhave been processed and analyzed. Each orbital data arc contains 10 hours of data.\nInputs of the Precise Orbit Determination system were: Rinex file (L1 frequency GPS\nmeasurements every 30 seconds), precise GPS ephemeredes, and high rate (30 sec) GPS\nsatellite clock data. Input data was obtained from CODE, The Center for Orbit\nDetermination in Europe.\nThe Champ orbit was estimated from the GPS data in three cases:\nOptimal - using all the available measurements\nRealistic - GPS antenna is considered to be obscured due to the satellite cruise\nlaw and only 75% of the available GPS measurements are used\nNear real-time - doesn\xe2\x80\x99t incorporate clocks data (corresponds to 3 hours delay\ninstead of 17 hours in the optimal case)\nIn the optimal case, a typical position accuracy of less than 20 cm 1-sigma has been\nachieved. Due to the robustness of the algorithm, the results of the realistic case were\nonly slightly worse - 25 cm 1-sigma. In the near real time case a better then 40 cm,\n1-sigma accuracy was achieved. In all cases the velocity accuracy was less than 0.5\nmm/sec.\n\nThe results are summarized in the following graphs:\n\nIn the second validation phase, simulated scenarios of satellite orbit and attitude, and\nextreme ionospheric conditions were generated in the GPS simulator The simulated\norbit was circular with inclination of 40 degrees and with altitude of 470 Km above\nearth. The satellite cruise law was implemented so that the GPS antenna received only\npart of the GPS signals according to its attitude. The simulator generated the GPS RF\nsignals according to the scenario and transmitted them to the antenna of the receiver.\nThe receiver measured and processed these signals and the collected data was used later\non as input to the orbit determination system. The results are summarized in the\nfollowing graphs:\n\nSummary\nThe IAI/MBT Precise Orbit Determination system for Low Earth Orbit satellites has\nbeen presented. The performance was demonstrated on single frequency data of the\nCHAMP satellite and on simulated data from the ROKAR GPS receiver. The\ncombination of GRAPHIC measurements with the dynamic model and GPS ephemeris\nand clock data has been shown to improve the precision of the position and velocity\nknowledge up to a 3D accuracy of 0.2 meters and 0.5 mm/sec respectively, which are\nappropriate for most satellite applications.\nReferences\n[1] T.P. Yunck, \xe2\x80\x9cOrbit Determination\xe2\x80\x9d, in B.W. Parkinson and J.J. Spilker Jr. (eds.),\nGlobal Positioning System: Theory and Applications, Vol. II, Ch. 21 (AIAA,\nWashington, D.C., 1996).\n[2] O. Montenbruck, \xe2\x80\x9cKinematic GPS Positioning of LEO Satellites Using IonosphereFree Single Frequency Measurements\xe2\x80\x9d, Aerospace Science and Technology 7, 396\n(2003).\n[3] O. Montenbruck, T. van Helleputte, R. Kroes and E. Gill, \xe2\x80\x9cReduced Dynamic Orbit\nDetermination Using GPS Code and Carrier Measurements\xe2\x80\x9d, Aerospace Science and\nTechnology 9/3, 261-271 (2005).\n[4] ftp://ftp.unibe.ch/aiub/, AIUB, CODE ephemeredes and clock solutions, last\naccessed August 2007.\n[5] Lemoine F. G. et al \xe2\x80\x9cThe development of the Joint NASA GSFC and MINA\nGeopotential Model EGM: NASA/GSFC, NASA/TP-1998-206891 (1998).\n[6] Jacchia L.G. 1972, in CIRA72: COSPAR International Reference Atmosphere 1972,\ncompiled by the committee for CIRA of Cospar Working Group 4 (Berlin: Akademie \xe2\x80\x93\nVerlag), 227.\n[7] O. Montenbruck, E. Gill, Satellite Orbits, Springer \xe2\x80\x93 Verlag, 2000.\n[8] Jackson J. Monthly Notice of the Royal Astronomical Society 84, 602 (1924).\n[9] Merson R. H. RAE Technical Report 74184, Royal Airforce Establishment (1974).\n[10] ftp://sayatnova.jpl.nasa.gov/pub/genesis/, GENESIS, CHAMP orbital and GPS\ndata, last accessed August 2007.\n\n'