b',-.\n\n*-.\n\nNASA TN D-4400\n\nNASA TECHNICAL NOTE\n\n-\n\nc\n\ne. 55\n0\n0\n\nd\n\nP\n\nLOAN COPY: RETURN TO\nAFWL (WLlh-2)\nKIRTLAND AFB, N MEX\n\nMULTI-STEP RUNGE-KUTTA METHODS\n\nby Joseph S. Rosen\nGeorge C. Marshall Space Flight Center\na\nHuntsville, A Z .\nNATIONAL AERONAUTICS A N D SPACE ADMINISTRATION\n\nWASHINGTON, D. C.\n\n0\n\nAPRIL 1968\n\nNASA T N D-4400\n\nMULTI-STEP RUNGE-KUTTA METHODS\n\nBy J o s e p h S. Rosen\nGeorge C. M a r s h a l l Space Flight C e n t e r\nHuntsville, Ala.\n\nNATIONAL AERONAUTICS AND SPACE ADMINISTRATION\nFor sole by the Clearinghouse for Federal Scientific and Technical Information\nSpringfield, Virginio 22151\nCFSTI price $3.00\n\n-\n\nTABLE OF CONTENTS\nPage\n\n..........................................\nINTRODUCTION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nTHE TWO-STEP FOURTH-ORDER SOLUTION . . . . . . . . . . . . . . . . .\nTHE RUNGE- KUTTA MATRIX EQUATION\n...................\n\nI\n\nSUMMARY\n\nTHE TWO-STEP FIFTH-ORDER RUNGE-KUTTA EQUATIONS\nAPPENDIX A.\nEQUATIONS\nAPPENDIX B.\nEQUATIONS\n\nI\nI\n\n7.\n\n......\n\n9\n\nDERIVATION O F THE TWO-STEP FOURTH-ORDER\n\n........................................\n\n16\n\nSOLUTION O F THE TWO-STEP FOURTH-ORDER\n\n.........................................\nREFERENCES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n19\n\n21\n\nLIST OF TABLES\nTable\n\nI.\n\nII.\n\nPage\n\nTitle\nThe Conditions for the Two-step Fourth-Order P r o c e s s\nGiven by Equations (14), (16), ( 1 8 ) , and (19)\n\n............\n\nThe Results of Combining Similar T e r m s of the Left and Right\nMembers of the Equations in Table I\n\n...................\n\niii\n\n17\n\n18\n\nMULT I- STEP R UNGE- KUTTA METHODS\nSUMMARY\nThe multi-step methods presented i n this r e p o r t differ from the classic,\nsingle-step Runge-Kutta process by utilizing the numerical r e s u l t s of the\nprevious integrations. A s developed h e r e , the multi-step process avoids the\ncomplex Taylor expansions of the functions involved and instead employs the\nwriter\'s previously developed method of quadratures.\n\nINTRODUCTION\nThe classic Runge-Kutta method, which is a single-step process, has a\nnumber of pleasing properties, but since i t does not utilize previous numerical\nresults of the integration, i t s efficiency is impaired. This defect will be somewhat remedied h e r e by developing a multi-step method that is quite analogous\nto the single-step Runge-Kutta process. By utilizing the evaluations at preceding points of the function i n the differential equation to be integrated, some\nreduction in the number of evaluations required in the single-step process is\nexpected.\nPerhaps the greatest obstacle in the development of a multi-step process\nis the tedious--and formidable--task of making Taylor expansions of the functions (those for both the c u r r e n t and preceding points) about the current point.\nIn a recent article [ 11, the w r i t e r has developed a "method of quadratures"\nfor obtaining the system of equations that determine the p a r a m e t e r s of the\n(single-step) classic Runge-Kutta process; this method obviates the need\'for\nmaking the complex Taylor expansions. In this report we will show how the\nmethod of quadratures can be extended to the multi-step process.\n\nTHE TWO-STEP FOURTH-ORDER SOLUTION\nFor simplicity, we will consider only the initial value problem\n\nthough the results may be extended to systems of differential equations.\ndefine the sequence of equations\n= hf (XO, yo)\n\nWe\n\n(2a)\n\nwhere xo and yo designate the current point.\n\nLet\n\nrefer to the preceding point separated by the step-size h. If we replace xo, yo\nin equation (2) by x - ~ y-l (and make the appropriate changes in the superand\ns c r i p t s on the k\'s) , we get\n\nIn equations (2) and ( 4 ) , and subsequently, the superscripts will distinguish\nthe current from the preceding point.\nWe will show that\n\nwith appropriate values for the weights and the p a r a m e t e r s in equations ( 2 )\nand ( 4 ) , will give a solution of fourth-order accuracy at (xo h). Since\n+\n\n2\n\nthe evaluations of the functions in equation (4) will already have been made,\nonly the three evaluations in equation (2) will be required to find the solution\nat the next point (xo + h ) . Because these evaluations are the most timeconsuming part of the computation and since the classic Runge-Kutta theory\nrequired four evaluations for this o r d e r , the advantage of this multi-step\nmethod is evident.\nSuppose now that equation ( I ) is reformulated as\n\nin which form it includes the initial conditions. Now let us replace the right\nmember of equation ( 6 ) by the approximating quadrature sum\nr\n\nI\n\nwhere for convenience we hzve set\n\nand\n\nx-3 =\n\nXO\n\n+\n\n- i)h\n\nand where yi will be used for y ( x i ) .\n\n(9)\n\nWe will now show how we may replace\n\neach t e r m in equation ( 7 ) by its corresponding t e r m in equation ( 5 ) .\n\nIExcept initially.\nself-starting.\n\nThus, in common with all multi-step methods, it is not\n\n2This assumes that the e r r o r s in the two c a s e s a r e comparable--which need not\nbe the case.\n3\n\nA s we have shown in [ I] , in o r d e r for equation (7) to be a quadrature\napproximation of equation ( 6 ) with fourth-order accuracy i n h, the following\nrelations must hold:\n\nwhere u. is given by\nJ\n\nThe reason f o r showing the partitions in the m a t r i c e s in equation (IO) is evident.\n\nIf we substitute equations ( 8 ) , ( 9 ) , and (11) into equation (IO) and\nequate coefficients of like powers of h, we get the matrix equation that may\nreplace equation ( I O ) 3\n\n3See reference [ I] for more details about this operation.\n\n4\n\nThese give some of the equations in the multi-step Runge-Kutta process.\nUsing the quadrature method, let us now examine the further conditions\nby which equation ( 7 ) may be replaced by equation ( 5 ) . If we compare analogous\nt e r m s in equations (5) and ( 7 ) we s e e that the differences are in the expressions\nthat replace yi in the functions f ( x i , yi) ; the substitutions for yi, shown i n\nequations (2) and (4) , substantially represent the unique aspect of the RungeKutta process. These interchanges for the yi in f ( x i , yi) might be permissible\nif the t e r m s in equation ( 7 ) are replaced by expressions of an acceptable o r d e r ,\nthe o r d e r three in this c a s e , not four, because of the factor h in both equations\n( 5 ) and ( 7 ) . To attain this precision certain conditions, which will give other\nRunge-Kutta equations, must be imposed.\n\nThus, the f i r s t t e r m in equation ( 7 ) that will be affected by substituting\nreplacements for y. is [(xi, y l ) , which is to be replaced by\n1\n\na s may be seen from equation (2b). This may be done by making a quadratuw\napproximation \xe2\x82\xacor y1 that replaces it with (yo+ /321k1(o) , as is shcwn in\n)\nequation (13) ; to attain the requisite precision indicated previously, the\nfollowing conditions must hold [ I] :\n\n5\n\nSimilarly, to replace f ( ~ - ~ -, ~ ) in equation (7)by f ( ~ - , , y - + Pzlkl(-1) ) ,\nY\n~\n\nas shown i n equation (4b), with the necessary precision, we must also satisfy\nthe conditions\n\nwhere\n\nr\n\n=\n\n0,1,2,3\n\n(17)\n\nA s may easily b e seen , equations (16) and (17) can be obtained simply\nby replacing xoby (xo- h) i n equations(l4) and (15); this is to be expected\nif we note that equation (4b) is obtained from equation (2b) by the s a m e transformation.\nSimilarly, we can replace f(x2, y2) and f ( ~ - ~ -, ~ ) in equation ( 7 ) by\nY\nthe functions shown in equations (2c) and (4c) ; this is accomplished by replacing y2 and y-3 with appropriate quadratures.\nThe conditions f o r replacing y2 by (yo+ p31k1(0) + p32k2(0)) as\n,\nshown i n equation (2c) and with the requisite degree of precision three, are\n\nwhere u (a3) given by equation (15).\nis\n\nr\n\n6\n\nSimilarly, to replace y-3 in f (x-3, y-3) by (y-1+ P3ikl(-I)+ P3zk2 (-1) ) ,\n\nas is indicated in equation (4c) , with the required degree of precision,\nwe must satisfy\n\nwhere Ti ( a3) is given by equation (17). A s before, we can see that equation\nr\n(19) can be obtained from equation (18) by replacing xo with (xo - h) -- and,\nof course, xi with xo -- with corresponding changes in the right members.\n\nTHE RUNGE-KUTTA MATRIX EQUATION\nIn [ I we have shown, for the classic single-step c a s e , how the conditions\n]\nwe derived by using our quadrature method--in this present c a s e the analogous\nequations (14) , (16) , (18) , and (19) --are used to give an applicable RungeKutta matrix equation.\nWe will here reconstruct the general idea without too detailed a treatment ( s e e also Appendix A ) . Using the aforementioned equations, let US f o r m\nthe following weighted expressions:\n\nLet us first dispose of the case j=O.\n(15) and (17) , that\n\n-\n\nuo (ai+l) = uo (ai++ =\nSO\n\nWe must first note, by equations\n\nh\ni+I\n\n,\nthat the first equations in (14) , (16) (18) , and (19) are identically\n\nsatisfied if\na 2 =\n\nPzi\n\n7\n\nIn general, the equations\ni+i\n\n=\n\n\'i+iY i\n\n+\n\na\n\n\'i+2,2\n\n+\n\n\'\n\n-\n\ni=1,2\n\n+\n\n(N-1)\n\n(21)\n\nY\n\nhold as they do i n the single-step case.\n\nLet u s illustrate the result of using equation (20) when j=2.\nequations (15) and (17) to replace the u I s , we have\n\nUsing\n\nj\n\nThe corresponding expression f o r ( 2 0 ) is as follows, if we replace\nuz( az) , uz( as) and Uz( 02) , Uz( a 3 ) by the left m e m b e r s of the equations ( 14) ,\n(16) , (18) and (19):\n\nIf now we equate powers of h in equations (22) and ( 2 3 ) we obtain the\ntwo Runge-Kutta equations:\nw2\n(-1)az2+ w3\n(-I) ( a 3 2 - 2p32az) +\n\nW2 O ) 0 i 2 2\n(\n\n+\n\nW3(O)\n\n(a32\n\n- 2832a2)\n\n=\n\no\n\n(24)\n\n4We omit the h t e r m since it contributes nothing new.\n\n8\n\nNo new results will be derived i f we treat equation ( 2 0 ) similarly when\nj = I , 3.\n\nWithout repeating in detail what has been developed in [ I] for the singlestep classic Runge-Kutta process, we will note that we can replace w; (O) i n\n\n!\'\n!\'\nA\nequation (20) by w (O) a and, similarly, o - ) by o - ) (ai - I). lrepetition\ni\n\ni\n\n1\n\n1\n\nof the previous analysis will yield another Runge-Kutta equation.\nWe will see that, as in the single-step process, i f we can find other sets\nof what we have called generalized Runge-Kutta weight coefficients to use i n\nequation ( 2 0 ) we should eventually be able to produce all of the relevant RungeKutta equations. We will next show how we can get all of these coefficients\nfrom the single-step process and avoid the basic , but tedious , work in the\nillustration above.\nWe will anticipate the r e s u l t s we would obtain i n the form of a matrix\nequation:\n\n(26)\n\nwhere 0 , the right member of equation ( 2 6 ) , is the appropriate null matrix.\n\nTHE TWO- STEP F IFTH-0 RDER RUNGE-KUTTA EQUATIONS\nThe process for obtaining the generalized Runge-Kutta weight matrix,\neven for the relatively simple two-step fourth-order c a s e , becomes somewhat\n5As we will see later,only four of these equations are relevant.\nfor the two-step fourth o r d e r is given in Appendix B.\n\nThe solution\n\n9\n\ninvolved when rigorously justified. We will now examine a procedure that is\nan extension of the one-step process, and that can easily b e extended to any\no r d e r , as is seen in [ I ] . Let us demonstrate this by developing the two-step\nfifth-order Runge-Kutta matrix equation. With a slight modification of the\nr e s u l t s derived in [ 13 , we will first w r i t e out the one-step Runge-Kutta matrix\nequation for the fifth o r d e r with five evaluations.\nLet us define the matrices\n\nand\n\nC=\n\n\xe2\x80\x98The exact number of evaluations is unimportant for our demonstration.\n\n10\n\nand w he r e\n\nY3(O)\n\n(Yi) =\n\nY4(O+Yi)\n\n=\n\nYi0)P43\n\nY 5 ( O ) P54\n\n+\n\nY J O ) P53\n=\n\n0\n\nThe single-step fifth-order Runge-Kutta matrix equation with five\nevaluations\' is given by\n\n7The values f o r y ( O ) ( y . ) , ( j = 2 , 3 , 4 , 5 ) may b e derived from y ( O ) (wi) ,\nj\n\n1\n\nj\n\ndefined by equation (29) , by replacing w . in the l a t t e r t e r m s with the\n1\ncorresponding y ( O) .\ni\n\n*It has been shown [ 2, 3 that the fifth o r d e r r e q u i r e s at least six evaluations\n1\nSince we are using a two-step process, we would like to reduce\nfor a solution.\nthe number of evaluations by one.\n\nwhere 0 is the appropriate null matrix and where\n\nand C is given by equation (28). Combining the m a t r i c e s in equation ( 3 2 ) , we\nget\n\nThe two-step fifth-order Runge-Kutta p r o c e s s with five evaluations\nwill take the linear form\n\nwhe re\n\nand where the s u p e r s c r i p t s ( 0 ) and (-1) refer to the c u r r e n t and preceding\npoints, respectively .\n\n12\n\nTo accommodate the antecedent point, certain modifications will have\nto b e made in the two m a t r i c e s in equation (31). In the case of the matrix\n\n, as we may see from equation (26) , this is quite simple because, aside\nfrom the appropriate s u p e r s c r i p t on w we must replace a!. by ( a ! -1). With\n1\ni\ni\xe2\x80\x99\nthese changes we will call the resulting matrix (-1)\n\n.\n\nThe accompanying change in the matrix in equation (33) is not as simple,\nand only the r e s u l t will b e given for the o r d e r of interest here. Thus, if we\nwrite f o r the matrix in equation (33)\n\n\xe2\x80\x99\n\nor,substituting the values for the elements from equation (33) and using the\nsuperscript (-1) to distinguish it from the matrix f o r the c u r r e n t point, we\nhave\n\n\xe2\x80\x99This is developed i n detail in Appendix A.\n\n13\n\nx(-l) .\n\nwhose elements are partially shown in equation ( 3 9 ) .\nWe can now combine our results to give us the matrix equation for the\ntwo-step fifth-order process. This can be written\n\nappropriate null matrix.\n\nA s an illustration, let u s return to the two-step fourth-order equations\nwith three evaluations at each point, then the matrices in equation (40) become\n\n14\n\nwhich give both the Runge-Kutta equations for the fourth-order methodi0 and\nthe fifth-order t e r m s from which we may find the truncation e r r o r . " If the\nlatter t e r m s are ignored, equation (41) will adequately represent the required\nequations.\nGeorge C. Marshall Space Flight Center\nNational Aeronautics and Space Administration\nHuntsville, Alabama, September I, 1967\n039-00-24-0000\n\n*\'These are the equations in which the sum of the exponents in the product of\nthe a \' s and p \' s in any t e r m is always l e s s than the o r d e r of the process.\n"These equations, aside from some misprints, may be found in [ 41\n\n.\n\n15\n\nAPPENDIX A\nDERIVATION OF THE TWO-STEP FOURTH-ORDER EQUATIONS\nThe conditions we have derived using the quadrature methods for the\ntwo-step fourth-order process are given by equations (14), ( 1 6 ) , (18), and\n( 1 9 ) . We will now display these equations in an expanded form in Table I and\nshow how we can obtain from these the Runge-Kutta equations.\nIn the first two groups ofTable I are given the equations (14) and (18)\nf o r i = 0, I , 2 , 3 , with the u. (a,) and u. ( a 3 ) t e r m s in the right membw:.:\n1\n\n1\n\nexpanded by using equation (15). In the last two groups in Table I are the\nexpanded equations (16) and ( 1 9 ) , where these are obtained from the first\ntwo groups by replacing xo by xo - h.\nIn Table I1 are shown the r e s u l t s of combining s i m i l a r t e r m s of the left\nand right members of the equations in Table I. F o r convenience, i n forming\nequation (20) we have associated each group in these tables with a weight\ncoefficient w (O) o r w ( - I ) ; and in Table I we have retained the origin of each\ni\ni\nequation by the appropriate label u. ( a2)o r u. ( a 3 ) .\n1\n\n1\n\nWith the aid of Table 1 it is quite easy to form the expressions for\n1\nequation ( 2 0 ) and to derive the matrix equation ( 2 6 ) .\n\nIt will be observed that by extending Table I the Runge-Kutta equations\nfor any higher o r d e r multi-step process may be obtained in a similar manner.\n\n16\n\nTABLE I. THE CONDITIONS FOR THE TWO-STEP FOURTH-ORDER PROCESS\nGIVEN BY EQUATIONS (14), ( I C ) , ( 1 8 ) , AND ( 1 9 ) .\n\na,h\n\n(-1)\nW2\n\n=\n\nazh\n\nr\n\nI\n- h) = (azh) ( X O - h) + - h2 CY^2\n2\n( a z h ) (xo - h ) 2 = ( a z h ) (x, - h ) 2 + (xoh\')\n\n(azh)\n\n(xO\n\n(a,h) (xo- h ) 3 =\n\n1\n\n- h3az2 + - h3az3\n3\n3\n1\na2h(x0- h ) 3 + 2 h2aZ2\n(x: - 2xoh+h2) + h3a: (xo - h) + - h4a;\n012\'\n\n4\n\n0\n\nAPPENDIX B\nSOLUTION OF THE TWO-STEP FOURTH-ORDER EQUATIONS\nThe solution of the Runge-Kutta equations for the two-step fourth-order\nprocess will be indicated h e r e , since the procedure can generally b e followed\nin the solution of other multi-step equations.\nWe must satisfy the four equations in (12) and, in addition, the four\n.\n.\napplicablei2 equations in (26) , which are as follows:\n\n+ w\\O)\'> + el2(m3( - I )\n\nell\n\ne11[w2(-1) (a2-\n\ni>+\n\nw21\n(\'\n\n+\n\nw3\n(0))\n\n= 0\n\na2] + ei2 [w3(-1) (a3-i) +\n\naio)\n\na33 = 0\n\nm - ) (ezi - 2eli) + w(3-i)(e22 - 2ei,) + w i 0 ) e2i + w(3O) e Z 2 =o\ni\'\nP32\n\nwhere e\n\nij\n\n(w3\n(-1) + $))\n\n= 0\n\nis defined by equations ( 3 3 ) and ( 3 7 ) .\n\nFrom equations (4-B) and ( I - B ) we easily obtain\n(-1)\n\n+\n\n= 0\n\n(-1)\n\n+\n\n=\n\nWZ\n\nw3\n\n0\n\nand i f we combine these with the f i r s t equation in ( 1 2 ) , we get also\n\n(-I)\n\nai\n\n+\n\nw1 0 ) = 1\n(\n\n12These are the equations that contain only t e r m s in which the s u m s of the\nexponents in the products of the a \' s and P\'s do not exceed three.\n\n19\n\nUsing equation (5-B) , both equations ( 2 - B ) and (3-B) can be reduced to\n\nw20 ell + w30 eI2 = 0\nor\n\nEquations (5-B) and ( 6 - B ) can now be used to simplify the remaining\nt h r e e equations in ( 1 2 ) , which become\n\nThis linear system in the weights can readily be solved:\n\nUsing the l a s t equation i n (8-B) , equation (7-B) reduces to\n\n1\nP32 =\n\n6 w j O ) a2\n\nso that equations ( 2 - B ) and ( 3 - B ) a r e also satisfied, provided\n\nP 32 = 2a3 ( a , - a,)\na2 ( 4 - 5 % )\n\n20\n\n(10-B)\n\nREFERENCES\nI. Rosen, J. S. : The Runge-Kutta Equations by Quadrature Methods.\nNASA TI3 R-275, NOV. 1967.\n2. Butcher, J. C. : Coefficients for the Study of Runge-Kutta Integration\nProcess. J. Austral. Math. SOC., vol. 3 , 1963, pp. 185-201.\n\nShanks, E. B. : Higher Order Approximations of Runge-Kutta Type.\nNASA TN D-2920, September 1965, p. 6.\n3.\n\n4. Byrne, G. D., and Lambert, R. J. : Journal of the Association for\nComputing Machinery, vol. 13, no. 1, January 1966 , PP. 114-123.\n\nNASA-Langley, 1968\n\n- 19\n\nM521\n\n21\n\nNational Aeronautics and Space Administration\n\nFIRST CLASS MAIL\n\nPOSTAGE AND FEES PAID\nNATIONAL AERONAUTICS AND\nSPACE ADMINISITL4IION\n\nWASHINGTON, D. C.\nOFFICIAL BUSINESS\n\nPOSTMASTER:\n\nIf Undeliverable (Section 158\nPostal Manual) Do Not Return\n\n\xe2\x80\x9cThe aeronautical and space activities of the United States shall be\nconducted so as to contribute\n. to the expansion of human knowledge of phenomena in the atmosphere and space. The Administration\nshall provide for the widest practicable and appropriate dissemination\nof information concerning its activities and the results tbereof.\xe2\x80\x9d\n\n..\n\n-NATIONAL\n\nhRONAUTICS A M ) SPACE\n\nACT OF 1958\n\nNASA SCIENTIFIC A N D TECHNICAL PUBLICATIONS\nTECHNICAL REPORTS: Scientific and technical information considered\nimportant, complete, and a lasting contribution to existing h o w l d g e .\nTECHNICAL NOTES: Information less broad in scope but nevertheless of\nimportance as a contribution to existing knowledge.\nTECHNICAL MEMORANDUMS: Information receiving limited distribution because of preliminary data, security classification, or other reasons.\nCONTRACTOR REPORTS: Scientific and technical information generated\nunder a NASA contract or grant and considered an important contribution to\nexisting knowledge.\nTECHNICAL TRANSLATIONS: Information published in a foreign\nlanguage considered to merit NASA distribution in English.\nSPECIAL PUBLICATIONS: Information derived from or of value to NASA\nactivities. Publications include conference proceedings, monographs, data\ncompilations, handbooks, sourcebooks, and special bibliographies.\nTECHNOLOGY UTILlzATION PUBLICATIONS; Information on technology used by NASA that may be of particular interest in commercial and other\nnon-aerospace applications. Publications indude Tech Briefs, Technology\nUtilization Reports and Notes, and Technology Surveys.\nDctails on the availability of these publications may be obtained from:\n\nSCIENTIFIC AND TECHNICAL INFORMATION DIVISION\n\nNATIONAL AERONAUTICS AND SPACE ADMINISTRATION\nWashington,\n\nD.C. PO546\n\n'