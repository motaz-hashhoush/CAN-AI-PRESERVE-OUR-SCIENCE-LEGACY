b'THEORETICAL AND SUBJECTIVE\nBIT ASSIGNMENTS IN TRANSFORM\nPICTURE PROCESSING\nHarry W. Jones, Jr.\nAmes Research Center\nM o f e t t Field, Gal$ 94035\nNATIONAL AERONAUTICS A N D SPACE ADMINISTRATION\n\n-\n\nWASHINGTON, 0. C.\n\nMARCH 1977\n\nTECH LIBRARY KAFB. NM\n\n.-\n\n.\n.\n\n__\n\n.\n\n1. Report No.\n\n3. Recipient\'s Catalog No.\n\n2. Government Accession No.\n\nNASA TN D-e440\n5. Report Date\n\n4. Title and Subtitle\n\nMarch 1977\n\nTHEORETICAL AND SUBJECTIVE BIT ASSIGNMENTS IN TRANSFORM PICTlJRE\n\nI\nI\n\n8. Performing Organization Report No.\n\n7. Author(s1\n\n~-6781\n\nHarry W. Jones, Jr.*\n\n10. Work Unit No.\n\n~~\n\n650-60-10-01\n\n9. Performing Organization Name and Address\n\nI\n\nAmes Research Center, NASA\nMoffett Field, Calif. 94035\n\n11. Contract or Grant No.\n\n13. Type of Report and Period Covered\n12. Sponsoring Agency Name and Address\n\nTechnical Note\n14. Sponsoring Agency Code\n\nNational Aeronautics and Space Administration\nWashington, D. C. 20546\nI\n\n15. Supplementary Notes\n\n\'<National Research Council Postdoctoral Research Associate.\n116. Abstract\n\nIt is shown that all combinations of symmetrical input distributions with difference\ndistortion measures give a bit assignment rule identical t o the well-known rule for a Gaussian\ninput distribution with mean-square error. Published work is examined to show that the bit\nassignment rule is useful for transforms of full pictures, but subjective bit assignments for\ntransform picture coding using small block sizes are significantly different from the theoretical\nbit assignment rule. An intuitive explanation is based on subjective design experience, and a\nsubjectively obtained bit assignment rule is given.\n\n17. Key Words (Suggested by Author(s) )\n\n18. Distribution Statement\n\nImage compression\nPicture coding\nQuantization, quantizers\n\n19. Security Classif. (of this report)\n\nUnc 1ass ified\n\nUnlimited\n\nI\n\n20. k r i t y Classif. (of this page)\n\nUnclassified\n\n21. NO. of Pages\n\n16\n\n\'For sale by the National Technical Information Service, Springfield, Virginia 22161\n\n22. Price\'\n\n$3.25\n\nTHEORETICAL AND SUBJECTIvE BIT ASSIGNVENTS IN\nTRANSFORM PICTIJRE PROCESSING\nHarry W. Jones, Jr."\nAmes Research Center\nSUMMARY\nIt is shown that all combinations of symmetrical input distributions with\ndifference distortion measures give a bit assignment rule identical to the\nwell-known rule for a Gaussian input distribution with mean-square error. Published work is examined to show that the bit assignment rule is useful for\ntransforms of full pictures, but subjective bit assignments for transform picture coding using small block sizes are significantlv different from the\ntheoretical bit assignment rule. An intuitive explanation is based on subjective design experience, and a subjectively obtained bit assignment rule is\ngiven.\nINTRODlrCTIDN\nIn transform picture coding, a picture or smaller subpictures are\nlinearly transformed and the resulting transform coefficients are quantized\nand transmitted. If the picture elements are highly correlated, most of the\ntransform domain energy is concentrated in a few transform vectors that revresent averages of adjacent picture elements. The transmitted information is\nused to specify these high-energy vector coefficients, and the resulting transmission rate for a given distortion is closer to the theoretical bound than the\noriginal untransformed picture data rate. Although the Karhunen-Loeve or\neigenvalue transformation is best, the computationally simpler Fourier, cosine,\no r Hadamard transforms have been found useful (refs. 1 to 3 ) .\nThe bit assignment and quantizers that give minimum mean-square error for\nrfs\na set of independent Gaussian random variables are well known [ e \' . 4 and 5).\nThe assumptions of Gaussian distribution and mean-square-error criterion are\nnot always correct for the transform Coefficients of images, and new quantizers\nhave been found for more appropriate distributions and more general error criteria (refs. 6 and 71. It will be shown that all combinations of symmetrical\ninput distribution with difference distortion measures give a bit assignment\nalgorithm identical to the well-known algorithm for a Gaussian input distribution and mean-square-error criterion. Published work is examined to show that,\nalthough the bit assignment algorithm is useful for transforms of full pic-.\ntures, subjectively designed bit assignments for pictures transformed using\nsmall subpicture blocks differ significantly from the theoretical algorithm.\nFinally, an intuitive explanation of this discrepancy is given, based on a\n. . . . . . . . . .\n\n*National Research Council Postdoctoral Research Associate.\n\ns u b j e c t i v e d e s i g n of a Hadamard t r a n s f o r m v i d e o compressor ( r e f . 8),\ns u b j e c t i v e l y o b t a i n e d b i t assignment r u l e w i l l be s t a t e d .\n\nand a\n\nTHEORETICAL BIT ASSIGNMENTS\n\nHuang and S c h u l t h e i s s ( r e f . 5) determined t h e optimum b i t assignment u s i n g\nt h e r a t e d i s t o r t i o n f u n c t i o n f o r Gaussian i n p u t and mean-square e r r o r . If w e\nassume t h a t t h e d i s t o r t i o n depends on t h e d i f f e r e n c e between t h e e x a c t t r a n s form c o e f f i c i e n t ( x i ) and i t s corresponding r e p r e s e n t a t i v e v a l u e ( y i ) , t h e\nlower bound of t h e r a t e d i s t o r t i o n f u n c t i o n i s w e l l known ( r e f s . 9 and 10).\nF o r i n p u t d i s t r i b u t i o n p ( x ) and d i s t o r t i o n\n1 N\n1 N\nD = d(xi - yi) = N\nIxi\nN\ni=\n1\ni=i\nt h e r a t e d i s t o r t i o n f u n c t i o n i s bounded as f o l l o w s :\n\n-\n\n-\n\n9\n\nyil\n\nI f we assume t h a t t h e t r a n s f o r m c o e f f i c i e n t s ( x i ) have t h e s a m e . d i s t r i b u t i o n , d i f f e r i n g o n l y i n s c a l e o r v a r i a n c e , we can show t h a t t h e e n t r o p i e s o f\nt h e i n p u t d i s t r i b u t i o n s H[p(x)] a r e i d e n t i c a l except f o r a f u n c t i o n of v a r i ance. Suppose t h a t k ( I y l ) i s a p r o b a b i l i t y d e n s i t y having u n i t v a r i a n c e ;\nk ( ( y l ) i s obviously z e r o mean and symmetrical about zero. If\n\npCa,x) = akClaxl)\nwhere\n\nc1\n\ni s a s c a l e parameter, t h e n\n\nak(laxl)dx =\n-03\n\nT h e r e f o r e , p ( a , x ) i s a l s o a z e r o mean, symmetrical p r o b a b i l i t y d e n s i t y .\nv a r i a n c e o f p ( a , x ) i s a f u n c t i o n of t h e scale parameter:\n\nThe\n\n- -1\na2\n\nThe l a s t s t e p f o l l o w s from t h e assumption t h a t\ne n t r o p y of t h e d i s t r i b u t i o n i s\n2\n\nk ( l y ( ) h a s u n i t variance.\n\nThe\n\nm\n\nHpax]\n[(,)\n\n=\n\n=\n\n-\n\n-5\n\nm\n\nak(\n-03\n\nThe entropies of a family of input distributions differing in scale are identical except for a function of the scale or variance.\nThe lower bound on the rate distortion function is then\n\nFor any fixed symmetrical input distribution and f o r any fixed difference distortion measure,\n\nwhere K is a constant determined by the input distribution and distortion\nmeasure. In certain cases, such as the Gaussian distribution with mean-square\nerror or the two-sided exponential distribution with magnitude error, the ratedistortion function is equal to this lower bound (ref. 9, pp. 95 and 9 )\n9 . The\nparameters and performance of the optimum quantizers have been determined from\nthe Gaussian, two-sided exponential, and gamma input distributions and for the\nmagnitude and mean-square-error criteria (refs. 4, 6 , and 7. The resulting\n)\nrate distortion performance curves are reasonably close to the theoretical\nrate distortion curves found above (ref. 7. The two-sided exponential and\n)\nGaussian densities are similar to experimental distributions of transform\ncoefficient distributions.\nF o r a given theoretical or empirical rate distortion curve, the optimum\nbit assignment is found after Huang and Schultheiss (ref. 5, p. 2 9 3 ) . F o r N\nvariables, the rate distortion function is\noi\nb. = R D ) = l0g2K\n(i\n1\nD1/q\ni\n\nwhere K\nmeasure.\n\nis a constant depending on the input distribution and distortion\nFor an average rate A,\n\n3\n\nN\nbi = NA\ni=i\n\nThe t o t a l d i s t o r t i o n i s\n1 N\n-bi 9\nD. =\n(Koi2\n)\nI\nN\ni=1\ni=1\n\nN\n\n1\nN\n\nD =\n\n-\n\nTo minimize d i s t o r t i o n under t h e average r a t e c o n s t r a i n t ,\n\nN\ni=1\n\nSince t h i s quantity i s t h e d i s t o r t i o n f o r t h e i t h v a r i a b l e , a l l v a r i a b l e s\nhave e q u a l d i s t o r t i o n i n t h e optimum b i t assignment:\n\n\xe2\x80\x981\n\n-\n\nUsing t h e sum of\n\nb,,\nI\n\n2\n\nbi =\n\nN\ni=1\n\ni=1\n\n-log2\n1\n9\n\n[\n\n- log2\n1\n9\n\n[\n\nq(Rn NB a i\n2)K\n\nq(RnNi)Kq] = A\n\n- N\n1\n\n= NA\n\nN\n\nc\n\nm2ai\n\ni=1\n\nTherefore,\nb . = 10g20i + A\n1\n\n-\n\n1\nN\n\nN\n\n-\n\n1 0 ~ 2 0 ~\n\ni=1\n\nor\nb . = 1 . 6 6 log1002 + C\n1\ni\n\nf o r c o n s t a n t C. The t h e o r e t i c a l b i t assignment h a s t h e same dependence on\nv a r i a n c e , and no dependence on t h e a c t u a l d i s t r i b u t i o n or d i s t o r t i o n measure,\nf o r a l l combinations of a s c a l e d symmetrical i n p u t d i s t r i b u t i o n with a d i f f e r ence d i s t o r t i o n measure. Furthermore, s i n c e a c t u a l q u a n t i z e r r a t e d i s t o r t i o n\nperformance curvzs have a s l o p e s i m i l a r t o t h e s l o p e o f t h e t h e o r e t i c a l - b o u n d ,\nsometimes d i f f e r i n g o n l y by a c o n s t a n t ( r e f s . 4, 7, and 11), t h e a c t u a l quant i z e r s u s e a very s i m i l a r b i t assignment r u l e . Note t h a t v a r i a b l e s of small\nv a r i a n c e a r e n o t t r a n s m i t t e d (bi = 0) when t h e r e s u l t i n g d i s t o r t i o n i s less\nt h a n t h e equal d i s t o r t i o n D d e f i n e d above.\n\n4\n\nDavisson (ref. 3) indicated that objections have been raised to the use of\nthe standard rate distortion function because the source densities are not\nGaussian and because mean-square error is not appropriate. The result found\nhere eliminates these objections, at least in bit assignment, f o r a wide range\nof source densities and distortion measures. The optimum quantizers are\nderived directly from the correct-source density and distortion measure (refs.\n4, 6, and 7.\n)\nSUBJECTIVE BIT ASSIGNMENTS\nAlthough it is generally accepted that rate distortion theory is not\nuseful in image coding, Mannos and Sakrison (ref. 12) performed an experiment\nthat significantly increases the usefulness of the theory. Their procedure\nwas as follows:\n(1) A nonlinear weighting was performed on the picture samples.\n(2) A smoothed, isotropic power spectral density was estimated.\n(3) The spectral density and rate-distortion theory were used to define\nthe equal maximum distortion in the spectral domain.\n( ) The fast Fourier transform was taken of a full 512 by 512 picture.\n4\n(5) Only the coefficients that exceeded the minimum distortion were transmitted, with Gaussian noise added to give the equal minimum distortion.\n( 6 ) The inverse transform and nonlinear operation were applied.\n( ) The picture was subjectively evaluated.\n7\nAlthough added Gaussian noise, which corresponds to an ideal quantizer, was\nused rather than an actual quantizer, the above steps conform t o the bit assignment theory. The estimated power density and the actual transform coefficients\nwere weighted using different functions and the results evaluated subjectively.\nMannos and Sakrison\'s best curve of contrast sensitivity versus spatial frequency has a peak at 8 cycles/degree and decreases rapidly on either side of\nthe peak, which agrees very well with direct measurements. It follows that,\nif the coefficient variances are weighted according to spatial frequency o r\ntransform vector visibility, the bit assignment theory should produce good\nsubjective results.\nFor correlated picture elements, the coefficient power decreases as spatial frequency increases. Therefore, weighting according to frequency may be\napproximated with weighting according to power. Davisson (ref. 3) considered\nthe coefficient distortion to be\nd. = min(o 2 Boi )\n2x\n1\ni\n\'\nThe bit assignment is\n\nwhere C adjusts the total number of bits, as usual. The best results for a\n256 x 256 Fourier transform picture at 0.5 bits/sample were obtained for\nx = 1/3:\n5\n\nI\n\nb. = 1.11 log1oo$ + C \'\n1\n\n,\n\nfor\n\nCalx\n\n>\n\nIJ\n\ni\n\nThe bit representation for lower powers o r higher spatial frequencies is\nincreased for a fixed total of bits, while the bit representation for high\npowers is decreased. At viewing distances three times the picture height, the\npicture subtends 19", and the picture elements occur 256/19 o r 13.5/deg. Thus\nthe spatial components had frequencies from 0.053 for the full picture to fi\n(13.5) = 19.0 for a checkerboard of the picture elements. These frequencies\nlie largely in the region where contrast sensitivity is increasing with spatial\nfrequency, so Davisson\'s bit reassignment agrees with the work of Mannos and\nSakrison.\nLandau and Slepian (ref. 1 subjectively quantized 4 x 4 Hadamard trans)\nform vectors f o r 256 x 256 pictures. At a viewing distance three times the\npicture height, the spatial frequencies of the 4 x 4 Hadamard blocks vary from\n256/19 (1/4)fi = 4.77 to 256/19 fi = 19.0 cycles/deg. Landau and Slepian\'s\nbit assignments are shown in figure 1, with several theoretical results based\non their covariance values. All bit assignments total 32 bits. The Shannon\ntheory bit assignment and the modified assignment o f Kurtenbach and Wintz (ref.\n13) are similar, but both are quite different from the empirical assignment.\nTable I gives estimated spatial frequencies f o r the Hadamard vectors and shows\nthe application of Mannos and Sakrison\'s frequency weighting to the vector\npowers. This bit reassignment is slightly closer to Landau and Slepian\'s\nempirical bit assi~ment. A linear regression on bi versus 0: for Landau\nand Slepian\'s assignment gives a slope of 3.65, with C = 7.10 for 32 bits.\nThe theoretical and empirical bit assignments differ widely.\n\n0 LANDAU AND SLEPIAN\'S BIT ASSIGNMENT\n0 1.66 10gloUz + 4.38 (SHANNON)\n0 FREOUENCY WEIGHTED (MANNOS\nAND SAKRISON)\nA 2.0 10gloU2 + 4 . 8 5 (WINTZ AND\nKURTENEACH)\n3.65 IOgloUZ +7.10 - L I N E A R REGRESSION\nON LANDAU AND S L E P I A N\n\nI\n\n,\n\n,\n\n,\n\n,\n\nH o o H ~ ~ H 0 2 ~ 2 0 ~ 0 3 ~ 3 H ~ 2 1 H13H34 H22H23H32H33\n0 ~ H21\n1\n\nVECTOR\n\nFigure 1.- Comparison of theoretical\nand empirical bit assignments.\n\n6\n\nKnauer (ref, 14) implemented\nreal-time video three-dimensional\nHadamard transform compression.\nThe video frames are 512 x 512\nsamples; 4 x 4 x 4 subpictures\nwith a time dimension are used.\nExperimentation with a programmable quantizer indicated that\nLandau and Slepian\'s compression\nscheme can be improved very little. In the 1.1-bit/sample bit\nassignment of Knauer\'s table 11,\nthe vectors representing no temporal change have the same bit\nassignments as in Landau and\nSlepian, except that the H00\nvector has seven bits.\n\nHabibi and Wintz (ref. 2 encoded\n)\nfour pictures, of 256 x 256 samples,\n9\nTHEORETICAL\nusing Karhunen-Loeve, Fourier, and\n_____ SUBJECTIVE\n8\nHadamard transforms in 16 x 16 subpica\nI0 7\ntures. They selected rates of 2.0,\nE6\n1.0, and 0.5 bits/sample and a bit\n>\nassignment rule with a slope of 2.0.\nL 5\nFor the Karhunen-Loeve transform,\na 4\nm\nthey found that subjective quality\n$ 3\nwas "improved slightly by assigning\n2.0BlTS per S A M P L E\n2\nmore bits to the samples with larger\nI\nvariances and proportionally fewer\nbits to the samples with the smaller\n0\nVECTOR N U M B E R\nvariances," and found that "the modified bit allocation also resulted in\n.\na slightly smaller mean-square error."\nFigure 2 - Theoretical and subjective bit assignments from Habibi\nTheir theoretical and subjective bit\nand W n z - r f\nit-(e.\n2\n)\nassignments for 2.0 and 0.5 bits/sample are given here in figure 2, and\nthe reassignment for 1.0 bits is similar. Since the theoretical slope is 2.0,\nthe slope of 02 versus vector number is determined by the theoretical bit\nThe subjective bit assignments then determine the subassignments (takle 11).\njective slope. Taking each group of vectors as a data point, linear regression shows that the subjective slopes are 2.55, 2.59, and 2.68 for the 2, 1,\nand 0.5 bit/sample bit assignments. This change of slope is similar to, but\nless than, that of Landau and Slepian. Habibi and Wintz report that no reassignments that were consistently better for the Fourier and Hadamard transforms were found. The frequency range for 16 x 16 Hadamard blocks of 256 x\n256 pictures, viewed at a distance three times the height, varies from 1.19 to\n19.0 cycles/deg. Assuming that the Karhunen-Loeve vectors have a similar frequency range, the bit assignment f o r higher power vectors would be reduced\nfrom the theoretical, as in Davisson\'s experiment discussed previously. The\nsubjective bit reassignment is contrary to the indication of subjective frequency weighting.\nIO\n\n~\n\n0)\n\n.\n\nIt is apparent that subjective bit assignments differ significantly from\ntheoretical bit assignments. The work of Mannos and Sakrison (ref. 12) and\nDavisson (ref. 3 ) indicates that, for transforms of complete 256 x 256 pictures, subjective frequency weighting accounts for the discrepancy. The work\nof Landau and Slepian (ref. 1) , Knauer (ref. 14), and Habibi and Wintz\n(ref. 12) , for small subpictures, shows that larger vectors should be assigned\nrelatively more bits. F o r small blocks, the reassignment is in excess of, or\nin contradiction to, the effect of subjective frequency weighting.\n\nINTUITIVE EXAMINATION OF BIT ASSIGNMENT PROBLEM\nThe reason that subjective bit assignments differ from theoretical bit\nassignments becomes apparent when we consider a subjective compression design\nprocedure for small block size. The 4 x 4 Hadamard vectors are shown in frequency order in figure 3 . If we start with a transformed picture of highest\n7\n\nq u a l i t y , a l l transform c o e f f i c i e n t s\nhave c l o s e l y spaced r e p r e s e n t a t i v e\nv a l u e s covering t h e f u l l p o s s i b l e\nrange. I n t h e f i r s t a t t e m p t t o reduce\nt h e r a t e , some v e c t o r s a r e r e p r e s e n t e d\nby a zero v a l u e t o determine which can\nbe eliminated with l e a s t effect.\nIJsually, many high-sequency v e c t o r s\nhave such small v a r i a n c e t h a t t h i s\ncauses l i t t l e d e g r a d a t i o n . Next, t h e\nranges o f t h e remaining v e c t o r s a r e\nreduced u n t i l edge b l u r s appear.\nL a s t l y , r e p r e s e n t a t i v e v a l u e s are\nthinned out of t h e r e t a i n e d vector\nr a n g e s u n t i l g r a n u l a r n o i s e due t o t h e\nc o a r s e q u a n t i z a t i o n becomes o b j e c t i o n a b l e . Each f i n a l v e c t o r r e p r e s e n t a F i g u r e 3 . - Sequency-ordered 4 x 4\nt i o n has s u f f i c i e n t range t o adequately\nHadamard b a s i s v e c t o r s .\nreproduce edges and h a s enough i n t e r mediate l e v e l s t o minimize q u a n t i z i n g\nn o i s e . These t e s t s of q u a l i t y a r e extremely s u b j e c t i v e , b u t t h e y have some c o r r e l a t i o n w i t h mean-square e r r o r .\nI n a p i c t u r e of h i g h c o n t r a s t , some o f t h e s u b p i c t u r e s w i l l be v e r y l i g h t\no r v e r y d a r k , s o t h a t t h e b l o c k average t r a n s f o r m v e c t o r u s u a l l y has t h e f u l l\np o s s i b l e range ( r e f s . 1 and 1 4 ) . Suppose t h e r e are h i g h c o n t r a s t edges i n t h e\np i c t u r e . Some p o r t i o n s of t h e s e edges w i l l c o i n c i d e w i t h b l o c k edges, and w i l l\nb e reproduced with t h e f u l l o r i g i n a l c o n t r a s t . Other p o r t i o n s o f t h e same edge\nw i l l i n t e r s e c t s u b p i c t u r e s , c a u s i n g t r a n s f o r m v e c t o r c o e f f i c i e n t s of extreme\nv a l u e . These v a l u e s must be c o r r e c t l y r e p r e s e n t e d o r a s i n g l e edge w i l l have\nv a r y i n g c o n t r a s t and s h a r p n e s s . (Edge g h o s t s a l s o a f f e c t t h e v e c t o r e l i m i n a t i o n d e c i s i o n , a s d e s c r i b e d by Knauer ( r e f . 1 5 ) . ) Adequately r e p r e s e n t i n g t h e\nedges r e q u i r e s t h a t some o f t h e v e c t o r c o e f f i c i e n t s have wider r e p r e s e n t a t i v e\nv a l u e ranges and more b i t s t h a n t y p i c a l s u b p i c t u r e s would need.\nThe above argument can b e q u a n t i f i e d i f some assumptions a r e made. For an\nN s u b p i c t u r e , t h e Hadamard t r a n s f o r m m a t r i x , H, i s an N2 x N2 m a t r i x o f\n2 1 elements. The v e c t o r c o e f f i c i e n t v a l u e i s found by adding and s u b t r a c t i n g\nsample v a l u e s . The H m a t r i x i s m u l t i p l i e d by 1 / N , s o t h a t t o t a l power i s\nequal i n t h e sample and t r a n s f o r m domains. If t h e sample c o r r e l a t i o n m a t r i x i s\nN\n\nx\n\nxTx, t h e t r a n s f o r m c o r r e l a t i o n m a t r i x i s\n\nT\n\n-\n\n1\nT 1\nyy=--H x X-H\nN\nN\n\n-\n\nT\nThe powers o r v a r i a n c e s o f t h e t r a n s f o r m v e c t o r s are on t h e d i a g o n a l o f y y.\nW assume u n i t v a r i a n c e samples produced by a f i r s t - o r d e r Markov p r o c e s s w i t h\ne\nsample t o sample c o r r e l a t i o n of 0.95, v e r t i c a l l y and h o r i z o n t a l l y ( r e f s . 2 and\n3 ) . The e q u a t i o n above d e f i n e s t h e t r a n s f o r m c o e f f i c i e n t v a r i a n c e s , which\ndetermine t h e t h e o r e t i c a l b i t assignment and g i v e an e s t i m a t e o f t h e c o e f f i c i e n t range. Q u a n t i z e r s f o r t h e Gaussian d i s t r i b u t i o n have a maximum r e p r e s e n t a t i v e v a l u e of about 30 ( r e f . 4 ) . Average v a l u e s o f t h e 30 p o i n t f o r Hadamard\n\n8\n\nv e c t o r s and groups o f Hadamard v e c t o r s of d i f f e r e n t block s i z e are given i n\nt a b l e 111.\nW n e x t determine t h e l a r g e s t v e c t o r c o e f f i c i e n t s produced by s h a r p , highe\nc o n t r a s t edges. If t h e u n i t v a r i a n c e samples a r e assumed t o have uniform d i s Consider a v e r t i c a l edge d i v i d i n g a l i g h t\nt r i b u t i o n s , t h e sample r a n g e i s\nr e g i o n on t h e l e f t from a dark\nr e g i o n on t h e r i g h t . The v a l u e of\nH 0 0 f o r a 4 x 4 s u b p i c t u r e ( f i g . 3) v a r i e s from + 4 6 f o r a l l l i g h t samples t o\n- 4 6 f o r a l l d a r k samples, s i n c e 16(N2) samples a r e added w i t h t h e same s i g n\nand d i v i d e d by a s c a l e f a c t o r o f ( 1 / 4 ) , (1/N). When t h e t r a n s i t i o n o f t h e HO1\nv e c t o r l i n e s up w i t h t h e edge, t h e H 0 1 c o e f f i c i e n t i s 4 a ; t h e v a l u e should\nb e - a o r an edge t r a n s i t i o n o f o p p o s i t e s i g n . When t h e edge c o i n c i d e s w i t h\n4 f\none o f t h e t r a n s i t i o n s o f H 0 2 , t h e c o e f f i c i e n t i s - Z n , and H 0 3 h a s t h e same\nextreme edge induced v a l u e . The same maximum v a l u e s occur f o r h o r i z o n t a l\nedges and t h e corresponding v e c t o r s with h o r i z o n t a l t r a n s i t i o n s , and similar\nextreme v a l u e s can b e found f o r d i a g o n a l and skew edges and Hadamard v e c t o r s\nw i t h b o t h h o r i z o n t a l and v e r t i c a l t r a n s i t i o n s . The maximum-edge-induced coeff i c i e n t v a l u e s f o r v a r i o u s block s i z e s a r e shown i n t a b l e 111. I f t h e subpict u r e e x a c t l y matched t h e Hadamard v e c t o r a t t e r n s , and had maximum l i g h t - d a r k\nrange, t h e c o e f f i c i e n t v a l u e would be N 3, t h e maximum v a l u e f o r a l l\ncoefficients.\n\n(+a)\n\n*a.\n(-a)\n\nP\n\nF o r t h e s m a l l e r block s i z e s shown i n t h e t a b l e , t h e maximum-edge-induced\nc o e f f i c i e n t s of v e c t o r s w i t h a l l v e r t i c a l o r a l l h o r i z o n t a l t r a n s i t i o n s (Hox\no r Hxo) a r e equal t o 9 t o 130, w h i l e t h e maximum-edge-induced c o e f f i c i e n t s of\nv e c t o r s w i t h b o t h h o r i z o n t a l and v e r t i c a l t r a n s i t i o n s are equal t o 3 t o 50.\nThe e x i s t e n c e of edges r e q u i r e s a l a r g e r e x t e n s i o n of range f o r v e c t o r s w i t h\no n l y v e r t i c a l o r h o r i z o n t a l t r a n s i t i o n s t h a n f o r v e c t o r s with both. F o r small\nblock s i z e s , a l l samples a r e h i g h l y c o r r e l a t e d and t h e H 0 0 v e c t o r has t h e\nsample d i s t r i b u t i o n , assumed t o b e uniform and f u l l range. Then t h e v a r i a n c e\ni s approximately (v\'??N)~/~ N 2 and 30 = 3N.\n=\n\nThe H 0 0 v e c t o r should have f u l l range, and i f maximum-edge-induced coeff i c i e n t s occur, t h e H01 and H10 should have f u l l range, t h e H 0 2 , H 0 3 , H 2 0 ,\nand H 3 0 should have h a l f range, e t c . As shown i n t a b l e I V Y t h e l a r g e s t r e p r e s e n t a t i v e v a l u e s i n t h r e e s u b j e c t i v e 4 x 4 Hadamard systems a r e 20 t o 50 p e r c e n t of t h e maximum edge c o e f f i c i e n t s . The edge d i f f e r e n c e s a r e u s u a l l y o n l y\nfrom l i g h t t o dark r a t h e r t h a n from w h i t e t o b l a c k . Experimental Hadamard\nc o e f f i c i e n t d i s t r i b u t i o n s a r e u s u a l l y e x p o n e n t i a l , w i t h t h e number of extreme\nv a l u e s depending on t h e frequency and s h a r p n e s s o f edges. The observed highv a l u e c o e f f i c i e n t s due t o edges, though l e s s t h a n t h e maximum p o s s i b l e , s t i l l\nr e q u i r e r e p r e s e n t a t i v e v a l u e s extending t o t h e t h e o r e t i c a l 5 o r 60 p o i n t .\nI n t h e d e s i g n of a r e a l - t i m e hardware Hadamard t r a n s f o r m v i d e o compressor,\nan a d a p t i v e system was used ( r e f . 8 ) . Depending on t h e v e c t o r c o e f f i c i e n t magn i t u d e s , 4 x 4 b l o c k s were q u a n t i z e d d i f f e r e n t l y . The most f r e q u e n t l y used\n(61 p e r c e n t ) b i t assignment and q u a n t i z a t i o n was based on a t h e o r e t i c a l b i t\nassignment f o r a Markov c o r r e l a t i o n model w i t h 0.95 c o r r e l a t i o n between h o r i z o n t a l l y a d j a c e n t elements. The second method was used when v e c t o r c o e f f i c i e n t s exceeded t h e ranges i n t h e f i r s t method, and i s q u i t e similar t o Landau\nand S l e p i a n \' s design. The t h i r d method i s used when v e c t o r magnitudes exceed\n9\n\nt h e range of t h e second method, and p r o v i d e s s u p e r i o r r e p r o d u c t i o n of s h a r p ,\nh i g h - c o n t r a s t edges. I t i s a p p a r e n t t h a t edges, r a t h e r t h a n t h e most t y p i c a l\ns u b p i c t u r e s , determined Landau and S l e p i a n \' s design.\nAs b l o c k s i z e i n c r e a s e s from 2 x 2 t o 8 x 8, t h e maximum-edge-induced\nc o e f f i c i e n t s become smaller compared t o t h e t h e o r e t i c a l s t a n d a r d d e v i a t i o n .\nF o r f u l l p i c t u r e t r a n s f o r m s , l a r g e - s c a l e edges s i m i l a r l y can cause extreme\nc o e f f i c i e n t v a l u e s , b u t s e v e r a l f a c t o r s make t h i s p o s s i b i l i t y r e l a t i v e l y unimp o r t a n t . For a f u l l 512 x 512 p i c t u r e , t h e r e i s o n l y one H O 1 v e c t o r .\nIf t h e\np i c t u r e i s broken i n t o 4 x 4 s u b p i c t u r e s , t h e r e a r e 16,384. The observed f r e quency o f l a r g e H 0 1 c o e f f i c i e n t s f o r f u l l - p i c t u r e t r a n s f o r m s w i l l be one i n\nmany p i c t u r e s ; f o r 4 x 4 t r a n s f o r m s t h e observed frequency w i l l be many i n one\np i c t u r e . Most compression systems a r e t e s t e d on only a few p i c t u r e s , and poss i b l y f u l l - p i c t u r e systems would p o o r l y reproduce a p i c t u r e h a l f b l a c k and\nh a l f w h i t e ( i . e . , a p i c t u r e e q u a l t o an extreme H O 1 v e c t o r ) . A second r e a s o n\nt h a t edge e f f e c t s a r e unimportant i n f u l l - p i c t u r e t r a n s f o r m s i s t h a t , s i n c e\neach c o e f f i c i e n t d e s c r i b e s t h e f u l l p i c t u r e , t h e r e are no n o t i c e a b l e d i f f e r ences i n edge r e n d i t i o n between r e g i o n s . A b l u r r e d edge i s uniformly b l u r r e d ,\nand such b l u r s a r e less n o t i c e a b l e because comparison i s d i f f i c u l t . T h i r d l y ,\na l l f u l l - p i c t u r e v e c t o r c o e f f i c i e n t s are determined u s i n g a l l p i c t u r e elements\n( 2 1 8 ) , which t e n d s t o average l o c a l f e a t u r e s o r edges and make t h e c o e f f i c i e n t\nd i s t r i b u t i o n approach t h e Gaussian, which h a s r e l a t i v e l y fewer extreme v a l u e s\nt h a n t h e e x p o n e n t i a l d i s t r i b u t i o n observed f o r small s u b p i c t u r e s .\n\nThe s u b j e c t i v e b i t assignment r u l e f o r s m a l l block s i z e seems t o b e :\n\n( 1 ) Quantize t h e block average c o e f f i c i e n t uniformly over t h e f u l l poss i b l e range, with 6 t o 8 b i t s .\n( 2 ) Determine t h e t h e o r e t i c a l b i t assignment f o r t h e r e q u i r e d b i t r a t e ,\nu s i n g measured v a r i a n c e s o r t h e t h e o r e t i c a l v a r i a n c e s f o r t y p i c a l p i c t u r e s .\n(3) Add one b i t (and extend t h e r e p r e s e n t a t i v e v a l u e range) f o r v e c t o r s\nwith a l l v e r t i c a l o r a l l h o r i z o n t a l t r a n s i t i o n s .\n(4) Use z e r o b i t s i n s t e a d of t h e t h e o r e t i c a l number f o r t h e h i g h e s t\nsequency v e c t o r s u n t i l t h e number b i t s i s reduced t o t h e r e q u i r e d r a t e .\nT h i s r u l e reproduces Landau and S l e p i a n \' s b i t assignment i n f i g u r e 1, w h i l e\nt h e c l o s e s t b i t assignment based on c o e f f i c i e n t v a r i a n c e s i s a poor approximat i o n and has no i n t u i t i v e j u s t i f i c a t i o n .\nA e Research Center\nms\nN a t i o n a l Aeronautics and Space A d m i n i s t r a t i o n\nM o f f e t t F i e l d , C a l i f . , 94035,October 1 9 , 1 9 7 6\n\n10\n\nQEFERENCES\n1\n.\n\nLandau, H. J.; and Slepian, D.: Some Computer Experiments in Picture\nProcessing for Bandwidth Reduction. Bell Systems Tech. .T., vol. 50,\nno. 5, b4ay-June 1971, pp. 1525-1540.\n\n2\n.\n\nHabibi, Ali; and Wintz, Paul A : Image Coding by Linear Transformation\n.\nand Block Quantization. IEEE Trans. Com. Tech., vol. COM-19, no. 1,\nFeb. 1971, pp. 50-62.\n\n3\n.\n\nDavisson, Lee D : Rate-Distortion Theory and Application.\n.\nvol. 60, no. 7, July 1972, pp. 800-808.\n\n4 Max, Joel: Quantizing for Minimum Distortion.\n.\n\nProc. IEEE,\n\nIRE Trans. Inform. Theory,\n\nvol. 14-6, no. 1, F4arch 1960, pp. 7-12.\n5.\n\nHuang, J. J. Y.; and Schultheiss, P. Y.: Block Quantization of Correlated\nGaussian Random Variables. IEEE Trans. Com. Sys., vol. CS-11, no. 3,\nSept. 1963, pp. 289-296.\n\n6 Paez, M. P.; and Glisson, T H.: Minimum Yean-Squared-Error Quantization\n.\n.\nin Speech PCF4 and DPCM Systems. IEEE Trans. Com., vol. COW-20, no. 2,\nApril 1972, pp. 225-230.\n\n7. Jones, H. W.:\n\nMinimum Distortion Quantizers.\n\nNASA TN D-8384, 1977.\n\n8\n.\n\nJones, H. W.: A Real-Time Adaptive Hadamard Transform Video Compressor.\nProceedings of the Society of Photo-Optical Instrumentation Engineers,\nVO~.\n87, August 1976, pp. 2-9.\n\n9\n.\n\nBerger, Toby: Rate Distortion Theory.\nN.J., 1971.\n\nPrentice-Hall, Englewood Cliffs,\n\n10. Wyner, Aaron D.; and Ziv, Jacob: Bounds on the Rate-Distortion Function\nfor Stationary Sources with Memory. IEEE Trans. Inform. Theory, vol.\nIT-17, no. 5, Sept. 1971, pp. 508-513.\n\n.\n11. Goblick, T. J.; and Holsinger, J. L : Analog Source Digitization: Comparison of Theory and Practice. IEEE Trans. Inform. Theory, vol. IT-13,\nno. 2, April 1967, pp. 323-326.\n12. Mannos, James L.; and Sakrison, David J.: The Effects of a Visual Fidelity\nCriterion on the Encoding of Images. IEEE Trans. Inform. Theory, vol.\nIT-20, no. 4, July 1974, pp. 525-536.\n13. Kurtenbach, Alfred J.; and Wintz, Paul A : Quantizing for Noisy Channels.\n.\nIEEE Trans. Com. Tech., vol. COM-17, no. 1, April 1969, pp. 291-302.\n14. Knauer, Scott C : Real-Time Video Compression Algorithm f o r Hadamard\n.\nTransform Processing. IEEE Trans. Electromag. Compat., vol. EMC-18,\nno. 1, Feb. 1976, pp. 28-36.\n11\n\n15. Knauer, S c o t t C.:\nC r i t e r i a f o r B u i l d i n g 3 D Vector S e t s i n I n t e r l a c e d\nVideo Systems. N a t i o n a l Telecommunications Conference, Dallas, Texas,\nDec. 1976, pp. 44.5-1 t o 44.5-6.\n\n12\n\nTABLE I . - FREQUENCY WEIGHTING OF LANDAIJ AND SLEPIAN\'S VARIANCES\n.\n\n\\I\n\n_ . . _. . . .\n\ne ct o r\n- --1-\n\n. .\n\nHo 2\nH2 0\nHO 3\nH3 0\n\n.048\n\nH10\n\n-\n\n5\n6\n7\n8\n\nH11\nH12\n\n9\n10\n11\n12\n\nH2 1\n\nHi 3\nH31\nH2 2\nH2 3\nH32\nH3 3\n\ni3\n\n14\n15\n16\n- - --\n\n02\n\n1-.00- .098\n.087\n.035\n.038\n\nHobHo 1\n\n3\n4\n\n.\n\nrariance?\n\n....\n\n2\n\n-\n\n.\n\nDesignation\n\n..\n\n- -\n\n--\n\n.os1\n\n.034\n.024\n.024\n.020\n.022\n.019\n.015\n.016\n.014\n-- -\n\n- -\n\nFrequency\n__\n4 77\n.\n.\n7.55\n7.55\n10.67\n10.67\n13.92\n13.92\n9.55\n12.17\n12.17\n15.09\n15.09\n14.31\n16.88\n16.88\n19.09\n\nA(fr)b\n0.88\n.98\n.98\n.93\n.93\n.79\n.79\n.96\n.87\n.87\n.74\n.74\n.77\n.65\n.65\n.54\n\n1.66 logloo2A2+4.81 B i t s C\n4.50\n2.98\n2.90\n2.15\n2.22\n2.20\n2.15\n2.18\n1.78\n1.78\n1.43\n1.49\n1.43\n1.02\n1.07\n.71\n\nT\n4\n4\n3\n3\n\n3\n3\n2\n2\n2\n\nn\n0\n0\n0\n\n0\n0\n\n_ _ _\n\n_ _ _ _ _ .\n_ _ . . .. _ .\n._ .\n\naLandau and S l e p i a n , t a b l e I ( r e f . 1 ) .\nbMannos and Sakrison, e q u a t i o n (23) ( r e f . 12).\nCLandau and S l e p i a n , t a b l e I11 ( r e f . 1 ) .\n\n13\n\nTABLE 11. - HABIBI-WINTZ THEORETICAL\n\nANT)\n\nEMPIRICAL BIT ASSIGNMENTS~\n\n1\n2 bits/sample; b;\n\n1-3\n4-9\n10-21\n22-47\n47-88\n89-90\n91-115\n116-139\n140-203\n204-256\n\n--\n\n-- -\n\n..\n\n-- - -\n\n-\n\n.\n\n__ - - - -\n\n8\n\n8.32\n7.04\n5.77\n4.49\n3.22\n3.22\n1.94\n1.94\n.67\n-.61- - - - __\n-__ - - - - - - - 2.59(bith/2.0)-0.48\n7\n6\n5\n4\n3\n2\n1\n0\n0\n.- - .- - -\n\nI\n_\n\n1 bit/sample; bia\n\n=\n\n1-2\n3-6\n7-15\n16-38\n39-56\n57-66\n67-73\n74-122\n123-256\n\n1-2\n5\n4\n3-6\n7-14\n3\n2\n15-25\n26-35\n2\n36-46\n1\n47-71\n1\n72-256 . . . . . . . .. . . . . .\n0\n- -\n\n14\n\n6\n5\n4\n3\n\n5.98\n!\n4.64\n3.29\n1.95\n2\n1.95\n1\n.61\n0\n.61\n0- . - _ - _ . . -.73_ . _ _ _ _ _ _ _ _ _\n.......\n__\n\nTABLE I11\n\n.- 30 AND MAXIMUM-EDGE-INDIJCED\n\nVALIJES FOR HADAMARD\nTRANSFORM COEFFICIENTS\n\nN x N\n\nVector\nEdge\nMaximum\n\n3u\n\nEdge\nhilaximum\n\n5.87\n\n3.46\n\n11.41\n\n6.93\n\n21.64\n\n13.85\n\n.79\n\n3.46\n\n1.86\n\n6.93\n\n4.82\n\n13.85\n\n3.46\n\n2.23\n\n6.93\n\n-\n\n1.04\n\n3.46\n\n1.73\n\n2.37\n\n3.46\n\n1.38\n\n1.73\n\n. . . . . . . . . . . . ~ . . .\n\nHo 0\nHo 1 r H 1 0\nH02 rH03rH20rH30\n\n-\n\n-\n\n.92\n\nHO 4 -H 0 7 r H4 0-H7 0\n\n-\n\n-\n\n-\n\nH11\n\n.52\n\n.87\n\n.95\n\n-\n\nH l2 ,H1 3 r H2 1, H3 1\n- - - .- - .. . . . . . . . ....- -\n\nTABLE 1 V . -\n\nI\n\nEdge\nMaximum\n\n30\n\n-\n\n.64\n\n- . - . - .-\n\n- - .- -\n\n- -\n\n.87\n-\n\n.\n\n- - - --\n\n-\n\n-\n\n- ..- - . - - . -\n\nFRACTION OF RANGE REPRESENTED I N SUBJECTIVE 4\n\n-\n\nVectors\n\nx\n\nLandau 6 Knauer~\n-(re-f.\xe2\x80\x99\n-143- J o n e s ( r e f .\nSlepian\n(Vectors w i t h no (Mode 3 f o r\nextreme edges)\n( r e f . 1) t i m e component)\n\nI\n\n0.94\n\n-- - -\n\n4 HADAMARD DESIGNS\n\nEdge maximum\nvalue divided\nby f u l l range\n(N & ) .\n. . . . . _ _ _ _ _ _\n\n0.99\n\n0.98\n\n1.0\n\n.24\n\n.48,0.23\n\n1.0\n\n.093\n\n.093,0.074\n\n.23,0.11\n\n0.5\n\n.069\n\n.090\n\n.I1\n\n0.25\n\n.069\n0\n\n.31,0.19\n\n.069\n0\n\n0\n0\n\n0.125\n0.125-0.063\n- - .- . . -\n\nNASA-Langley, 1977\n\nA-6781\n\n- -\n\n15\n\nN A T I O N A L AERONALlTlCS A N D S P A C E ADMINISTRATION\nW A S H I N G T O N . D.C. 20546\nOFFICIAL B U S I N E S S\nPENALTY\n\nFOR PRIVATE USE SJOD\n\nSPECIAL FOURTH-CLASS RATE\nBOOK\n\n185 0 0 1 c 1\n\nu\n\nPOSTAGE A N D FEES P A I D\nN A T I O N A L AERONAUTICS A N D\nSPACE ADMINISTRATION\n451\n\n0 770304 S009Ca3DS\n\nDEPT OF THE A I f i FGBCE\nB F WEAPONS LAEORA\xe2\x80\x99IORY\nBTTN : T E C H N I C A L L I B H A B Y (SUI,)\nK I R T L A N D AFB N H 87177\n\nPOSTMASTER :\n\nIf Undeliverable (Section 158\nPostill Manual) Do Not Return\n\n\xe2\x80\x9cThe aeronautical and space activities of the United States shall be\nconducted so as t o contribute . . . to the expansion of human knowledge of phenomena in the atmosphere and space. The Administration\nshall provide for the widest practicable and appropriate dissemination\nof information concerning its activities and the results thereof.\xe2\x80\x9d\n-NATIONALAERONAUTICS\nAND SPACE ACT OF 1958\n\nNASA SCIENTIFIC AND TECHNICAL PUBLICATIONS\nTECHNICAL REPORTS: Scientific and\ntechnical information considered important,\ncomplete, and a lasting contribution to existing\nknowledge.\n\nTECHNICAL TRANSLATIONS: Information\npublished in a foreign language considered\nto merit NASA distribution in English.\n\nTECHNICAL NOTES: Information less broad\nin scope but nevertheless of importance as a\ncontribution to existing knowledge.\n\nSPECIAL PUBLICATIONS : Information\nderived from or of value to NASA activities.\nPublications include final reports of major\nprojects, monographs, data compilations,\nhandbooks, sourcebooks, and special\nbibliographies.\n\nTECHNICAL MEMORANDUMS:\nInformation receiving limited distribution\nbecause of preliminary data, security classification, or other reasons. Also includes conference\nproceedings with either limited or unlimited\nmon.\ndistribL \xe2\x80\x99\n\n-\n\nCONTRACTOR REPORTS: Scientific and\ntechnical information generated under a NASA\ncontract or grant and considered an important\ncontribution to existing knowledge.\n\nTECHNOLOGY UTILIZATION\nPUBLICATIONS: Information on technology\nused by NASA that may be of particular\ninterest in commercial and other-non-aerospace\napplications. Publications include Tech Briefs,\nTechnology Utilization Reports and\nTechnology Surveys.\n\nDetails on the availability of these publications may be obtained from:\n.\n\nNATIONAL\n\nSCIENTIFIC A N D TECHNICAL INFORMATION OFFICE\n\nAERONAUTICS\n\nAND\n\nSPACE A D M I N I S T R A T I O N\n\nWashington, D.C. 20546\n\n'